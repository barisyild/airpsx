var Ug=Object.defineProperty;var $g=(i,e,n)=>e in i?Ug(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var ke=(i,e,n)=>$g(i,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function n(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=n(o);fetch(o.href,c)}})();var Cs,$e,Lh,Ai,Wu,Nh,el,Mh,bl,tl,nl,Dh,ys={},Ph=[],jg=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,$o=Array.isArray;function qn(i,e){for(var n in e)i[n]=e[n];return i}function xl(i){i&&i.parentNode&&i.parentNode.removeChild(i)}function Zn(i,e,n){var s,o,c,f={};for(c in e)c=="key"?s=e[c]:c=="ref"?o=e[c]:f[c]=e[c];if(arguments.length>2&&(f.children=arguments.length>3?Cs.call(arguments,2):n),typeof i=="function"&&i.defaultProps!=null)for(c in i.defaultProps)f[c]===void 0&&(f[c]=i.defaultProps[c]);return fs(i,f,s,o,null)}function fs(i,e,n,s,o){var c={type:i,props:e,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++Lh,__i:-1,__u:0};return o==null&&$e.vnode!=null&&$e.vnode(c),c}function Vg(){return{current:null}}function Dt(i){return i.children}function En(i,e){this.props=i,this.context=e}function hr(i,e){if(e==null)return i.__?hr(i.__,i.__i+1):null;for(var n;e<i.__k.length;e++)if((n=i.__k[e])!=null&&n.__e!=null)return n.__e;return typeof i.type=="function"?hr(i):null}function Oh(i){var e,n;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((n=i.__k[e])!=null&&n.__e!=null){i.__e=i.__c.base=n.__e;break}return Oh(i)}}function il(i){(!i.__d&&(i.__d=!0)&&Ai.push(i)&&!Io.__r++||Wu!==$e.debounceRendering)&&((Wu=$e.debounceRendering)||Nh)(Io)}function Io(){var i,e,n,s,o,c,f,h;for(Ai.sort(el);i=Ai.shift();)i.__d&&(e=Ai.length,s=void 0,c=(o=(n=i).__v).__e,f=[],h=[],n.__P&&((s=qn({},o)).__v=o.__v+1,$e.vnode&&$e.vnode(s),_l(n.__P,s,o,n.__n,n.__P.namespaceURI,32&o.__u?[c]:null,f,c??hr(o),!!(32&o.__u),h),s.__v=o.__v,s.__.__k[s.__i]=s,Eh(f,s,h),s.__e!=c&&Oh(s)),Ai.length>e&&Ai.sort(el));Io.__r=0}function Ah(i,e,n,s,o,c,f,h,p,g,b){var _,T,L,D,P,N,E=s&&s.__k||Ph,I=e.length;for(p=Kg(n,e,E,p,I),_=0;_<I;_++)(L=n.__k[_])!=null&&(T=L.__i===-1?ys:E[L.__i]||ys,L.__i=_,N=_l(i,L,T,o,c,f,h,p,g,b),D=L.__e,L.ref&&T.ref!=L.ref&&(T.ref&&wl(T.ref,null,L),b.push(L.ref,L.__c||D,L)),P==null&&D!=null&&(P=D),4&L.__u||T.__k===L.__k?p=Ih(L,p,i):typeof L.type=="function"&&N!==void 0?p=N:D&&(p=D.nextSibling),L.__u&=-7);return n.__e=P,p}function Kg(i,e,n,s,o){var c,f,h,p,g,b=n.length,_=b,T=0;for(i.__k=new Array(o),c=0;c<o;c++)(f=e[c])!=null&&typeof f!="boolean"&&typeof f!="function"?(p=c+T,(f=i.__k[c]=typeof f=="string"||typeof f=="number"||typeof f=="bigint"||f.constructor==String?fs(null,f,null,null,null):$o(f)?fs(Dt,{children:f},null,null,null):f.constructor===void 0&&f.__b>0?fs(f.type,f.props,f.key,f.ref?f.ref:null,f.__v):f).__=i,f.__b=i.__b+1,h=null,(g=f.__i=Xg(f,n,p,_))!==-1&&(_--,(h=n[g])&&(h.__u|=2)),h==null||h.__v===null?(g==-1&&T--,typeof f.type!="function"&&(f.__u|=4)):g!=p&&(g==p-1?T--:g==p+1?T++:(g>p?T--:T++,f.__u|=4))):i.__k[c]=null;if(_)for(c=0;c<b;c++)(h=n[c])!=null&&!(2&h.__u)&&(h.__e==s&&(s=hr(h)),Rh(h,h));return s}function Ih(i,e,n){var s,o;if(typeof i.type=="function"){for(s=i.__k,o=0;s&&o<s.length;o++)s[o]&&(s[o].__=i,e=Ih(s[o],e,n));return e}i.__e!=e&&(e&&i.type&&!n.contains(e)&&(e=hr(i)),n.insertBefore(i.__e,e||null),e=i.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Yn(i,e){return e=e||[],i==null||typeof i=="boolean"||($o(i)?i.some(function(n){Yn(n,e)}):e.push(i)),e}function Xg(i,e,n,s){var o,c,f=i.key,h=i.type,p=e[n];if(p===null||p&&f==p.key&&h===p.type&&!(2&p.__u))return n;if(s>(p!=null&&!(2&p.__u)?1:0))for(o=n-1,c=n+1;o>=0||c<e.length;){if(o>=0){if((p=e[o])&&!(2&p.__u)&&f==p.key&&h===p.type)return o;o--}if(c<e.length){if((p=e[c])&&!(2&p.__u)&&f==p.key&&h===p.type)return c;c++}}return-1}function Bu(i,e,n){e[0]=="-"?i.setProperty(e,n??""):i[e]=n==null?"":typeof n!="number"||jg.test(e)?n:n+"px"}function uo(i,e,n,s,o){var c;e:if(e=="style")if(typeof n=="string")i.style.cssText=n;else{if(typeof s=="string"&&(i.style.cssText=s=""),s)for(e in s)n&&e in n||Bu(i.style,e,"");if(n)for(e in n)s&&n[e]===s[e]||Bu(i.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")c=e!=(e=e.replace(Mh,"$1")),e=e.toLowerCase()in i||e=="onFocusOut"||e=="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),i.l||(i.l={}),i.l[e+c]=n,n?s?n.u=s.u:(n.u=bl,i.addEventListener(e,c?nl:tl,c)):i.removeEventListener(e,c?nl:tl,c);else{if(o=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in i)try{i[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?i.removeAttribute(e):i.setAttribute(e,e=="popover"&&n==1?"":n))}}function Uu(i){return function(e){if(this.l){var n=this.l[e.type+i];if(e.t==null)e.t=bl++;else if(e.t<n.u)return;return n($e.event?$e.event(e):e)}}}function _l(i,e,n,s,o,c,f,h,p,g){var b,_,T,L,D,P,N,E,I,j,X,G,K,Y,Q,he,fe,oe=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(p=!!(32&n.__u),c=[h=e.__e=n.__e]),(b=$e.__b)&&b(e);e:if(typeof oe=="function")try{if(E=e.props,I="prototype"in oe&&oe.prototype.render,j=(b=oe.contextType)&&s[b.__c],X=b?j?j.props.value:b.__:s,n.__c?N=(_=e.__c=n.__c).__=_.__E:(I?e.__c=_=new oe(E,X):(e.__c=_=new En(E,X),_.constructor=oe,_.render=qg),j&&j.sub(_),_.props=E,_.state||(_.state={}),_.context=X,_.__n=s,T=_.__d=!0,_.__h=[],_._sb=[]),I&&_.__s==null&&(_.__s=_.state),I&&oe.getDerivedStateFromProps!=null&&(_.__s==_.state&&(_.__s=qn({},_.__s)),qn(_.__s,oe.getDerivedStateFromProps(E,_.__s))),L=_.props,D=_.state,_.__v=e,T)I&&oe.getDerivedStateFromProps==null&&_.componentWillMount!=null&&_.componentWillMount(),I&&_.componentDidMount!=null&&_.__h.push(_.componentDidMount);else{if(I&&oe.getDerivedStateFromProps==null&&E!==L&&_.componentWillReceiveProps!=null&&_.componentWillReceiveProps(E,X),!_.__e&&(_.shouldComponentUpdate!=null&&_.shouldComponentUpdate(E,_.__s,X)===!1||e.__v==n.__v)){for(e.__v!=n.__v&&(_.props=E,_.state=_.__s,_.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(se){se&&(se.__=e)}),G=0;G<_._sb.length;G++)_.__h.push(_._sb[G]);_._sb=[],_.__h.length&&f.push(_);break e}_.componentWillUpdate!=null&&_.componentWillUpdate(E,_.__s,X),I&&_.componentDidUpdate!=null&&_.__h.push(function(){_.componentDidUpdate(L,D,P)})}if(_.context=X,_.props=E,_.__P=i,_.__e=!1,K=$e.__r,Y=0,I){for(_.state=_.__s,_.__d=!1,K&&K(e),b=_.render(_.props,_.state,_.context),Q=0;Q<_._sb.length;Q++)_.__h.push(_._sb[Q]);_._sb=[]}else do _.__d=!1,K&&K(e),b=_.render(_.props,_.state,_.context),_.state=_.__s;while(_.__d&&++Y<25);_.state=_.__s,_.getChildContext!=null&&(s=qn(qn({},s),_.getChildContext())),I&&!T&&_.getSnapshotBeforeUpdate!=null&&(P=_.getSnapshotBeforeUpdate(L,D)),h=Ah(i,$o(he=b!=null&&b.type===Dt&&b.key==null?b.props.children:b)?he:[he],e,n,s,o,c,f,h,p,g),_.base=e.__e,e.__u&=-161,_.__h.length&&f.push(_),N&&(_.__E=_.__=null)}catch(se){if(e.__v=null,p||c!=null)if(se.then){for(e.__u|=p?160:128;h&&h.nodeType==8&&h.nextSibling;)h=h.nextSibling;c[c.indexOf(h)]=null,e.__e=h}else for(fe=c.length;fe--;)xl(c[fe]);else e.__e=n.__e,e.__k=n.__k;$e.__e(se,e,n)}else c==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):h=e.__e=Gg(n.__e,e,n,s,o,c,f,p,g);return(b=$e.diffed)&&b(e),128&e.__u?void 0:h}function Eh(i,e,n){for(var s=0;s<n.length;s++)wl(n[s],n[++s],n[++s]);$e.__c&&$e.__c(e,i),i.some(function(o){try{i=o.__h,o.__h=[],i.some(function(c){c.call(o)})}catch(c){$e.__e(c,o.__v)}})}function Gg(i,e,n,s,o,c,f,h,p){var g,b,_,T,L,D,P,N=n.props,E=e.props,I=e.type;if(I=="svg"?o="http://www.w3.org/2000/svg":I=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),c!=null){for(g=0;g<c.length;g++)if((L=c[g])&&"setAttribute"in L==!!I&&(I?L.localName==I:L.nodeType==3)){i=L,c[g]=null;break}}if(i==null){if(I==null)return document.createTextNode(E);i=document.createElementNS(o,I,E.is&&E),h&&($e.__m&&$e.__m(e,c),h=!1),c=null}if(I===null)N===E||h&&i.data===E||(i.data=E);else{if(c=c&&Cs.call(i.childNodes),N=n.props||ys,!h&&c!=null)for(N={},g=0;g<i.attributes.length;g++)N[(L=i.attributes[g]).name]=L.value;for(g in N)if(L=N[g],g!="children"){if(g=="dangerouslySetInnerHTML")_=L;else if(!(g in E)){if(g=="value"&&"defaultValue"in E||g=="checked"&&"defaultChecked"in E)continue;uo(i,g,null,L,o)}}for(g in E)L=E[g],g=="children"?T=L:g=="dangerouslySetInnerHTML"?b=L:g=="value"?D=L:g=="checked"?P=L:h&&typeof L!="function"||N[g]===L||uo(i,g,L,N[g],o);if(b)h||_&&(b.__html===_.__html||b.__html===i.innerHTML)||(i.innerHTML=b.__html),e.__k=[];else if(_&&(i.innerHTML=""),Ah(i,$o(T)?T:[T],e,n,s,I=="foreignObject"?"http://www.w3.org/1999/xhtml":o,c,f,c?c[0]:n.__k&&hr(n,0),h,p),c!=null)for(g=c.length;g--;)xl(c[g]);h||(g="value",I=="progress"&&D==null?i.removeAttribute("value"):D!==void 0&&(D!==i[g]||I=="progress"&&!D||I=="option"&&D!==N[g])&&uo(i,g,D,N[g],o),g="checked",P!==void 0&&P!==i[g]&&uo(i,g,P,N[g],o))}return i}function wl(i,e,n){try{if(typeof i=="function"){var s=typeof i.__u=="function";s&&i.__u(),s&&e==null||(i.__u=i(e))}else i.current=e}catch(o){$e.__e(o,n)}}function Rh(i,e,n){var s,o;if($e.unmount&&$e.unmount(i),(s=i.ref)&&(s.current&&s.current!==i.__e||wl(s,null,e)),(s=i.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(c){$e.__e(c,e)}s.base=s.__P=null}if(s=i.__k)for(o=0;o<s.length;o++)s[o]&&Rh(s[o],e,n||typeof i.type!="function");n||xl(i.__e),i.__c=i.__=i.__e=void 0}function qg(i,e,n){return this.constructor(i,n)}function Fi(i,e,n){var s,o,c,f;e==document&&(e=document.documentElement),$e.__&&$e.__(i,e),o=(s=typeof n=="function")?null:n&&n.__k||e.__k,c=[],f=[],_l(e,i=(!s&&n||e).__k=Zn(Dt,null,[i]),o||ys,ys,e.namespaceURI,!s&&n?[n]:o?null:e.firstChild?Cs.call(e.childNodes):null,c,!s&&n?n:o?o.__e:e.firstChild,s,f),Eh(c,i,f)}function Fh(i,e){Fi(i,e,Fh)}function Yg(i,e,n){var s,o,c,f,h=qn({},i.props);for(c in i.type&&i.type.defaultProps&&(f=i.type.defaultProps),e)c=="key"?s=e[c]:c=="ref"?o=e[c]:h[c]=e[c]===void 0&&f!==void 0?f[c]:e[c];return arguments.length>2&&(h.children=arguments.length>3?Cs.call(arguments,2):n),fs(i.type,h,s||i.key,o||i.ref,null)}function Zg(i,e){var n={__c:e="__cC"+Dh++,__:i,Consumer:function(s,o){return s.children(o)},Provider:function(s){var o,c;return this.getChildContext||(o=new Set,(c={})[e]=this,this.getChildContext=function(){return c},this.componentWillUnmount=function(){o=null},this.shouldComponentUpdate=function(f){this.props.value!==f.value&&o.forEach(function(h){h.__e=!0,il(h)})},this.sub=function(f){o.add(f);var h=f.componentWillUnmount;f.componentWillUnmount=function(){o&&o.delete(f),h&&h.call(f)}}),s.children}};return n.Provider.__=n.Consumer.contextType=n}Cs=Ph.slice,$e={__e:function(i,e,n,s){for(var o,c,f;e=e.__;)if((o=e.__c)&&!o.__)try{if((c=o.constructor)&&c.getDerivedStateFromError!=null&&(o.setState(c.getDerivedStateFromError(i)),f=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(i,s||{}),f=o.__d),f)return o.__E=o}catch(h){i=h}throw i}},Lh=0,En.prototype.setState=function(i,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=qn({},this.state),typeof i=="function"&&(i=i(qn({},n),this.props)),i&&qn(n,i),i!=null&&this.__v&&(e&&this._sb.push(e),il(this))},En.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),il(this))},En.prototype.render=Dt,Ai=[],Nh=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,el=function(i,e){return i.__v.__b-e.__v.__b},Io.__r=0,Mh=/(PointerCapture)$|Capture$/i,bl=0,tl=Uu(!1),nl=Uu(!0),Dh=0;var Jg=0;function v(i,e,n,s,o,c){e||(e={});var f,h,p=e;if("ref"in p)for(h in p={},e)h=="ref"?f=e[h]:p[h]=e[h];var g={type:i,props:p,key:n,ref:f,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Jg,__i:-1,__u:0,__source:o,__self:c};if(typeof i=="function"&&(f=i.defaultProps))for(h in f)p[h]===void 0&&(p[h]=f[h]);return $e.vnode&&$e.vnode(g),g}var pi,ut,Ua,$u,dr=0,Hh=[],pt=$e,ju=pt.__b,Vu=pt.__r,Ku=pt.diffed,Xu=pt.__c,Gu=pt.unmount,qu=pt.__;function vr(i,e){pt.__h&&pt.__h(ut,i,dr||e),dr=0;var n=ut.__H||(ut.__H={__:[],__h:[]});return i>=n.__.length&&n.__.push({}),n.__[i]}function ae(i){return dr=1,kl(jh,i)}function kl(i,e,n){var s=vr(pi++,2);if(s.t=i,!s.__c&&(s.__=[n?n(e):jh(void 0,e),function(h){var p=s.__N?s.__N[0]:s.__[0],g=s.t(p,h);p!==g&&(s.__N=[g,s.__[1]],s.__c.setState({}))}],s.__c=ut,!ut.u)){var o=function(h,p,g){if(!s.__c.__H)return!0;var b=s.__c.__H.__.filter(function(T){return!!T.__c});if(b.every(function(T){return!T.__N}))return!c||c.call(this,h,p,g);var _=s.__c.props!==h;return b.forEach(function(T){if(T.__N){var L=T.__[0];T.__=T.__N,T.__N=void 0,L!==T.__[0]&&(_=!0)}}),c&&c.call(this,h,p,g)||_};ut.u=!0;var c=ut.shouldComponentUpdate,f=ut.componentWillUpdate;ut.componentWillUpdate=function(h,p,g){if(this.__e){var b=c;c=void 0,o(h,p,g),c=b}f&&f.call(this,h,p,g)},ut.shouldComponentUpdate=o}return s.__N||s.__}function Ve(i,e){var n=vr(pi++,3);!pt.__s&&Sl(n.__H,e)&&(n.__=i,n.i=e,ut.__H.__h.push(n))}function Ts(i,e){var n=vr(pi++,4);!pt.__s&&Sl(n.__H,e)&&(n.__=i,n.i=e,ut.__h.push(n))}function gt(i){return dr=5,jo(function(){return{current:i}},[])}function zh(i,e,n){dr=6,Ts(function(){return typeof i=="function"?(i(e()),function(){return i(null)}):i?(i.current=e(),function(){return i.current=null}):void 0},n==null?n:n.concat(i))}function jo(i,e){var n=vr(pi++,7);return Sl(n.__H,e)&&(n.__=i(),n.__H=e,n.__h=i),n.__}function Wh(i,e){return dr=8,jo(function(){return i},e)}function Bh(i){var e=ut.context[i.__c],n=vr(pi++,9);return n.c=i,e?(n.__==null&&(n.__=!0,e.sub(ut)),e.props.value):i.__}function Uh(i,e){pt.useDebugValue&&pt.useDebugValue(e?e(i):i)}function $h(){var i=vr(pi++,11);if(!i.__){for(var e=ut.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var n=e.__m||(e.__m=[0,0]);i.__="P"+n[0]+"-"+n[1]++}return i.__}function Qg(){for(var i;i=Hh.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(To),i.__H.__h.forEach(rl),i.__H.__h=[]}catch(e){i.__H.__h=[],pt.__e(e,i.__v)}}pt.__b=function(i){ut=null,ju&&ju(i)},pt.__=function(i,e){i&&e.__k&&e.__k.__m&&(i.__m=e.__k.__m),qu&&qu(i,e)},pt.__r=function(i){Vu&&Vu(i),pi=0;var e=(ut=i.__c).__H;e&&(Ua===ut?(e.__h=[],ut.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(e.__h.forEach(To),e.__h.forEach(rl),e.__h=[],pi=0)),Ua=ut},pt.diffed=function(i){Ku&&Ku(i);var e=i.__c;e&&e.__H&&(e.__H.__h.length&&(Hh.push(e)!==1&&$u===pt.requestAnimationFrame||(($u=pt.requestAnimationFrame)||em)(Qg)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),Ua=ut=null},pt.__c=function(i,e){e.some(function(n){try{n.__h.forEach(To),n.__h=n.__h.filter(function(s){return!s.__||rl(s)})}catch(s){e.some(function(o){o.__h&&(o.__h=[])}),e=[],pt.__e(s,n.__v)}}),Xu&&Xu(i,e)},pt.unmount=function(i){Gu&&Gu(i);var e,n=i.__c;n&&n.__H&&(n.__H.__.forEach(function(s){try{To(s)}catch(o){e=o}}),n.__H=void 0,e&&pt.__e(e,n.__v))};var Yu=typeof requestAnimationFrame=="function";function em(i){var e,n=function(){clearTimeout(s),Yu&&cancelAnimationFrame(e),setTimeout(i)},s=setTimeout(n,100);Yu&&(e=requestAnimationFrame(n))}function To(i){var e=ut,n=i.__c;typeof n=="function"&&(i.__c=void 0,n()),ut=e}function rl(i){var e=ut;i.__c=i.__(),ut=e}function Sl(i,e){return!i||i.length!==e.length||e.some(function(n,s){return n!==i[s]})}function jh(i,e){return typeof e=="function"?e(i):e}const tm=({window:i,children:e,isActive:n,isDarkMode:s,onClose:o,onFocus:c,onDragStart:f,onMinimize:h})=>{const[p,g]=ae(!1),[b,_]=ae(!1),[T,L]=ae({x:0,y:0}),[D,P]=ae({x:0,y:0,width:0,height:0}),[N,E]=ae(!1),I=gt(null),j=gt({x:0,y:0});Ve(()=>{E("ontouchstart"in i||navigator.maxTouchPoints>0)},[]);const X=fe=>{const oe=fe.target;if(oe.closest(".window-header")&&!oe.closest(".window-controls")){const se=fe.touches[0];j.current={x:se.clientX,y:se.clientY},g(!0),f();const R=I.current.getBoundingClientRect();L({x:se.clientX-R.left,y:se.clientY-R.top})}},G=fe=>{if(p&&I.current){const oe=fe.touches[0],se=I.current.getBoundingClientRect(),R=document.querySelector(".desktop-content").getBoundingClientRect();let F=oe.clientX-T.x,S=oe.clientY-T.y;I.current.style.left=`${F}px`,I.current.style.top=`${S}px`,he(se,R)}},K=()=>{g(!1),_(!1)},Y=fe=>{const oe=fe.target;if(oe.closest(".window-header")&&!oe.closest(".window-controls")){g(!0),f();const se=I.current.getBoundingClientRect();L({x:fe.clientX-se.left,y:fe.clientY-se.top})}},Q=fe=>{fe.stopPropagation(),_(!0);const oe=I.current.getBoundingClientRect();P({x:fe.clientX,y:fe.clientY,width:oe.width,height:oe.height})},he=(fe,oe)=>{if(!I.current)return;let se=parseInt(I.current.style.left),R=parseInt(I.current.style.top),F=fe.width,S=fe.height;F>oe.width&&(F=oe.width,I.current.style.width=`${F}px`),S>oe.height&&(S=oe.height,I.current.style.height=`${S}px`),se=Math.max(0,Math.min(se,oe.width-F)),R=Math.max(0,Math.min(R,oe.height-S)),I.current.style.left=`${se}px`,I.current.style.top=`${R}px`};return Ve(()=>{const fe=se=>{if(!I.current)return;const R=I.current.getBoundingClientRect(),F=document.querySelector(".desktop-content");if(!F)return;const S=F.getBoundingClientRect();if(p){let ge=se.clientX-T.x,Le=se.clientY-T.y;I.current.style.left=`${ge}px`,I.current.style.top=`${Le}px`,he(R,S)}else if(b){let ge=D.width+(se.clientX-D.x),Le=D.height+(se.clientY-D.y);ge=Math.max(200,Math.min(ge,S.width)),Le=Math.max(150,Math.min(Le,S.height)),I.current.style.width=`${ge}px`,I.current.style.height=`${Le}px`,he(R,S)}},oe=()=>{g(!1),_(!1)};return(p||b)&&(document.addEventListener("mousemove",fe),document.addEventListener("mouseup",oe)),()=>{document.removeEventListener("mousemove",fe),document.removeEventListener("mouseup",oe)}},[p,b,T,D]),Ve(()=>{const fe=new ResizeObserver(()=>{var F,S;const se=(F=I.current)==null?void 0:F.getBoundingClientRect(),R=(S=document.querySelector(".desktop-content"))==null?void 0:S.getBoundingClientRect();se&&R&&he(se,R)}),oe=document.querySelector(".desktop-content");return oe&&fe.observe(oe),()=>{fe.disconnect()}},[]),v("div",{ref:I,"data-window-id":i.id,className:`window ${n?"active":""} ${s?"dark":""} 
 ${b?"resizing":""} ${N?"touch-device":""} ${i.app==="PlayStation"?"console":""}`,style:{left:i.position.x,top:i.position.y,width:i.size.width,height:i.size.height,display:i.minimized?"none":"flex"},onMouseDown:c,onTouchStart:X,onTouchMove:G,onTouchEnd:K,children:[v("div",{className:"window-header",onMouseDown:Y,children:[v("div",{className:"window-title",children:[v("span",{className:"window-icon icon",children:i.icon}),v("span",{className:"window-title-text",children:i.title})]}),v("div",{className:"window-controls",children:N?v(Dt,{children:[v("button",{className:"window-minimize touch",onClick:h,children:"âˆ’"}),v("button",{className:"window-close touch",onClick:o,children:"Ã—"})]}):v(Dt,{children:[v("button",{className:"window-minimize",onClick:h,children:"âˆ’"}),v("button",{className:"window-close",onClick:o,children:"Ã—"})]})})]}),v("div",{className:"window-content",children:e}),!N&&v("div",{className:"window-resize",onMouseDown:Q})]})},nm=({windows:i,activeWindow:e,isDarkMode:n,onWindowClick:s,onThemeToggle:o})=>v("div",{className:`taskbar ${n?"dark":""}`,children:[" ",v("div",{className:"taskbar-windows",children:[" ",i.map(c=>v("button",{className:`taskbar-window-button ${e===c.id?"active":""}`,onClick:()=>s(c.id,e===c.id),children:[" ",v("span",{className:"taskbar-window-icon icon",children:c.icon})," ",v("span",{className:"taskbar-window-title",children:c.title})," "]},c.id))," "]})," ",v("button",{className:"taskbar-theme-toggle icon",onClick:o,children:[" ",n?"â˜€ï¸":"ğŸŒ™"," "]})," "]}),Zu="/".endsWith("/")?"/".slice(0,-1):"/";class vt{static reset(){this.activeXHRs.forEach(e=>{try{e.abort()}catch(n){console.error("Error aborting XHR:",n)}}),this.queue=new Set,this.sessionKey=null,this.file=null,this.id=0,this.isRunning=!1,this.onProgressCallback=null,this.totalChunks=0,this.uploadedChunks=0,this.onCompleteCallback=null,this.onErrorCallback=null,this.uploadedBytes=0,this.totalBytes=0,this.chunkProgress={},this.pendingChunks=new Map,this.emptyRetryCount=0,this.errorRetryCount=0,this.activeXHRs=[]}static updateProgress(){if(this.onProgressCallback&&this.totalBytes>0){let e=0;for(const s in this.chunkProgress)e+=this.chunkProgress[s].uploaded;const n=e/this.totalBytes*100;this.onProgressCallback(n);for(const s in this.chunkProgress){const o=this.chunkProgress[s];o.uploaded===o.total&&!this.queue.has(s)&&delete this.chunkProgress[s]}}}static async startQueue(e,n,s,o,c){this.file=e,this.sessionKey=n,this.onProgressCallback=s,this.onCompleteCallback=o,this.onErrorCallback=c,this.isRunning=!0,this.totalBytes=e.size,this.uploadedBytes=0,this.getPackageList()}static async getPackageList(){if(this.isRunning){if(this.sessionKey===null){setTimeout(()=>{this.getPackageList()},100);return}try{const e=await fetch(`${Zu}/api/package/upload/list?sessionKey=${this.sessionKey}&id=${this.id++}`,{method:"POST"});if(!e.ok)throw new Error(`List API returned ${e.status}: ${e.statusText}`);const n=await e.json();this.errorRetryCount=0;let s=0;n.chunks&&n.chunks.length>0&&n.chunks.forEach(f=>{this.queue.has(f.key)||this.pendingChunks.has(f.key)||s++});let o=0;for(const f in this.chunkProgress)o+=this.chunkProgress[f].uploaded;const c=this.totalBytes>0?o/this.totalBytes*100:0;if(s===0&&this.queue.size>0){if(c>=99.9){console.log("[PackageQueue] Progress 100%, no new chunks - PKG installation completed successfully!"),this.isRunning=!1,this.onCompleteCallback&&this.onCompleteCallback(n),this.reset();return}if(this.emptyRetryCount++,console.log(`[PackageQueue] No new chunks (empty or duplicate). Progress: ${c.toFixed(1)}%, Retry: ${this.emptyRetryCount}/${this.maxEmptyRetries}`),this.emptyRetryCount>=this.maxEmptyRetries){console.error("[PackageQueue] PKG installation failed - No new chunks received after 3 retries"),this.isRunning=!1,this.onErrorCallback&&this.onErrorCallback(new Error("PKG installation failed - No new chunks received")),this.reset();return}this.isRunning&&setTimeout(()=>{this.getPackageList()},1e3);return}if(this.queue.size===0&&s===0&&this.pendingChunks.size===0){console.log("[PackageQueue] PKG installation completed successfully!"),this.isRunning=!1,this.onCompleteCallback&&this.onCompleteCallback(n),this.reset();return}s>0&&(console.log(`[PackageQueue] ${s} new chunks received`),this.emptyRetryCount=0),await this.manageChunks(this.file,n.sessionKey,n.chunks||[]),this.isRunning&&this.getPackageList()}catch(e){this.errorRetryCount++;const n=e instanceof Error?e.message:"Unknown error";if(console.error(`Package list error (${this.errorRetryCount}/${this.maxErrorRetries}):`,n),this.errorRetryCount>=this.maxErrorRetries){console.error("[PackageQueue] PKG installation failed - List API failed after 3 retries"),this.isRunning=!1,this.onErrorCallback&&this.onErrorCallback(new Error("PKG installation failed - List API error")),this.reset();return}this.isRunning&&setTimeout(()=>{this.getPackageList()},1e3)}}}static async uploadChunk(e,n,s){return new Promise((o,c)=>{const f=new XMLHttpRequest,h=new FormData,p=s.end-s.start+1;this.activeXHRs.push(f),this.chunkProgress[s.key]={total:p,uploaded:0},h.append("file",new Blob([e.slice(s.start,s.end+1)],{type:e.type})),f.open("POST",`${Zu}/api/package/upload?sessionKey=${n}&chunkKey=${s.key}`,!0),f.setRequestHeader("Expect","100-continue"),f.upload.onprogress=g=>{g.lengthComputable&&(this.chunkProgress[s.key].uploaded=g.loaded,this.updateProgress())},f.onload=()=>{const g=this.activeXHRs.indexOf(f);if(g>-1&&this.activeXHRs.splice(g,1),f.status>=200&&f.status<300){this.uploadedChunks++,this.chunkProgress[s.key].uploaded=p,this.updateProgress();try{const b=JSON.parse(f.responseText);b.chunks&&Array.isArray(b.chunks)&&b.chunks.length>0&&(console.log(`[UploadChunk] ${s.key} completed, ${b.chunks.length} chunks in response`),b.chunks.forEach(_=>{this.queue.has(_.key)||this.pendingChunks.set(_.key,_)}),console.log(`[UploadChunk] Total pending chunks: ${this.pendingChunks.size}`)),o(b)}catch(b){console.error("[UploadChunk] Response parse error:",b),o({})}}else delete this.chunkProgress[s.key],c(new Error("Network response was not ok"))},f.onerror=()=>{const g=this.activeXHRs.indexOf(f);g>-1&&this.activeXHRs.splice(g,1),delete this.chunkProgress[s.key],c(new Error("Network error"))},f.onabort=()=>{const g=this.activeXHRs.indexOf(f);g>-1&&this.activeXHRs.splice(g,1),delete this.chunkProgress[s.key],c(new Error("Upload cancelled"))},f.send(h)})}static async manageChunks(e,n,s){if(!s||s.length===0)return;this.totalChunks===0&&s.length>0&&(this.totalChunks=s.length);const o=[];for(let c=0;c<s.length;c++){const f=s[c];this.queue.has(f.key)||(this.queue.add(f.key),o.push(this.uploadChunk(e,n,f).catch(h=>{console.error(`Chunk ${f.key} upload error:`,h),this.queue.delete(f.key),delete this.chunkProgress[f.key]}).then(()=>{})))}if(o.length>0&&console.log(`[PackageQueue] Uploading ${o.length} chunks...`),await Promise.all(o),o.length>0&&console.log(`[PackageQueue] ${o.length} chunks upload completed`),this.pendingChunks.size>0)if(this.pendingChunks.size>=2){console.log(`[PackageQueue] ${this.pendingChunks.size} pending chunks available, uploading them first`);const c=Array.from(this.pendingChunks.values());this.pendingChunks.clear(),await this.manageChunks(e,n,c)}else console.log(`[PackageQueue] ${this.pendingChunks.size} pending chunk, list will be called`),this.pendingChunks.clear()}static stopQueue(){this.isRunning=!1,this.reset()}static getSessionKey(){return this.sessionKey||""}}ke(vt,"queue",new Set),ke(vt,"sessionKey",null),ke(vt,"file",null),ke(vt,"id",0),ke(vt,"isRunning",!1),ke(vt,"onProgressCallback",null),ke(vt,"totalChunks",0),ke(vt,"uploadedChunks",0),ke(vt,"onCompleteCallback",null),ke(vt,"onErrorCallback",null),ke(vt,"uploadedBytes",0),ke(vt,"totalBytes",0),ke(vt,"chunkProgress",{}),ke(vt,"pendingChunks",new Map),ke(vt,"emptyRetryCount",0),ke(vt,"errorRetryCount",0),ke(vt,"maxEmptyRetries",3),ke(vt,"maxErrorRetries",3),ke(vt,"activeXHRs",[]);class im{constructor(e){ke(this,"file");ke(this,"littleCache",null);ke(this,"entriesCache",null);this.file=e}async readBuffer(e,n){const s=Math.min(e+n,this.file.size);return await this.file.slice(e,s).arrayBuffer()}async readView(e,n){const s=await this.readBuffer(e,n);return new DataView(s)}async readMainOffset(){if(this.littleCache)return this.littleCache;const n=(await this.readView(88,8)).getBigInt64(0,!0),s=Number(n);return this.littleCache=s,s}async readHeader(){const e=await this.readMainOffset(),n=await this.readView(e+16,16),s=n.getUint32(0,!1),o=n.getUint32(8,!1);return{entryCount:s,fileTableOffset:o}}async readEntries(){if(this.entriesCache)return this.entriesCache;const e=await this.readMainOffset(),n=await this.readHeader(),s=32,o=n.entryCount*s,c=await this.readView(e+n.fileTableOffset,o),f=[];for(let h=0;h<n.entryCount;h++){const p=h*s,g=c.getUint32(p+0,!1),b=c.getUint32(p+4,!1),_=c.getUint32(p+8,!1),T=c.getUint32(p+12,!1),L=c.getUint32(p+16,!1),D=c.getUint32(p+20,!1),P=new Uint8Array(c.buffer.slice(p+24,p+32)),N=(T&61440)>>12,E=(_&2147483648)!==0;f.push({type:g,unk1:b,flags1:_,flags2:T,offset:L,size:D,padding:P,keyIndex:N,isEncrypted:E})}return this.entriesCache=f,f}async parsePkg(){const e=await this.readMainOffset(),n=await this.readEntries(),s={TITLE:"",TITLE_ID:""};let o=null;for(const c of n){let f=c.size;const h=e+c.offset,p=await this.readBuffer(h,f);if(c.type===8449){const g=JSON.parse(new TextDecoder().decode(p));console.log(g);const b=g.localizedParameters.defaultLanguage,_=g.localizedParameters[b];s.TITLE=_.titleName,s.TITLE_ID=g.titleId}else c.type===4608&&(o=p)}return{icon:o,sfo:s}}}class rm{constructor(e){ke(this,"file");ke(this,"decoder");ke(this,"headerCache",null);ke(this,"entriesCache",null);this.file=e,this.decoder=new TextDecoder("utf-8")}async readBuffer(e,n){const s=Math.min(e+n,this.file.size);return await this.file.slice(e,s).arrayBuffer()}async readView(e,n){const s=await this.readBuffer(e,n);return new DataView(s)}readCStringLocal(e,n,s){const o=[];for(let c=n;c<s;c++){const f=e.getUint8(c);if(f===0)break;o.push(f)}return this.decoder.decode(new Uint8Array(o))}readBytesLocal(e,n,s){const o=new Uint8Array(s);for(let c=0;c<s;c++)o[c]=e.getUint8(n+c);return o}async readHeader(){if(this.headerCache)return this.headerCache;const e=await this.readView(0,32);if(e.getUint32(0,!1)!==2135117396)throw new Error("PKG deÄŸil (magic uyuÅŸmuyor).");const s={entryCount:e.getUint32(16,!1),tableOffset:e.getUint32(24,!1)};return this.headerCache=s,s}async readEntries(){if(this.entriesCache)return this.entriesCache;const e=await this.readHeader(),n=32,s=e.entryCount*n,o=await this.readView(e.tableOffset,s),c=[];for(let f=0;f<e.entryCount;f++){const h=f*n;c.push({id:o.getUint32(h+0,!1),fileOffset:o.getUint32(h+16,!1),fileSize:o.getUint32(h+20,!1)})}return this.entriesCache=c,c}async extractSfo(e=4096){const s=(await this.readEntries()).find(D=>D.id===e);if(!s)throw new Error("PARAM.SFO entry table'da bulunamadÄ±.");const o=await this.readBuffer(s.fileOffset,s.fileSize),c=new DataView(o),f=o.byteLength,h=this.decoder;if(c.getUint32(0,!0)!==1179865088)throw new Error("GeÃ§ersiz SFO magic.");const g=c.getUint32(8,!0),b=c.getUint32(12,!0),_=c.getUint32(16,!0),T=20,L={};for(let D=0;D<_;D++){const P=T+D*16,N=c.getUint16(P+0,!0),E=c.getUint16(P+2,!0),I=c.getUint32(P+4,!0),j=c.getUint32(P+12,!0),X=g+N,G=b+j,K=this.readCStringLocal(c,X,f);if(E===4||E===516){let Y=this.readBytesLocal(c,G,I),Q=Y.length;for(;Q>0&&Y[Q-1]===0;)Q--;L[K]=h.decode(Y.slice(0,Q))}else E===1028?L[K]=c.getUint32(G,!0):L[K]=this.readBytesLocal(c,G,I)}return L}async extractIcon(e=4608){const s=(await this.readEntries()).find(o=>o.id===e);if(!s)throw new Error("ICON0 bulunamadÄ±.");return await this.readBuffer(s.fileOffset,s.fileSize)}async parsePkg(){const[e,n]=await Promise.all([this.extractSfo(),this.extractIcon().catch(()=>null)]);return{sfo:e,icon:n}}}const $a={PROSPERO:2135312712,ORBIS:2135117396};class Vh{static async extractMetadataFromFile(e){const n=await e.slice(0,4).arrayBuffer(),s=new DataView(n).getUint32(0,!1);let o="CUSA12345",c="CUSA12345",f=null;try{if(s===$a.PROSPERO)try{const h=new im(e),{sfo:p,icon:g}=await h.parsePkg();o=p.TITLE,c=p.TITLE_ID,g&&(f=`${Te.getApiUrl()}/api/fs/stream/${await Te.tempFile(g)}`)}catch(h){console.warn("Prospero Parser failed, trying fallback...",h);const p=await e.slice(88,96).arrayBuffer(),g=parseInt(new DataView(p).getBigInt64(0,!0).toString()),b=await e.slice(g+71,g+71+9).arrayBuffer();o=c=new TextDecoder().decode(b)}else if(s===$a.ORBIS)try{const h=new rm(e),{sfo:p,icon:g}=await h.parsePkg();o=p.TITLE,c=p.TITLE_ID,g&&(f=`${Te.getApiUrl()}/api/fs/stream/${await Te.tempFile(g)}`)}catch(h){console.warn("Orbis Parser failed, trying fallback...",h);const p=await e.slice(71,80).arrayBuffer();o=c=new TextDecoder().decode(p)}else throw new Error("Invalid PKG file format.")}catch(h){throw console.error("Metadata extraction failed completely:",h),h}return{title:o,titleId:c,iconPath:f}}}ke(Vh,"PKG_MAGIC",$a);const et="/".endsWith("/")?"/".slice(0,-1):"/";class Te{static async fetch(e){try{const n=await fetch(`${et}${e}`);if(!n.ok)throw new Error("Network response was not ok");return await n.json()}catch(n){throw console.error("API Error:",n),n}}static async getSystemInfo(){return this.fetch("/api/system/info")}static async getStorageInfo(){return this.fetch("/api/storage/info")}static async getProcessList(){return this.fetch("/api/process/list")}static async executeScript(e,n="rulescript"){try{const s=await fetch(`${et}/api/script/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({script:e,type:n})});if(!s.ok)throw new Error("Network response was not ok");return await s.json()}catch(s){throw console.error("Script execution error:",s),s}}static async executeScriptStream(e,n,s="rulescript"){var o;try{const f=(o=(await fetch(`${et}/api/script/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({script:e,type:s})})).body)==null?void 0:o.getReader();if(!f)throw new Error("No reader available");for(;;){const{done:h,value:p}=await f.read();if(h)break;const g=new TextDecoder().decode(p);n(g)}}catch(c){throw c}}static formatBytes(e){if(e===0)return"0 B";const n=1024,s=["B","KB","MB","GB","TB"],o=Math.floor(Math.log(e)/Math.log(n));return`${(e/Math.pow(n,o)).toFixed(1)} ${s[o]}`}static getTitleImageUrl(e){return`${et}/api/title/image/${e}`}static async getSystemStatus(){return this.fetch("/api/system/status")}static async getSystemStats(){return this.fetch("/api/system/stats")}static async getAppList(){return this.fetch("/api/app/list")}static async runApp(e){try{return await(await fetch(`${et}/api/app/run/${e}`)).json()}catch(n){throw console.error("App run error:",n),n}}static async getProfileList(){return this.fetch("/api/profile/list")}static getProfileImageUrl(e){return`${et}/api/profile/image/${e}`}static async downloadBackup(e=null){const n=e?`${et}/api/save/backup/${e}`:`${et}/api/save/backup`;window.location.href=n}static async getTaskList(){return this.fetch("/api/task/list")}static async getTaskDetail(e){try{const n=await fetch(`${et}/api/task/detail`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!n.ok)throw new Error("Network response was not ok");return await n.json()}catch(n){throw console.error("Task detail error:",n),n}}static async updateTask(e,n){try{const o=await(await fetch(`${et}/api/task/update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,...n})})).json();if(o.error)throw new Error(o.error);return{id:e,...n}}catch(s){throw console.error("Task update error:",s),s}}static async createTask(e,n="rulescript"){try{const s=await fetch(`${et}/api/task/create`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,type:n})});if(!s.ok)throw new Error("Network response was not ok");return await s.json()}catch(s){throw console.error("Task create error:",s),s}}static async deleteTask(e){try{const n=await fetch(`${et}/api/task/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!n.ok)throw new Error("Network response was not ok");return await n.json()}catch(n){throw console.error("Task delete error:",n),n}}static async streamTaskLog(e,n){var s;try{const c=(s=(await fetch(`${et}/api/task/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).body)==null?void 0:s.getReader();if(!c)throw new Error("No reader available");for(;;){const{done:f,value:h}=await c.read();if(f)break;const p=new TextDecoder().decode(h);n(p)}}catch(o){throw console.error("Task log stream error:",o),o}}static async getTaskStatus(){try{const e=await fetch(`${et}/api/task/status`);if(!e.ok)throw new Error("Network response was not ok");return await e.json()}catch(e){throw console.error("Task status error:",e),e}}static async listFiles(e){try{const n=await fetch(`${et}/api/fs/list`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e})});if(!n.ok)throw new Error("Network response was not ok");return(await n.json()).map(o=>({id:`${o.name}-${o.mtime}`,name:o.name,type:o.isDirectory?"folder":"file",size:o.size,mtime:o.mtime,permission:o.mode.toString(8),isDirectory:o.isDirectory}))}catch(n){throw console.error("Failed to list files:",n),n}}static async downloadFiles(e){try{const n=btoa(e.join(",")),s=`${et}/api/fs/download/${n}`;window.open(s,"_blank")}catch(n){throw console.error("Download error:",n),n}}static async renameFile(e,n){try{const s=await fetch(`${et}/api/fs/rename`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,name:n})});if(!s.ok)throw new Error("Network response was not ok");return await s.json()}catch(s){throw console.error("Rename error:",s),s}}static async uploadFile(e,n,s){return new Promise((o,c)=>{const f=new XMLHttpRequest,h=new FormData;h.append("file",n),f.open("POST",`${et}/api/fs/upload/${e}`,!0),f.upload.onprogress=p=>{if(p.lengthComputable&&s){const g=p.loaded/p.total*100;s(g)}},f.onload=()=>{f.status>=200&&f.status<300?o(JSON.parse(f.responseText)):c(new Error("Network response was not ok"))},f.onerror=()=>c(new Error("Network error")),f.send(h)})}static async executePayload(e){try{const n=await fetch(`${et}/api/fs/payload`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e})});if(!n.ok)throw new Error("Network response was not ok");return await n.json()}catch(n){throw console.error("Execute payload error:",n),n}}static stopPkgUpload(){vt.stopQueue()}static getSessionKey(){return vt.getSessionKey()}static async cancelPkgUpload(e){try{const n=await fetch(`${et}/api/package/upload/cancel`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionKey:e})});if(!n.ok)throw new Error("Failed to cancel package upload");return await n.json()}catch(n){throw console.error("Cancel package upload error:",n),n}}static async tempFile(e){return(await(await fetch(`${et}/api/fs/temp/file`,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:e})).json()).path}static getApiUrl(){return et}static async uploadPkg(e,n,s){const{title:o,titleId:c,iconPath:f}=await Vh.extractMetadataFromFile(e),h=new URLSearchParams({size:e.size.toString(),titleId:c,title:o,iconPath:f||"null"}),p=await fetch(`${et}/api/package/upload/init?${h}`,{method:"POST"});if(!p.ok)throw new Error(`Network response was not ok: ${p.statusText}`);const{sessionKey:g}=await p.json();return new Promise((b,_)=>{vt.startQueue(e,g,n,T=>{s&&s(T),b(T)},T=>{_(T)})})}static async installPackageFromUrl(e){try{const n=await fetch(`${et}/api/package/install`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e})});if(!n.ok){const s=await n.json();throw new Error(s.error||"Network response was not ok")}return await n.json()}catch(n){throw console.error("Package install error:",n),n}}static async getMediaList(){try{const e=await fetch(`${et}/api/media/list`);if(!e.ok)throw new Error("Network response was not ok");return await e.json()}catch(e){throw console.error("Media list error:",e),e}}static getMediaUrl(e){const n=encodeURIComponent(e);return`${et}/api/media/${n}`}static getMediaThumbnailUrl(e){const n=encodeURIComponent(e);return`${et}/api/media/thumbnails/${n}`}static isVideo(e){return e.toLowerCase().endsWith(".mp4")||e.toLowerCase().endsWith(".webm")||e.toLowerCase().endsWith(".mov")}static getStreamUrl(e){return`${et}/api/fs/stream/${e}`}static async getRemoteScripts(){return this.fetch("/api/script/remote/list")}static async searchRemoteScripts(e){return this.fetch(`/api/script/remote/list?search=${encodeURIComponent(e)}`)}static getScriptImageUrl(e){return`${et}/api/script/remote/image/${e}`}static async executeRemoteScript(e){try{const n=await fetch(`${et}/api/script/remote/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:e})});if(!n.ok)throw new Error("Network response was not ok");return await n.json()}catch(n){throw console.error("Remote script execution error:",n),n}}static async executeRemoteScriptStream(e,n){var s;try{const o=await fetch(`${et}/api/script/remote/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:e})});if(!o.ok)throw new Error(`Server returned ${o.status}: ${o.statusText}`);const c=(s=o.body)==null?void 0:s.getReader();if(!c)throw new Error("No reader available");const f=new TextDecoder;for(;;){const{done:h,value:p}=await c.read();if(h)break;const g=f.decode(p);n(g)}}catch(o){throw console.error("Remote script execution error:",o),o}}static async sendHeartbeat(){try{await fetch(`${et}/api/script/remote/heartbeat`,{method:"POST",headers:{"Content-Type":"application/json"}})}catch(e){throw console.error("Heartbeat error:",e),e}}}const sm=({isDarkMode:i})=>{const[e,n]=ae(null),[s,o]=ae(null),[c,f]=ae(!0),[h,p]=ae(new Set),[g,b]=ae(0);Ve(()=>{const P=setInterval(()=>{b(N=>N+1)},1e3);return()=>clearInterval(P)},[]);const _=async()=>{try{const P=await Te.getSystemStatus(),N=new Set;e&&(Math.abs(P.cpu.frequency-e.cpu.frequency)>5e7&&N.add("frequency"),Math.abs(P.cpu.temperature-e.cpu.temperature)>.5&&N.add("temperature"),Math.abs(P.cpu.socSensorTemperature-e.cpu.socSensorTemperature)>.5&&N.add("socTemp")),p(N),n(P),o(null),setTimeout(()=>p(new Set),1e3)}catch(P){console.error("System info alÄ±namadÄ±:",P),o("Failed to load system information")}finally{f(!1)}};Ve(()=>{_();const P=setInterval(_,5e3);return()=>clearInterval(P)},[]);const T=P=>{if(!P)return"--:--:--";const E=Math.floor(Date.now()/1e3)-P,I=Math.floor(E/3600),j=Math.floor(E%3600/60),X=E%60,G=K=>String(K).padStart(2,"0");return`${G(I)}:${G(j)}:${G(X)}`},L=P=>{switch(P){case 0:return"6CPU";case 1:return"7CPU (LOW)";case 5:return"7CPU (NORMAL)";default:return"Unknown"}},D=(P,N)=>{let E="info-value";return h.has(P)&&(E+=" updated"),P.includes("temperature")&&N>45&&(E+=" warning"),E};return!e||s?v("div",{className:`system-info ${i?"dark":""}`,children:[v("div",{className:"system-info-header",children:"System Information"}),v("div",{className:"system-info-error",children:[v("div",{className:"error-icon",children:"âš ï¸"}),v("div",{className:"error-message",children:s||"Waiting for data..."}),v("div",{className:"error-detail",children:"Unable to retrieve system information. Please check your connection."})]})]}):v("div",{className:`system-info ${i?"dark":""}`,children:[v("div",{className:"system-info-header",children:"System Status"}),v("div",{className:"system-info-content",children:[e.app&&e.app.titleID&&v("div",{className:"info-section",children:[v("div",{className:"section-title",children:"Running App"}),v("div",{className:"game-info",children:[v("div",{className:"game-image",children:v("img",{src:Te.getTitleImageUrl(e.app.titleID),alt:e.app.titleName||e.app.titleID,onError:P=>P.target.style.display="none"})}),v("div",{className:"game-details",children:[v("div",{className:"info-group",children:[v("div",{className:"info-label",children:"Title"}),v("div",{className:"info-value",children:e.app.titleName||e.app.titleID})]}),v("div",{className:"info-group",children:[v("div",{className:"info-label",children:"Process"}),v("div",{className:"info-value",children:[e.app.comm," (",e.app.pid,")"]})]}),v("div",{className:"info-group",children:[v("div",{className:"info-label",children:"Uptime"}),v("div",{className:"info-value uptime",children:T(e.app.start)})]})]})]})]}),v("div",{className:"info-section",children:[v("div",{className:"section-title",children:"System Status"}),v("div",{className:"info-group",children:[v("div",{className:"info-label",children:"Mode"}),v("div",{className:"info-value",children:L(e.cpu.mode)})]}),v("div",{className:"info-group",children:[v("div",{className:"info-label",children:"Frequency"}),v("div",{className:D("frequency",e.cpu.frequency),children:[(e.cpu.frequency/1e6).toFixed(0)," MHz"]})]}),v("div",{className:"info-group",children:[v("div",{className:"info-label",children:"CPU Temp"}),v("div",{className:D("temperature",e.cpu.temperature),children:[e.cpu.temperature.toFixed(1),"Â°C"]})]}),v("div",{className:"info-group",children:[v("div",{className:"info-label",children:"SoC Temp"}),v("div",{className:D("socTemp",e.cpu.socSensorTemperature),children:[e.cpu.socSensorTemperature.toFixed(1),"Â°C"]})]})]})]})]})};let cr=null;const Kh=({isDarkMode:i,showPanel:e,onClose:n})=>{const[s,o]=ae(null),[c,f]=ae(null),[h,p]=ae(!0),g=gt(null),b=async()=>{if(cr){o(cr),p(!1);return}try{const T=await Te.getSystemInfo();cr=T,o(T),f(null),g.current&&clearTimeout(g.current)}catch(T){console.error("System bilgisi alÄ±namadÄ±:",T),f("Failed to load system information"),e&&(g.current=window.setTimeout(()=>{p(!0),b()},5e3))}finally{p(!1)}};Ve(()=>(e&&!cr?b():e&&cr&&(o(cr),p(!1)),()=>{g.current&&clearTimeout(g.current)}),[e]);const _=T=>{if(!T)return"Unknown";const D=Math.floor(Date.now()/1e3)-T,P=D%60,N=Math.floor(D/60)%60,E=Math.floor(D/3600)%24,I=Math.floor(D/86400);return I>0?`${I}d ${E}h ${N}m ${P}s`:E>0?`${E}h ${N}m ${P}s`:N>0?`${N}m ${P}s`:`${P}s`};return e?v("div",{className:`system-details-overlay ${i?"dark":""}`,children:v("div",{className:"system-details-panel",children:[v("div",{className:"system-details-header",children:[v("span",{children:"System Information"}),v("button",{onClick:n,children:"Ã—"})]}),h?v("div",{className:"system-details-loading",children:"Loading system information..."}):c?v("div",{className:"system-details-error",children:[c,v("button",{className:"retry-button",onClick:()=>{p(!0),b()},children:"Try Again"})]}):s&&v("div",{className:"system-details-content",children:[v("div",{className:"detail-group",children:[v("h3",{children:"Hardware Information"}),v("div",{className:"detail-item",children:[v("span",{children:"Model Name:"}),v("span",{children:s.modelName})]}),v("div",{className:"detail-item",children:[v("span",{children:"Serial Number:"}),v("span",{children:s.serialNumber})]}),v("div",{className:"detail-item",children:[v("span",{children:"Hardware Model:"}),v("span",{children:s.hw_model})]}),v("div",{className:"detail-item",children:[v("span",{children:"Architecture:"}),v("span",{children:s.hw_machine})]})]}),v("div",{className:"detail-group",children:[v("h3",{children:"Software Information"}),v("div",{className:"detail-item",children:[v("span",{children:"Operating System:"}),v("span",{children:s.ostype})]}),v("div",{className:"detail-item",children:[v("span",{children:"SDK Version:"}),v("span",{children:s.sdk_version})]}),v("div",{className:"detail-item",children:[v("span",{children:"PS4 SDK:"}),v("span",{children:s.ps4_sdk_version})]}),v("div",{className:"detail-item",children:[v("span",{children:"Kernel Version:"}),v("span",{children:s.kernel_version})]}),v("div",{className:"detail-item",children:[v("span",{children:"Update Version:"}),v("span",{children:s.upd_version})]}),v("div",{className:"detail-item",children:[v("span",{children:"System Uptime:"}),v("span",{children:_(s.kernel_boot_time)})]})]})]})]})}):null},om=({isDarkMode:i})=>{const[e,n]=ae([]),[s,o]=ae(!0),[c,f]=ae(null),[h,p]=ae(null),[g,b]=ae(null),_=["NPXS40032","NPXS40037","NPXS40047","NPXS40053","NPXS40054","NPXS40056","NPXS40063","NPXS40071","NPXS40139","NPXS40144","NPXS40145","NPXS40148","NPXS40149","NPXS40150"];Ve(()=>{(async()=>{try{const N=(await Te.getAppList()).filter(E=>!_.includes(E.titleId)).sort((E,I)=>I.size-E.size);n(N),f(null)}catch(P){console.error("Apps yÃ¼klenemedi:",P),f("Failed to load applications")}finally{o(!1)}})()},[]);const T=D=>{p(D)},L=async D=>{try{const P=await Te.runApp(D);b(P),setTimeout(()=>{b(null)},3e3)}catch{b({success:!1,message:"Error running application"})}};return v("div",{className:`applications ${i?"dark":""}`,children:s?v("div",{className:"applications-loading",children:"Loading applications..."}):c?v("div",{className:"applications-error",children:c}):v(Dt,{children:[v("div",{className:"app-grid",children:e.map(D=>v("div",{className:"app-item",onClick:()=>T(D),children:[v("div",{className:"app-icon",children:v("img",{src:Te.getTitleImageUrl(D.titleId),alt:D.titleName,onError:P=>{const N=P.target;N.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',N.style.background="#2c3e50"}})}),v("div",{className:"app-name",children:D.titleName}),D.size!=0&&v("div",{className:"app-size",children:Te.formatBytes(D.size)})]},D.titleId))}),h&&v("div",{className:"app-details-overlay",onClick:()=>p(null),children:v("div",{className:"app-details",onClick:D=>D.stopPropagation(),children:[v("div",{className:"app-details-header",children:[v("h2",{children:h.titleName}),v("button",{onClick:()=>p(null),children:"Ã—"})]}),v("div",{className:"app-details-content",children:[v("div",{className:"app-details-icon",children:v("img",{src:Te.getTitleImageUrl(h.titleId),alt:h.titleName,onError:D=>{const P=D.target;P.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',P.style.background="#2c3e50"}})}),v("div",{className:"app-details-info",children:[v("div",{className:"detail-row",children:[v("span",{children:"Title ID:"}),v("span",{children:h.titleId})]}),h.size!=0&&v("div",{className:"detail-row",children:[v("span",{children:"Size:"}),v("span",{children:Te.formatBytes(h.size)})]}),h.installTime!=null&&v("div",{className:"detail-row",children:[v("span",{children:"Install Date:"}),v("span",{children:new Date(h.installTime).toLocaleString()})]}),v("div",{className:"detail-actions",children:[v("button",{className:`run-button ${g?g.success?"success":"error":""}`,onClick:()=>L(h.titleId),children:"Run Application"}),g&&v("div",{className:`status-message ${g.success?"success":"error"}`,children:g.message})]})]})]})]})})]})})},am="/assets/elf-icon-CuriXRkE.svg",lm={getFileIcon:(i,e)=>{var s;if(i==="folder")return"ğŸ“";switch(((s=e.split(".").pop())==null?void 0:s.toLowerCase())||""){case"pdf":return"ğŸ“•";case"doc":case"docx":return"ğŸ“˜";case"txt":return"ğŸ“„";case"xls":case"xlsx":return"ğŸ“Š";case"ppt":case"pptx":return"ğŸ“‘";case"jpg":case"jpeg":case"png":case"gif":case"bmp":return"ğŸ–¼ï¸";case"flac":case"mp3":case"wav":case"ogg":return"ğŸµ";case"mp4":case"avi":case"mkv":return"ğŸ¬";case"zip":case"rar":case"7z":return"ğŸ“¦";case"pkg":return"ğŸº";case"js":case"jsx":case"ts":case"tsx":return"âš¡";case"html":return"ğŸŒ";case"css":return"ğŸ¨";case"json":return"ğŸ“‹";case"bin":case"elf":case"self":case"sprx":case"prx":return v("img",{src:am,alt:"ELF",style:{width:"48px",height:"48px"}});default:return"ğŸ“„"}}},cm=({message:i,type:e="info",duration:n=3e3,onClose:s})=>{const[o,c]=ae(!0);return Ve(()=>{const f=setTimeout(()=>{c(!1),setTimeout(()=>{s&&s()},300)},n);return()=>clearTimeout(f)},[n,s]),v("div",{className:`toast ${e} ${o?"visible":"hidden"}`,children:[v("div",{className:"toast-icon",children:[e==="success"&&"âœ“",e==="error"&&"âœ—",e==="warning"&&"âš ",e==="info"&&"â„¹"]}),v("div",{className:"toast-message",children:i}),v("button",{className:"toast-close",onClick:()=>c(!1),children:"Ã—"})]})};class tn{static init(){this.container||(this.container=document.createElement("div"),this.container.className="toast-container",document.body.appendChild(this.container),this.render())}static show(e,n="info",s=3e3){this.init();const o=this.nextId++;return this.toasts.push({id:o,message:e,type:n,duration:s}),this.render(),o}static success(e,n=3e3){return this.show(e,"success",n)}static error(e,n=3e3){return this.show(e,"error",n)}static warning(e,n=3e3){return this.show(e,"warning",n)}static info(e,n=3e3){return this.show(e,"info",n)}static dismiss(e){this.toasts=this.toasts.filter(n=>n.id!==e),this.render()}static render(){if(!this.container)return;document.body.classList.contains("dark")||document.documentElement.classList.contains("dark")||localStorage.getItem("theme")==="dark"?this.container.classList.add("dark"):this.container.classList.remove("dark"),Fi(v("div",{children:this.toasts.map(n=>v(cm,{message:n.message,type:n.type,duration:n.duration,onClose:()=>this.dismiss(n.id)},n.id))}),this.container)}}ke(tn,"container",null),ke(tn,"toasts",[]),ke(tn,"nextId",1);const um=({contextMenu:i,setContextMenu:e,isDarkMode:n=!0,onOpenWindow:s})=>{const[o,c]=ae("/"),[f,h]=ae(["/"]),[p,g]=ae(0),[b,_]=ae([]),[T,L]=ae(!0),[D,P]=ae(null),[N,E]=ae({isSelecting:!1,start:{x:0,y:0},end:{x:0,y:0}}),[I,j]=ae(new Set),[X,G]=ae(!1),[K,Y]=ae({id:null,time:0}),[Q,he]=ae(-1),[fe,oe]=ae(!1),[se,R]=ae(""),[F,S]=ae(null),[ge,Le]=ae(null),[je,Ye]=ae(null),[Ke,Se]=ae(new Set),_e=gt(null),Ne=async B=>{try{L(!0),P(null);const J=await Te.listFiles(B);_(J)}catch(J){console.error("Failed to load files:",J),P("Failed to load files")}finally{L(!1)}};Ve(()=>{Ne(o)},[o]),Ve(()=>{const B=b.filter(J=>Ae(J.name)).map(J=>J.id);Se(new Set(B))},[b]);const Oe=B=>{const J=B.target instanceof HTMLInputElement?B.target.value:"";c(J)},U=B=>{B.key==="Enter"&&Z(o)},Z=async B=>{const J=B.endsWith("/")?B:B+"/";if(e({...i,show:!1}),J!==f[p]){const xe=f.slice(0,p+1);h([...xe,J]),g(xe.length)}c(J)},ie=()=>{p>0&&(g(p-1),c(f[p-1]))},be=()=>{p<f.length-1&&(g(p+1),c(f[p+1]))},Ie=()=>{const B=o.split("/").slice(0,-2).join("/")+"/";B!==o&&Z(B)};Ve(()=>{const B=J=>{var xe;if(!(!((xe=_e.current)!=null&&xe.contains(document.activeElement))||document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA"))switch(J.key){case"Tab":J.preventDefault(),he(ne=>{var Me;const Xe=J.shiftKey?ne<=0?b.length-1:ne-1:ne>=b.length-1?0:ne+1;j(new Set([b[Xe].id]));const Ue=(Me=_e.current)==null?void 0:Me.querySelector(`[data-id="${b[Xe].id}"]`);return Ue==null||Ue.scrollIntoView({block:"nearest"}),Xe});break;case"Enter":if(Q>=0){const ne=b[Q];$t(ne)}break}};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[b,Q]),Ve(()=>{const B=xe=>{if(N.isSelecting&&_e.current){const ne=_e.current.getBoundingClientRect();let Xe=xe.clientX-ne.left,Ue=xe.clientY-ne.top;Xe=Math.max(0,Math.min(Xe,ne.width)),Ue=Math.max(0,Math.min(Ue,ne.height)),E(Me=>({...Me,end:{x:Xe,y:Ue}})),He(Xe,Ue,xe.ctrlKey)}},J=()=>{N.isSelecting&&E(xe=>({...xe,isSelecting:!1}))};return N.isSelecting&&(document.addEventListener("mousemove",B),document.addEventListener("mouseup",J)),()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",J)}},[N.isSelecting]);const Ot=B=>{if(!B.target.closest(".context-menu")&&(B.preventDefault(),!B.target.closest(".file-item")&&!(B.target.classList.contains("file-grid")&&B.clientX>=B.target.getBoundingClientRect().right-20)&&(e({...i,show:!1}),B.button===0&&_e.current))){const J=_e.current.getBoundingClientRect(),xe=B.clientX-J.left,ne=B.clientY-J.top;E({isSelecting:!0,start:{x:xe,y:ne},end:{x:xe,y:ne}}),!B.ctrlKey&&!B.target.closest(".file-item")&&j(new Set),G(!1)}},He=(B,J,xe)=>{if(!_e.current)return;const ne=_e.current.getBoundingClientRect();B=Math.max(0,Math.min(B,ne.width)),J=Math.max(0,Math.min(J,ne.height));const Xe={left:Math.min(N.start.x,B),right:Math.max(N.start.x,B),top:Math.min(N.start.y,J),bottom:Math.max(N.start.y,J)},Ue=_e.current.getElementsByClassName("file-item"),Me=new Set(xe?I:[]);Array.from(Ue).forEach(ot=>{const Yt=ot.getBoundingClientRect(),tt={left:Yt.left-ne.left,right:Yt.right-ne.left,top:Yt.top-ne.top,bottom:Yt.bottom-ne.top};if(!(tt.right<Xe.left||tt.left>Xe.right||tt.bottom<Xe.top||tt.top>Xe.bottom)){const rn=ot.getAttribute("data-id");rn&&Me.add(rn)}}),j(Me)},at=B=>{if(N.isSelecting&&_e.current){const J=_e.current.getBoundingClientRect(),xe=B.clientX-J.left,ne=B.clientY-J.top,Xe=Math.abs(N.end.x-N.start.x),Ue=Math.abs(N.end.y-N.start.y);(Xe>=5||Ue>=5)&&He(xe,ne,B.ctrlKey)}E(J=>({...J,isSelecting:!1})),setTimeout(()=>G(!1),0)},Ft=(B,J)=>{if(B.stopPropagation(),!X){const xe=new Date().getTime();if(K.id===J.id&&xe-K.time<300){$t(J),Y({id:null,time:0});return}if(Y({id:J.id,time:xe}),e({...i,show:!1}),B.ctrlKey||B.metaKey){const ne=new Set(I);I.has(J.id)?ne.delete(J.id):ne.add(J.id),j(ne)}else if(B.shiftKey&&I.size>0){const ne=Array.from(I)[I.size-1],Xe=b.findIndex(tt=>tt.id===ne),Ue=b.findIndex(tt=>tt.id===J.id),Me=Math.min(Xe,Ue),ot=Math.max(Xe,Ue),Yt=new Set(I);for(let tt=Me;tt<=ot;tt++)Yt.add(b[tt].id);j(Yt)}else j(new Set([J.id]))}},$t=B=>{if(B.isDirectory){e({...i,show:!1});const J=o+B.name+"/";Z(J)}else Ee(B.name)?Ge(B):Ae(B.name)?Fe(B):console.log("Open File:",B.name)},V=B=>{if(!B)return!1;const J=[".mp3",".wav",".ogg",".flac",".aac",".m4a"],xe=B.toLowerCase();return J.some(ne=>xe.endsWith(ne))},me=B=>{if(!B)return!1;const J=[".mp4",".webm",".mkv",".avi",".mov",".wmv",".mpg",".mpeg",".m4v"],xe=B.toLowerCase();return J.some(ne=>xe.endsWith(ne))},Ae=B=>{if(!B)return!1;const J=[".jpg",".jpeg",".png",".gif",".bmp",".webp",".svg",".ico"],xe=B.toLowerCase();return J.some(ne=>xe.endsWith(ne))},Ee=B=>V(B)||me(B),Ge=B=>{s&&s({app:"mediaPlayer",title:`Media Player - ${B.name}`,props:{mediaFile:B,currentPath:o}})},Fe=B=>{s&&s({app:"imageViewer",title:`Image Viewer - ${B.name}`,props:{imageFile:B,currentPath:o}})},We=(B,J)=>{N.isSelecting||(B.preventDefault(),I.has(J.id)||j(new Set([J.id])),e({show:!0,x:B.pageX,y:B.pageY,item:J,isBackground:!1}))},ze=B=>{const J=Array.from(I).map(ne=>{const Xe=b.find(Ue=>Ue.id===ne);return Xe?o+Xe.name:""}).filter(ne=>ne!==""),xe=J.length>0?J:[o+B.name];try{Te.downloadFiles(xe)}catch(ne){console.error("Download failed:",ne)}e({...i,show:!1})},Ht=B=>{const J=Array.from(I).map(Xe=>b.find(Ue=>Ue.id===Xe)).filter(Xe=>Xe!==void 0),xe=J.map(Xe=>`â€¢ ${Xe.name}`).join(`
`),ne=J.length>1?`Are you sure you want to delete these ${J.length} items?

${xe}`:`Are you sure you want to delete "${B.name}"?`;if(window.confirm(ne)){const Xe=b.filter(Ue=>!I.has(Ue.id));_(Xe),j(new Set),console.log("Deleted items:",J.map(Ue=>Ue.name))}e({...i,show:!1})},Fn=B=>{B.preventDefault();const J=B.target;if(J.classList.contains("file-manager")||J.classList.contains("file-grid"))if(I.size>0){const xe=b.find(ne=>ne.id===Array.from(I)[0]);e({show:!0,x:B.pageX,y:B.pageY,isBackground:!1,item:xe})}else e({show:!0,x:B.pageX,y:B.pageY,isBackground:!0,item:null})},vn=B=>{B.preventDefault(),B.dataTransfer&&(B.dataTransfer.dropEffect="copy")},un=async B=>{B.preventDefault();const J=B.dataTransfer?Array.from(B.dataTransfer.files):[];if(J.length>0){Le(0),Ye(null);try{for(const xe of J)await Te.uploadFile(o+xe.name,xe,ne=>{Le(ne)});Le(100),setTimeout(()=>Le(null),3e3),Ne(o)}catch(xe){console.error("Upload failed:",xe),Ye(xe.message)}}},C=B=>{S(B.id),R(B.name),oe(!0),e({...i,show:!1})},z=async B=>{try{se&&se!==B.name&&(await Te.renameFile(o+B.name,se),Ne(o))}catch(J){console.error("Rename failed:",J)}finally{oe(!1),S(null)}},$=async B=>{try{const J=await Te.executePayload(o+B.name);J.success?tn.success("Payload executed successfully"):tn.error(J.message||"Failed to execute payload")}catch(J){console.error("Execute payload failed:",J),tn.error("Network error while executing payload")}e({...i,show:!1})},te=async B=>{try{const J=Array.from(I).map(ne=>b.find(Ue=>Ue.id===ne)).filter(ne=>ne!==void 0&&ne.name.toLowerCase().endsWith(".pkg")).map(ne=>o+ne.name);if(J.length===0&&B.name.toLowerCase().endsWith(".pkg")&&J.push(o+B.name),J.length===0){tn.error("No PKG files selected for installation");return}let xe=0;for(const ne of J)await Te.installPackageFromUrl(ne),xe++;xe===1?tn.success("Package installation started"):tn.success(`Installation of ${xe} packages started`)}catch(J){console.error("Package installation failed:",J),tn.error(J.message||"Failed to install package")}e({...i,show:!1})};return v("div",{ref:_e,className:`file-manager ${n?"dark":""}`,onMouseDown:Ot,onMouseUp:at,onContextMenu:Fn,onDragOver:vn,onDrop:un,children:[v("div",{className:"path-navigation",children:[v("div",{className:"path-buttons",children:[v("button",{onClick:ie,disabled:p<=0,title:"Back",children:"â—€"}),v("button",{onClick:be,disabled:p>=f.length-1,title:"Forward",children:"â–¶"}),v("button",{onClick:Ie,disabled:o==="/",title:"Parent Directory",children:"â–²"})]}),v("input",{type:"text",className:"path-input",value:o,onChange:Oe,onKeyDown:U})]}),v("div",{className:"file-grid",onScroll:()=>{N.isSelecting&&E(B=>({...B,isSelecting:!1}))},children:T?v("div",{className:"loading",children:"Loading files..."}):D?v("div",{className:"error",children:D}):b.length===0?v("div",{className:"empty",children:"No files found"}):b.map((B,J)=>v("div",{"data-id":String(B.id),className:`file-item ${I.has(B.id)?"selected":""} ${J===Q?"focused":""}`,tabIndex:0,onClick:xe=>Ft(xe,B),onContextMenu:xe=>We(xe,B),onFocus:()=>{he(J),I.has(B.id)||j(new Set([B.id]))},children:[v("div",{className:"file-icon icon",children:Ae(B.name)?v("div",{className:"image-thumbnail",children:[Ke.has(B.id)&&v("div",{className:"image-loading-spinner",children:v("div",{className:"spinner"})}),v("img",{src:Te.getStreamUrl(o+B.name),alt:B.name,loading:"lazy",onLoad:()=>{Se(xe=>{const ne=new Set(xe);return ne.delete(B.id),ne})},style:{opacity:Ke.has(B.id)?0:1},onError:()=>{Se(xe=>{const ne=new Set(xe);return ne.delete(B.id),ne})}})]}):lm.getFileIcon(B.type,B.name)}),fe&&F===B.id?v("input",{type:"text",className:"rename-input",value:se,onChange:xe=>R(xe.target.value),onBlur:()=>z(B),onKeyDown:xe=>{xe.key==="Enter"?z(B):xe.key==="Escape"&&(oe(!1),S(null))},autoFocus:!0}):v("div",{className:"file-name",children:B.name})]},B.id))}),ge!==null&&v("div",{className:"upload-progress",children:["Uploading: ",Math.round(ge),"%",v("div",{className:"upload-progress-bar",children:v("div",{className:"upload-progress-bar-fill",style:{width:`${ge}%`}})})]}),je&&v("div",{className:"upload-error",children:je}),N.isSelecting&&v("div",{className:"selection-box",style:{left:`${Math.min(N.start.x,N.end.x)}px`,top:`${Math.min(N.start.y,N.end.y)}px`,width:`${Math.abs(N.end.x-N.start.x)}px`,height:`${Math.abs(N.end.y-N.start.y)}px`}}),i.show&&v("div",{className:`context-menu ${n?"dark":""}`,style:{left:`${i.x}px`,top:`${i.y}px`},children:[!i.isBackground&&i.item&&i.item.name&&i.item.name.toLowerCase().endsWith(".pkg")&&v(Dt,{children:[v("div",{className:"context-menu-item install",onClick:()=>te(i.item),children:"Install Package"}),v("div",{className:"context-menu-separator"})]}),!i.isBackground&&i.item&&i.item.name&&(i.item.name.endsWith(".elf")||i.item.name.endsWith(".bin"))&&v(Dt,{children:[v("div",{className:"context-menu-separator"}),v("div",{className:"context-menu-item execute",onClick:()=>$(i.item),children:"Execute Payload"})]}),i.isBackground?v("div",{className:"context-menu-item create-folder",children:"Create Folder"}):v(Dt,{children:[v("div",{className:"context-menu-item download",onClick:()=>ze(i.item),children:"Download"}),v("div",{className:"context-menu-item rename",onClick:()=>C(i.item),children:"Rename"}),v("div",{className:"context-menu-separator"}),v("div",{className:"context-menu-item delete",onClick:()=>Ht(i.item),children:"Delete"})]})]})]})},fm=({isDarkMode:i})=>{const[e,n]=ae([]),[s,o]=ae({}),[c,f]=ae(!0),[h,p]=ae(null),[g,b]=ae("all"),[_,T]=ae("all"),[L,D]=ae("date-desc"),[P,N]=ae(null),[E,I]=ae(!1);Ve(()=>{j()},[]);const j=async()=>{try{f(!0),p(null);const F=await Te.getMediaList(),S=F.entries.map(ge=>{const Le=ge.filePath.toLowerCase().endsWith(".mp4"),je=X(ge.filePath),Ye=ge.ext&&ge.ext.trophy,Ke=ge.meta&&ge.meta.appVerTitleId;let Se=null;return ge.meta&&ge.meta.segmentInfo&&ge.meta.segmentInfo.mediaTime&&ge.meta.segmentInfo.mediaTime.length>0&&ge.meta.segmentInfo.mediaTime[0].length>1&&(Se=ge.meta.segmentInfo.mediaTime[0][1]),{...ge,isVideo:Le,isJxr:je,hasTrophy:Ye,titleId:Ke,duration:Se,date:ge.meta&&ge.meta.segmentInfo?new Date(ge.meta.segmentInfo.start):new Date(0)}});n(S),o(F.titles||{})}catch(F){console.error("Failed to load media list:",F),p("Failed to load media list"),tn.error("Failed to load media list")}finally{f(!1)}},X=F=>{if(!F)return!1;const S=F.toLowerCase();return S.endsWith(".jxr")||S.endsWith(".wdp")||S.endsWith(".hdp")},G=F=>{try{const S=Te.getMediaUrl(F.filePath+"?download=true"),ge=document.createElement("a");ge.href=S,ge.download=F.filePath.split("/").pop()||"media",document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),tn.success("Download started")}catch(S){console.error("Download failed:",S),tn.error("Download failed")}},K=F=>{N(F),I(!0)},Y=()=>{I(!1),N(null)},Q=F=>F?s[F]||"Deleted Games and Apps":"Unknown",he=()=>{let F=[...e];return g==="images"?F=F.filter(S=>!S.isVideo):g==="videos"?F=F.filter(S=>S.isVideo):g==="trophies"&&(F=F.filter(S=>S.hasTrophy)),_!=="all"&&(F=F.filter(S=>S.titleId===_)),L==="date-desc"?F.sort((S,ge)=>ge.date.getTime()-S.date.getTime()):L==="date-asc"&&F.sort((S,ge)=>S.date.getTime()-ge.date.getTime()),F},fe=()=>{const F=new Set;return e.forEach(S=>{S.titleId&&F.add(S.titleId)}),Array.from(F)},oe=he(),se=fe(),R=F=>{if(!F)return"";const S=Math.floor(F/1e3),ge=Math.floor(S/3600),Le=Math.floor(S%3600/60),je=S%60;return ge>0?`${ge.toString().padStart(2,"0")}:${Le.toString().padStart(2,"0")}:${je.toString().padStart(2,"0")}`:`${Le.toString().padStart(2,"0")}:${je.toString().padStart(2,"0")}`};return v("div",{className:`media-gallery ${i?"dark":""}`,children:[v("div",{className:"media-toolbar",children:[v("div",{className:"filter-group",children:[v("label",{children:"Filter:"}),v("select",{value:g,onChange:F=>b(F.target.value),className:"filter-select",children:[v("option",{value:"all",children:"All Media"}),v("option",{value:"images",children:"Images Only"}),v("option",{value:"videos",children:"Videos Only"}),v("option",{value:"trophies",children:"Trophy Media"})]})]}),v("div",{className:"filter-group",children:[v("label",{children:"Game:"}),v("select",{value:_,onChange:F=>T(F.target.value),className:"filter-select",children:[v("option",{value:"all",children:"All Games"}),se.map(F=>v("option",{value:F,children:Q(F)},F))]})]}),v("div",{className:"filter-group",children:[v("label",{children:"Sort:"}),v("select",{value:L,onChange:F=>D(F.target.value),className:"filter-select",children:[v("option",{value:"date-desc",children:"Newest First"}),v("option",{value:"date-asc",children:"Oldest First"})]})]}),v("button",{className:"refresh-button icon",onClick:j,disabled:c,children:"ğŸ”„"})]}),v("div",{className:"media-content",children:c?v("div",{className:"media-loading",children:"Loading media..."}):h?v("div",{className:"media-error",children:h}):oe.length===0?v("div",{className:"media-empty",children:"No media found"}):v("div",{className:"media-grid",children:oe.map((F,S)=>v("div",{className:"media-item",onClick:()=>K(F),children:[v("div",{className:"media-thumbnail",children:[F.isVideo&&v("div",{className:"video-indicator",children:"â–¶"}),F.isJxr?v("div",{className:"jxr-thumbnail",children:v("div",{className:"jxr-thumbnail-content",children:[v("div",{className:"jxr-thumbnail-icon",children:"HDR"}),v("div",{className:"jxr-thumbnail-text",children:"HDR Content"})]})}):v("img",{src:Te.getMediaThumbnailUrl(F.filePath),alt:"Media thumbnail",loading:"lazy"}),F.hasTrophy&&v("div",{className:"trophy-badge icon",title:"Trophy Earned",children:"ğŸ†"})]}),v("div",{className:"media-info",children:[v("div",{className:"media-title",title:Q(F.titleId),children:Q(F.titleId)}),v("div",{className:"media-details",children:[v("div",{className:"media-date",children:F.date.toLocaleDateString()}),F.isVideo&&F.duration&&v("div",{className:"media-duration",children:R(F.duration)})]})]})]},S))})}),E&&P&&v("div",{className:"media-viewer-overlay",onClick:Y,children:v("div",{className:"media-viewer",onClick:F=>F.stopPropagation(),children:[v("div",{className:"viewer-header",children:[v("div",{className:"viewer-title",children:[Q(P.titleId),P.hasTrophy&&v("span",{className:"viewer-trophy",children:"ğŸ†"}),P.isJxr&&v("span",{className:"viewer-hdr",children:"HDR"})]}),v("div",{className:"viewer-actions",children:[v("button",{className:"download-button icon",onClick:()=>G(P),title:"Download",children:"â¬‡ï¸"}),v("button",{className:"close-button",onClick:Y,title:"Close",children:"âœ–"})]})]}),v("div",{className:"viewer-content",children:P.isVideo?v("video",{src:Te.getMediaUrl(P.filePath),controls:!0,autoPlay:!0}):P.isJxr?v("div",{className:"hdr-content-container",children:v("div",{className:"hdr-content-message",children:[v("div",{className:"hdr-icon",children:"HDR"}),v("div",{className:"hdr-text",children:"HDR Content cannot be previewed."})]})}):v("img",{src:Te.getMediaUrl(P.filePath),alt:"Media content"})}),v("div",{className:"viewer-footer",children:[v("div",{className:"media-date",children:P.date.toLocaleString()}),P.isVideo&&P.duration&&v("div",{className:"media-duration viewer-duration",children:R(P.duration)})]})]})})]})},hm=({mediaFile:i,currentPath:e,onClose:n})=>{const[s,o]=ae(!0),c=b(i==null?void 0:i.name),f=gt(null),h=gt(null),p=gt(null),g=gt("");Ve(()=>{if(!i||!e)return;o(!0),p.current||(p.current=new AbortController);const T=Te.getStreamUrl(e+i.name),L=T.includes("?")?"&":"?";return g.current=`${T}${L}t=${Date.now()}`,()=>{p.current&&(p.current.abort(),p.current=null),f.current&&(f.current.pause(),f.current.src="",f.current.load()),h.current&&(h.current.pause(),h.current.src="",h.current.load())}},[i,e]);function b(T){if(!T)return!1;const L=[".mp3",".wav",".ogg",".flac",".aac",".m4a"],D=T.toLowerCase();return L.some(P=>D.endsWith(P))}return v("div",{className:"media-player",children:[v("div",{className:"download-button-container",children:v("button",{className:"download-button-media",onClick:()=>{if(i){const T=e+i.name;Te.downloadFiles([T])}},title:"Ä°ndir",children:v("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[v("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),v("polyline",{points:"7 10 12 15 17 10"}),v("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})})}),v("div",{className:"media-player-content",children:[c?v("div",{className:"audio-player-wrapper",children:[v("div",{className:"audio-visualization",children:[v("div",{className:"audio-icon",children:v("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round",children:[v("circle",{cx:"12",cy:"12",r:"10"}),v("circle",{cx:"12",cy:"12",r:"3"}),v("line",{x1:"12",y1:"2",x2:"12",y2:"4"}),v("line",{x1:"12",y1:"20",x2:"12",y2:"22"}),v("line",{x1:"4",y1:"12",x2:"2",y2:"12"}),v("line",{x1:"22",y1:"12",x2:"20",y2:"12"}),v("line",{x1:"6.34",y1:"6.34",x2:"4.93",y2:"4.93"}),v("line",{x1:"19.07",y1:"4.93",x2:"17.66",y2:"6.34"}),v("line",{x1:"17.66",y1:"17.66",x2:"19.07",y2:"19.07"}),v("line",{x1:"4.93",y1:"19.07",x2:"6.34",y2:"17.66"})]})}),v("div",{className:"audio-title-large",children:i==null?void 0:i.name})]}),i&&v("audio",{ref:f,src:g.current,controls:!0,autoPlay:!0,className:"audio-player-element",onLoadStart:()=>o(!0),onLoadedData:()=>o(!1),onError:()=>o(!1)})]}):v("div",{className:"video-container",children:i&&v("video",{ref:h,src:g.current,controls:!0,autoPlay:!0,onLoadStart:()=>o(!0),onLoadedData:()=>o(!1),onError:()=>o(!1)})}),s&&v("div",{className:"media-loading",children:[v("div",{className:"media-spinner"}),v("div",{className:"media-loading-text",children:"Loading..."})]})]})]})},dm=({imageFile:i,currentPath:e,onClose:n})=>{const[s,o]=ae(!0),c=gt(null),f=gt(null),h=gt("");return Ve(()=>{if(!i||!e)return;o(!0),f.current||(f.current=new AbortController);const g=Te.getStreamUrl(e+i.name),b=g.includes("?")?"&":"?";return h.current=`${g}${b}t=${Date.now()}`,()=>{f.current&&(f.current.abort(),f.current=null)}},[i,e]),Ve(()=>{const g=c.current;if(!g)return;const b=()=>{console.log("Image loaded"),o(!1)},_=()=>{console.log("Image error"),o(!1)};return g.addEventListener("load",b),g.addEventListener("error",_),()=>{g.removeEventListener("load",b),g.removeEventListener("error",_)}},[c.current,i]),v("div",{className:"image-viewer",children:v("div",{className:"image-viewer-content",children:[v("button",{className:"download-button floating",onClick:()=>{if(i){const g=e+i.name;Te.downloadFiles([g])}},title:"Ä°ndir",children:v("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[v("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),v("polyline",{points:"7 10 12 15 17 10"}),v("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),s&&v("div",{className:"image-loading",children:[v("div",{className:"image-spinner"}),v("div",{className:"image-loading-text",children:"Image is loading..."})]}),i&&v("img",{ref:c,src:h.current,alt:i==null?void 0:i.name,className:"image-viewer-img"})]})})},pm=({isDarkMode:i})=>{const[e,n]=ae([]),[s,o]=ae(!0),[c,f]=ae(null),[h,p]=ae(new Set),[g,b]=ae(!1),[_,T]=ae(null),[L,D]=ae({key:"pid",direction:"asc"}),[P,N]=ae(0);Ve(()=>{const K=setInterval(()=>{N(Y=>Y+1)},1e3);return()=>clearInterval(K)},[]),Ve(()=>{const K=async()=>{try{const Q=await Te.getProcessList();if(!Array.isArray(Q))throw new Error("Invalid data format");const he=e.reduce((se,R)=>(se[R.pid]=R,se),{}),fe=new Set,oe=Q.map(se=>{const R=he[se.pid];return R&&(R.rssize!==se.rssize&&fe.add(`memory-${se.pid}`),R.stat!==se.stat&&fe.add(`stat-${se.pid}`)),delete he[se.pid],se});p(fe),setTimeout(()=>p(new Set),1e3),n(oe),f(null),b(!1),T(new Date)}catch(Q){console.error("Failed to fetch processes:",Q),e.length===0?f("Failed to load process list"):b(!0)}finally{o(!1)}};K();const Y=setInterval(K,5e3);return()=>clearInterval(Y)},[]);const E=K=>{let Y="asc";L.key===K&&L.direction==="asc"&&(Y="desc"),D({key:K,direction:Y})},I=()=>{const K=[...e];return K.sort((Y,Q)=>{let he=Y[L.key],fe=Q[L.key];return L.key==="rssize"&&(he=Y.rssize*Y.pageSize,fe=Q.rssize*Q.pageSize),he<fe?L.direction==="asc"?-1:1:he>fe?L.direction==="asc"?1:-1:0}),K},j=K=>`${(K*16384/(1024*1024)).toFixed(1)} MB`,X=K=>{if(!K)return"--:--:--";const Q=Math.floor(Date.now()/1e3)-K,he=Math.floor(Q/3600),fe=Math.floor(Q%3600/60),oe=Q%60,se=R=>String(R).padStart(2,"0");return`${se(he)}:${se(fe)}:${se(oe)}`},G=(K,Y)=>{const Q=`${K}-${Y}`;return h.has(Q)?"updated":""};return s&&e.length===0?v("div",{className:`process-list ${i?"dark":""}`,children:v("div",{className:"process-list-message loading",children:[v("div",{className:"loading-spinner"}),v("div",{children:"Loading process list..."})]})}):c&&e.length===0?v("div",{className:`process-list ${i?"dark":""}`,children:v("div",{className:"process-list-message error",children:c})}):e.length?v("div",{className:`process-list ${i?"dark":""}`,children:[g&&v("div",{className:"update-status error",children:[v("span",{className:"error-icon",children:"âš ï¸"}),"Last update failed",_&&v("span",{className:"last-update",children:["Last successful update: ",_.toLocaleTimeString()]})]}),v("table",{children:[v("thead",{children:v("tr",{children:[v("th",{onClick:()=>E("pid"),children:"PID"}),v("th",{onClick:()=>E("comm"),children:"Process Name"}),v("th",{onClick:()=>E("ppid"),children:"PPID"}),v("th",{onClick:()=>E("rssize"),children:"Memory"}),v("th",{onClick:()=>E("stat"),children:"Status"}),v("th",{onClick:()=>E("start"),children:"Uptime"}),v("th",{onClick:()=>E("emul"),children:"Type"}),v("th",{onClick:()=>E("titleID"),children:"Title ID"})]})}),v("tbody",{children:I().map(K=>v("tr",{children:[v("td",{children:K.pid}),v("td",{children:K.comm}),v("td",{children:K.ppid}),v("td",{className:G("memory",K.pid),children:j(K.rssize)}),v("td",{className:G("stat",K.pid),children:K.stat}),v("td",{children:X(K.start)}),v("td",{children:K.emul}),v("td",{children:K.titleID||"-"})]},K.pid))})]})]}):v("div",{className:`process-list ${i?"dark":""}`,children:v("div",{className:"process-list-message",children:"No processes found"})})},gm=({isDarkMode:i})=>{const[e,n]=ae([]),[s,o]=ae(!0),[c,f]=ae(null),[h,p]=ae(null);Ve(()=>{(async()=>{try{const T=await Te.getProfileList();n(T),f(null)}catch(T){console.error("Profiles yÃ¼klenemedi:",T),f("Failed to load profiles")}finally{o(!1)}})()},[]);const g=_=>{p(_)},b=async(_=null)=>{try{await Te.downloadBackup(_)}catch(T){console.error("Backup failed:",T)}};return v("div",{className:`profiles ${i?"dark":""}`,children:s?v("div",{className:"profiles-loading",children:"Loading profiles..."}):c?v("div",{className:"profiles-error",children:c}):v(Dt,{children:[v("div",{className:"profiles-header",children:[v("h2",{children:"User Profiles"}),v("button",{className:"backup-all-button",onClick:()=>b(),children:[v("span",{className:"icon",children:"ğŸ’¾"}),"Save All Profile Backup Files"]})]}),v("div",{className:"profile-grid",children:e.map(_=>v("div",{className:"profile-item",onClick:()=>g(_),children:[v("div",{className:"profile-icon",children:v("img",{src:Te.getProfileImageUrl(_.profileId),alt:_.username,onError:T=>{const L=T.target;L.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',L.style.background="#2c3e50"}})}),v("div",{className:"profile-name",children:_.username})]},_.profileId))}),h&&v("div",{className:"profile-details-overlay",onClick:()=>p(null),children:v("div",{className:"profile-details",onClick:_=>_.stopPropagation(),children:[v("div",{className:"profile-details-header",children:[v("h2",{children:h.username}),v("button",{onClick:()=>p(null),children:"Ã—"})]}),v("div",{className:"profile-details-content",children:[v("div",{className:"profile-details-icon",children:v("img",{src:Te.getProfileImageUrl(h.profileId),alt:h.username,onError:_=>{const T=_.target;T.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',T.style.background="#2c3e50"}})}),v("div",{className:"profile-details-info",children:[v("div",{className:"detail-row",children:[v("span",{children:"Username:"}),v("span",{children:h.username})]}),v("div",{className:"detail-row",children:[v("span",{children:"Profile ID:"}),v("span",{children:h.profileId})]}),v("div",{className:"detail-actions",children:v("button",{className:"backup-button icon",onClick:()=>b(h.profileId),children:"Backup Save Files"})})]})]})]})})]})})};function mm(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Lo={exports:{}},vm=Lo.exports,Ju;function Vo(){return Ju||(Ju=1,function(i,e){(function(n,s){i.exports=s()})(vm,function(){var n=navigator.userAgent,s=navigator.platform,o=/gecko\/\d/i.test(n),c=/MSIE \d/.test(n),f=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(n),h=/Edge\/(\d+)/.exec(n),p=c||f||h,g=p&&(c?document.documentMode||6:+(h||f)[1]),b=!h&&/WebKit\//.test(n),_=b&&/Qt\/\d+\.\d+/.test(n),T=!h&&/Chrome\//.test(n),L=/Opera\//.test(n),D=/Apple Computer/.test(navigator.vendor),P=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(n),N=/PhantomJS/.test(n),E=D&&(/Mobile\/\w+/.test(n)||navigator.maxTouchPoints>2),I=/Android/.test(n),j=E||I||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(n),X=E||/Mac/.test(s),G=/\bCrOS\b/.test(n),K=/win/i.test(s),Y=L&&n.match(/Version\/(\d*\.\d*)/);Y&&(Y=Number(Y[1])),Y&&Y>=15&&(L=!1,b=!0);var Q=X&&(_||L&&(Y==null||Y<12.11)),he=o||p&&g>=9;function fe(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}var oe=function(t,r){var l=t.className,a=fe(r).exec(l);if(a){var u=l.slice(a.index+a[0].length);t.className=l.slice(0,a.index)+(u?a[1]+u:"")}};function se(t){for(var r=t.childNodes.length;r>0;--r)t.removeChild(t.firstChild);return t}function R(t,r){return se(t).appendChild(r)}function F(t,r,l,a){var u=document.createElement(t);if(l&&(u.className=l),a&&(u.style.cssText=a),typeof r=="string")u.appendChild(document.createTextNode(r));else if(r)for(var d=0;d<r.length;++d)u.appendChild(r[d]);return u}function S(t,r,l,a){var u=F(t,r,l,a);return u.setAttribute("role","presentation"),u}var ge;document.createRange?ge=function(t,r,l,a){var u=document.createRange();return u.setEnd(a||t,l),u.setStart(t,r),u}:ge=function(t,r,l){var a=document.body.createTextRange();try{a.moveToElementText(t.parentNode)}catch{return a}return a.collapse(!0),a.moveEnd("character",l),a.moveStart("character",r),a};function Le(t,r){if(r.nodeType==3&&(r=r.parentNode),t.contains)return t.contains(r);do if(r.nodeType==11&&(r=r.host),r==t)return!0;while(r=r.parentNode)}function je(){var t;try{t=document.activeElement}catch{t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function Ye(t,r){var l=t.className;fe(r).test(l)||(t.className+=(l?" ":"")+r)}function Ke(t,r){for(var l=t.split(" "),a=0;a<l.length;a++)l[a]&&!fe(l[a]).test(r)&&(r+=" "+l[a]);return r}var Se=function(t){t.select()};E?Se=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:p&&(Se=function(t){try{t.select()}catch{}});function _e(t){var r=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,r)}}function Ne(t,r,l){r||(r={});for(var a in t)t.hasOwnProperty(a)&&(l!==!1||!r.hasOwnProperty(a))&&(r[a]=t[a]);return r}function Oe(t,r,l,a,u){r==null&&(r=t.search(/[^\s\u00a0]/),r==-1&&(r=t.length));for(var d=a||0,m=u||0;;){var y=t.indexOf("	",d);if(y<0||y>=r)return m+(r-d);m+=y-d,m+=l-m%l,d=y+1}}var U=function(){this.id=null,this.f=null,this.time=0,this.handler=_e(this.onTimeout,this)};U.prototype.onTimeout=function(t){t.id=0,t.time<=+new Date?t.f():setTimeout(t.handler,t.time-+new Date)},U.prototype.set=function(t,r){this.f=r;var l=+new Date+t;(!this.id||l<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,t),this.time=l)};function Z(t,r){for(var l=0;l<t.length;++l)if(t[l]==r)return l;return-1}var ie=50,be={toString:function(){return"CodeMirror.Pass"}},Ie={scroll:!1},Ot={origin:"*mouse"},He={origin:"+move"};function at(t,r,l){for(var a=0,u=0;;){var d=t.indexOf("	",a);d==-1&&(d=t.length);var m=d-a;if(d==t.length||u+m>=r)return a+Math.min(m,r-u);if(u+=d-a,u+=l-u%l,a=d+1,u>=r)return a}}var Ft=[""];function $t(t){for(;Ft.length<=t;)Ft.push(V(Ft)+" ");return Ft[t]}function V(t){return t[t.length-1]}function me(t,r){for(var l=[],a=0;a<t.length;a++)l[a]=r(t[a],a);return l}function Ae(t,r,l){for(var a=0,u=l(r);a<t.length&&l(t[a])<=u;)a++;t.splice(a,0,r)}function Ee(){}function Ge(t,r){var l;return Object.create?l=Object.create(t):(Ee.prototype=t,l=new Ee),r&&Ne(r,l),l}var Fe=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function We(t){return/\w/.test(t)||t>"Â€"&&(t.toUpperCase()!=t.toLowerCase()||Fe.test(t))}function ze(t,r){return r?r.source.indexOf("\\w")>-1&&We(t)?!0:r.test(t):We(t)}function Ht(t){for(var r in t)if(t.hasOwnProperty(r)&&t[r])return!1;return!0}var Fn=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function vn(t){return t.charCodeAt(0)>=768&&Fn.test(t)}function un(t,r,l){for(;(l<0?r>0:r<t.length)&&vn(t.charAt(r));)r+=l;return r}function C(t,r,l){for(var a=r>l?-1:1;;){if(r==l)return r;var u=(r+l)/2,d=a<0?Math.ceil(u):Math.floor(u);if(d==r)return t(d)?r:l;t(d)?l=d:r=d+a}}function z(t,r,l,a){if(!t)return a(r,l,"ltr",0);for(var u=!1,d=0;d<t.length;++d){var m=t[d];(m.from<l&&m.to>r||r==l&&m.to==r)&&(a(Math.max(m.from,r),Math.min(m.to,l),m.level==1?"rtl":"ltr",d),u=!0)}u||a(r,l,"ltr")}var $=null;function te(t,r,l){var a;$=null;for(var u=0;u<t.length;++u){var d=t[u];if(d.from<r&&d.to>r)return u;d.to==r&&(d.from!=d.to&&l=="before"?a=u:$=u),d.from==r&&(d.from!=d.to&&l!="before"?a=u:$=u)}return a??$}var B=function(){var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",r="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function l(w){return w<=247?t.charAt(w):1424<=w&&w<=1524?"R":1536<=w&&w<=1785?r.charAt(w-1536):1774<=w&&w<=2220?"r":8192<=w&&w<=8203?"w":w==8204?"b":"L"}var a=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,u=/[stwN]/,d=/[LRr]/,m=/[Lb1n]/,y=/[1n]/;function x(w,M,O){this.level=w,this.from=M,this.to=O}return function(w,M){var O=M=="ltr"?"L":"R";if(w.length==0||M=="ltr"&&!a.test(w))return!1;for(var W=w.length,H=[],q=0;q<W;++q)H.push(l(w.charCodeAt(q)));for(var re=0,ue=O;re<W;++re){var de=H[re];de=="m"?H[re]=ue:ue=de}for(var ve=0,pe=O;ve<W;++ve){var we=H[ve];we=="1"&&pe=="r"?H[ve]="n":d.test(we)&&(pe=we,we=="r"&&(H[ve]="R"))}for(var Pe=1,De=H[0];Pe<W-1;++Pe){var Be=H[Pe];Be=="+"&&De=="1"&&H[Pe+1]=="1"?H[Pe]="1":Be==","&&De==H[Pe+1]&&(De=="1"||De=="n")&&(H[Pe]=De),De=Be}for(var st=0;st<W;++st){var Tt=H[st];if(Tt==",")H[st]="N";else if(Tt=="%"){var ft=void 0;for(ft=st+1;ft<W&&H[ft]=="%";++ft);for(var Qt=st&&H[st-1]=="!"||ft<W&&H[ft]=="1"?"1":"N",Xt=st;Xt<ft;++Xt)H[Xt]=Qt;st=ft-1}}for(var bt=0,Gt=O;bt<W;++bt){var Nt=H[bt];Gt=="L"&&Nt=="1"?H[bt]="L":d.test(Nt)&&(Gt=Nt)}for(var wt=0;wt<W;++wt)if(u.test(H[wt])){var xt=void 0;for(xt=wt+1;xt<W&&u.test(H[xt]);++xt);for(var dt=(wt?H[wt-1]:O)=="L",qt=(xt<W?H[xt]:O)=="L",ar=dt==qt?dt?"L":"R":O,ci=wt;ci<xt;++ci)H[ci]=ar;wt=xt-1}for(var Rt=[],Pn,Lt=0;Lt<W;)if(m.test(H[Lt])){var Wa=Lt;for(++Lt;Lt<W&&m.test(H[Lt]);++Lt);Rt.push(new x(0,Wa,Lt))}else{var jn=Lt,Ti=Rt.length,Li=M=="rtl"?1:0;for(++Lt;Lt<W&&H[Lt]!="L";++Lt);for(var Wt=jn;Wt<Lt;)if(y.test(H[Wt])){jn<Wt&&(Rt.splice(Ti,0,new x(1,jn,Wt)),Ti+=Li);var lr=Wt;for(++Wt;Wt<Lt&&y.test(H[Wt]);++Wt);Rt.splice(Ti,0,new x(2,lr,Wt)),Ti+=Li,jn=Wt}else++Wt;jn<Lt&&Rt.splice(Ti,0,new x(1,jn,Lt))}return M=="ltr"&&(Rt[0].level==1&&(Pn=w.match(/^\s+/))&&(Rt[0].from=Pn[0].length,Rt.unshift(new x(0,0,Pn[0].length))),V(Rt).level==1&&(Pn=w.match(/\s+$/))&&(V(Rt).to-=Pn[0].length,Rt.push(new x(0,W-Pn[0].length,W)))),M=="rtl"?Rt.reverse():Rt}}();function J(t,r){var l=t.order;return l==null&&(l=t.order=B(t.text,r)),l}var xe=[],ne=function(t,r,l){if(t.addEventListener)t.addEventListener(r,l,!1);else if(t.attachEvent)t.attachEvent("on"+r,l);else{var a=t._handlers||(t._handlers={});a[r]=(a[r]||xe).concat(l)}};function Xe(t,r){return t._handlers&&t._handlers[r]||xe}function Ue(t,r,l){if(t.removeEventListener)t.removeEventListener(r,l,!1);else if(t.detachEvent)t.detachEvent("on"+r,l);else{var a=t._handlers,u=a&&a[r];if(u){var d=Z(u,l);d>-1&&(a[r]=u.slice(0,d).concat(u.slice(d+1)))}}}function Me(t,r){var l=Xe(t,r);if(l.length)for(var a=Array.prototype.slice.call(arguments,2),u=0;u<l.length;++u)l[u].apply(null,a)}function ot(t,r,l){return typeof r=="string"&&(r={type:r,preventDefault:function(){this.defaultPrevented=!0}}),Me(t,l||r.type,t,r),sn(r)||r.codemirrorIgnore}function Yt(t){var r=t._handlers&&t._handlers.cursorActivity;if(r)for(var l=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),a=0;a<r.length;++a)Z(l,r[a])==-1&&l.push(r[a])}function tt(t,r){return Xe(t,r).length>0}function rn(t){t.prototype.on=function(r,l){ne(this,r,l)},t.prototype.off=function(r,l){Ue(this,r,l)}}function At(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function Wi(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function sn(t){return t.defaultPrevented!=null?t.defaultPrevented:t.returnValue==!1}function mi(t){At(t),Wi(t)}function Qn(t){return t.target||t.srcElement}function Ds(t){var r=t.which;return r==null&&(t.button&1?r=1:t.button&2?r=3:t.button&4&&(r=2)),X&&t.ctrlKey&&r==1&&(r=3),r}var br=function(){if(p&&g<9)return!1;var t=F("div");return"draggable"in t||"dragDrop"in t}(),jt;function Ps(t){if(jt==null){var r=F("span","â€‹");R(t,F("span",[r,document.createTextNode("x")])),t.firstChild.offsetHeight!=0&&(jt=r.offsetWidth<=1&&r.offsetHeight>2&&!(p&&g<8))}var l=jt?F("span","â€‹"):F("span","Â ",null,"display: inline-block; width: 1px; margin-right: -1px");return l.setAttribute("cm-text",""),l}var xr;function Cn(t){if(xr!=null)return xr;var r=R(t,document.createTextNode("AØ®A")),l=ge(r,0,1).getBoundingClientRect(),a=ge(r,1,2).getBoundingClientRect();return se(t),!l||l.left==l.right?!1:xr=a.right-l.right<3}var _r=`

b`.split(/\n/).length!=3?function(t){for(var r=0,l=[],a=t.length;r<=a;){var u=t.indexOf(`
`,r);u==-1&&(u=t.length);var d=t.slice(r,t.charAt(u-1)=="\r"?u-1:u),m=d.indexOf("\r");m!=-1?(l.push(d.slice(0,m)),r+=m+1):(l.push(d),r=u+1)}return l}:function(t){return t.split(/\r\n?|\n/)},Os=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch{return!1}}:function(t){var r;try{r=t.ownerDocument.selection.createRange()}catch{}return!r||r.parentElement()!=t?!1:r.compareEndPoints("StartToEnd",r)!=0},As=function(){var t=F("div");return"oncopy"in t?!0:(t.setAttribute("oncopy","return;"),typeof t.oncopy=="function")}(),wr=null;function ei(t){if(wr!=null)return wr;var r=R(t,F("span","x")),l=r.getBoundingClientRect(),a=ge(r,0,1).getBoundingClientRect();return wr=Math.abs(l.left-a.left)>1}var fn={},on={};function Is(t,r){arguments.length>2&&(r.dependencies=Array.prototype.slice.call(arguments,2)),fn[t]=r}function Hn(t,r){on[t]=r}function Bi(t){if(typeof t=="string"&&on.hasOwnProperty(t))t=on[t];else if(t&&typeof t.name=="string"&&on.hasOwnProperty(t.name)){var r=on[t.name];typeof r=="string"&&(r={name:r}),t=Ge(r,t),t.name=r.name}else{if(typeof t=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return Bi("application/xml");if(typeof t=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return Bi("application/json")}return typeof t=="string"?{name:t}:t||{name:"null"}}function Ui(t,r){r=Bi(r);var l=fn[r.name];if(!l)return Ui(t,"text/plain");var a=l(t,r);if(yn.hasOwnProperty(r.name)){var u=yn[r.name];for(var d in u)u.hasOwnProperty(d)&&(a.hasOwnProperty(d)&&(a["_"+d]=a[d]),a[d]=u[d])}if(a.name=r.name,r.helperType&&(a.helperType=r.helperType),r.modeProps)for(var m in r.modeProps)a[m]=r.modeProps[m];return a}var yn={};function bn(t,r){var l=yn.hasOwnProperty(t)?yn[t]:yn[t]={};Ne(r,l)}function an(t,r){if(r===!0)return r;if(t.copyState)return t.copyState(r);var l={};for(var a in r){var u=r[a];u instanceof Array&&(u=u.concat([])),l[a]=u}return l}function kr(t,r){for(var l;t.innerMode&&(l=t.innerMode(r),!(!l||l.mode==t));)r=l.state,t=l.mode;return l||{mode:t,state:r}}function Sr(t,r,l){return t.startState?t.startState(r,l):!0}var ht=function(t,r,l){this.pos=this.start=0,this.string=t,this.tabSize=r||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=l};ht.prototype.eol=function(){return this.pos>=this.string.length},ht.prototype.sol=function(){return this.pos==this.lineStart},ht.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},ht.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},ht.prototype.eat=function(t){var r=this.string.charAt(this.pos),l;if(typeof t=="string"?l=r==t:l=r&&(t.test?t.test(r):t(r)),l)return++this.pos,r},ht.prototype.eatWhile=function(t){for(var r=this.pos;this.eat(t););return this.pos>r},ht.prototype.eatSpace=function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},ht.prototype.skipToEnd=function(){this.pos=this.string.length},ht.prototype.skipTo=function(t){var r=this.string.indexOf(t,this.pos);if(r>-1)return this.pos=r,!0},ht.prototype.backUp=function(t){this.pos-=t},ht.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Oe(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Oe(this.string,this.lineStart,this.tabSize):0)},ht.prototype.indentation=function(){return Oe(this.string,null,this.tabSize)-(this.lineStart?Oe(this.string,this.lineStart,this.tabSize):0)},ht.prototype.match=function(t,r,l){if(typeof t=="string"){var a=function(m){return l?m.toLowerCase():m},u=this.string.substr(this.pos,t.length);if(a(u)==a(t))return r!==!1&&(this.pos+=t.length),!0}else{var d=this.string.slice(this.pos).match(t);return d&&d.index>0?null:(d&&r!==!1&&(this.pos+=d[0].length),d)}},ht.prototype.current=function(){return this.string.slice(this.start,this.pos)},ht.prototype.hideFirstChars=function(t,r){this.lineStart+=t;try{return r()}finally{this.lineStart-=t}},ht.prototype.lookAhead=function(t){var r=this.lineOracle;return r&&r.lookAhead(t)},ht.prototype.baseToken=function(){var t=this.lineOracle;return t&&t.baseToken(this.pos)};function Ce(t,r){if(r-=t.first,r<0||r>=t.size)throw new Error("There is no line "+(r+t.first)+" in the document.");for(var l=t;!l.lines;)for(var a=0;;++a){var u=l.children[a],d=u.chunkSize();if(r<d){l=u;break}r-=d}return l.lines[r]}function Tn(t,r,l){var a=[],u=r.line;return t.iter(r.line,l.line+1,function(d){var m=d.text;u==l.line&&(m=m.slice(0,l.ch)),u==r.line&&(m=m.slice(r.ch)),a.push(m),++u}),a}function Cr(t,r,l){var a=[];return t.iter(r,l,function(u){a.push(u.text)}),a}function Zt(t,r){var l=r-t.height;if(l)for(var a=t;a;a=a.parent)a.height+=l}function Je(t){if(t.parent==null)return null;for(var r=t.parent,l=Z(r.lines,t),a=r.parent;a;r=a,a=a.parent)for(var u=0;a.children[u]!=r;++u)l+=a.children[u].chunkSize();return l+r.first}function Ln(t,r){var l=t.first;e:do{for(var a=0;a<t.children.length;++a){var u=t.children[a],d=u.height;if(r<d){t=u;continue e}r-=d,l+=u.chunkSize()}return l}while(!t.lines);for(var m=0;m<t.lines.length;++m){var y=t.lines[m],x=y.height;if(r<x)break;r-=x}return l+m}function vi(t,r){return r>=t.first&&r<t.first+t.size}function Tr(t,r){return String(t.lineNumberFormatter(r+t.firstLineNumber))}function le(t,r,l){if(l===void 0&&(l=null),!(this instanceof le))return new le(t,r,l);this.line=t,this.ch=r,this.sticky=l}function k(t,r){return t.line-r.line||t.ch-r.ch}function A(t,r){return t.sticky==r.sticky&&k(t,r)==0}function ee(t){return le(t.line,t.ch)}function ce(t,r){return k(t,r)<0?r:t}function Re(t,r){return k(t,r)<0?t:r}function qe(t,r){return Math.max(t.first,Math.min(r,t.first+t.size-1))}function ye(t,r){if(r.line<t.first)return le(t.first,0);var l=t.first+t.size-1;return r.line>l?le(l,Ce(t,l).text.length):It(r,Ce(t,r.line).text.length)}function It(t,r){var l=t.ch;return l==null||l>r?le(t.line,r):l<0?le(t.line,0):t}function ln(t,r){for(var l=[],a=0;a<r.length;a++)l[a]=ye(t,r[a]);return l}var $i=function(t,r){this.state=t,this.lookAhead=r},Nn=function(t,r,l,a){this.state=r,this.doc=t,this.line=l,this.maxLookAhead=a||0,this.baseTokens=null,this.baseTokenPos=1};Nn.prototype.lookAhead=function(t){var r=this.doc.getLine(this.line+t);return r!=null&&t>this.maxLookAhead&&(this.maxLookAhead=t),r},Nn.prototype.baseToken=function(t){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=t;)this.baseTokenPos+=2;var r=this.baseTokens[this.baseTokenPos+1];return{type:r&&r.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-t}},Nn.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},Nn.fromSaved=function(t,r,l){return r instanceof $i?new Nn(t,an(t.mode,r.state),l,r.lookAhead):new Nn(t,an(t.mode,r),l)},Nn.prototype.save=function(t){var r=t!==!1?an(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new $i(r,this.maxLookAhead):r};function Ul(t,r,l,a){var u=[t.state.modeGen],d={};Gl(t,r.text,t.doc.mode,l,function(w,M){return u.push(w,M)},d,a);for(var m=l.state,y=function(w){l.baseTokens=u;var M=t.state.overlays[w],O=1,W=0;l.state=!0,Gl(t,r.text,M.mode,l,function(H,q){for(var re=O;W<H;){var ue=u[O];ue>H&&u.splice(O,1,H,u[O+1],ue),O+=2,W=Math.min(H,ue)}if(q)if(M.opaque)u.splice(re,O-re,H,"overlay "+q),O=re+2;else for(;re<O;re+=2){var de=u[re+1];u[re+1]=(de?de+" ":"")+"overlay "+q}},d),l.state=m,l.baseTokens=null,l.baseTokenPos=1},x=0;x<t.state.overlays.length;++x)y(x);return{styles:u,classes:d.bgClass||d.textClass?d:null}}function $l(t,r,l){if(!r.styles||r.styles[0]!=t.state.modeGen){var a=Lr(t,Je(r)),u=r.text.length>t.options.maxHighlightLength&&an(t.doc.mode,a.state),d=Ul(t,r,a);u&&(a.state=u),r.stateAfter=a.save(!u),r.styles=d.styles,d.classes?r.styleClasses=d.classes:r.styleClasses&&(r.styleClasses=null),l===t.doc.highlightFrontier&&(t.doc.modeFrontier=Math.max(t.doc.modeFrontier,++t.doc.highlightFrontier))}return r.styles}function Lr(t,r,l){var a=t.doc,u=t.display;if(!a.mode.startState)return new Nn(a,!0,r);var d=jd(t,r,l),m=d>a.first&&Ce(a,d-1).stateAfter,y=m?Nn.fromSaved(a,m,d):new Nn(a,Sr(a.mode),d);return a.iter(d,r,function(x){Yo(t,x.text,y);var w=y.line;x.stateAfter=w==r-1||w%5==0||w>=u.viewFrom&&w<u.viewTo?y.save():null,y.nextLine()}),l&&(a.modeFrontier=y.line),y}function Yo(t,r,l,a){var u=t.doc.mode,d=new ht(r,t.options.tabSize,l);for(d.start=d.pos=a||0,r==""&&jl(u,l.state);!d.eol();)Zo(u,d,l.state),d.start=d.pos}function jl(t,r){if(t.blankLine)return t.blankLine(r);if(t.innerMode){var l=kr(t,r);if(l.mode.blankLine)return l.mode.blankLine(l.state)}}function Zo(t,r,l,a){for(var u=0;u<10;u++){a&&(a[0]=kr(t,l).mode);var d=t.token(r,l);if(r.pos>r.start)return d}throw new Error("Mode "+t.name+" failed to advance stream.")}var Vl=function(t,r,l){this.start=t.start,this.end=t.pos,this.string=t.current(),this.type=r||null,this.state=l};function Kl(t,r,l,a){var u=t.doc,d=u.mode,m;r=ye(u,r);var y=Ce(u,r.line),x=Lr(t,r.line,l),w=new ht(y.text,t.options.tabSize,x),M;for(a&&(M=[]);(a||w.pos<r.ch)&&!w.eol();)w.start=w.pos,m=Zo(d,w,x.state),a&&M.push(new Vl(w,m,an(u.mode,x.state)));return a?M:new Vl(w,m,x.state)}function Xl(t,r){if(t)for(;;){var l=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!l)break;t=t.slice(0,l.index)+t.slice(l.index+l[0].length);var a=l[1]?"bgClass":"textClass";r[a]==null?r[a]=l[2]:new RegExp("(?:^|\\s)"+l[2]+"(?:$|\\s)").test(r[a])||(r[a]+=" "+l[2])}return t}function Gl(t,r,l,a,u,d,m){var y=l.flattenSpans;y==null&&(y=t.options.flattenSpans);var x=0,w=null,M=new ht(r,t.options.tabSize,a),O,W=t.options.addModeClass&&[null];for(r==""&&Xl(jl(l,a.state),d);!M.eol();){if(M.pos>t.options.maxHighlightLength?(y=!1,m&&Yo(t,r,a,M.pos),M.pos=r.length,O=null):O=Xl(Zo(l,M,a.state,W),d),W){var H=W[0].name;H&&(O="m-"+(O?H+" "+O:H))}if(!y||w!=O){for(;x<M.start;)x=Math.min(M.start,x+5e3),u(x,w);w=O}M.start=M.pos}for(;x<M.pos;){var q=Math.min(M.pos,x+5e3);u(q,w),x=q}}function jd(t,r,l){for(var a,u,d=t.doc,m=l?-1:r-(t.doc.mode.innerMode?1e3:100),y=r;y>m;--y){if(y<=d.first)return d.first;var x=Ce(d,y-1),w=x.stateAfter;if(w&&(!l||y+(w instanceof $i?w.lookAhead:0)<=d.modeFrontier))return y;var M=Oe(x.text,null,t.options.tabSize);(u==null||a>M)&&(u=y-1,a=M)}return u}function Vd(t,r){if(t.modeFrontier=Math.min(t.modeFrontier,r),!(t.highlightFrontier<r-10)){for(var l=t.first,a=r-1;a>l;a--){var u=Ce(t,a).stateAfter;if(u&&(!(u instanceof $i)||a+u.lookAhead<r)){l=a+1;break}}t.highlightFrontier=Math.min(t.highlightFrontier,l)}}var ql=!1,zn=!1;function Kd(){ql=!0}function Xd(){zn=!0}function Es(t,r,l){this.marker=t,this.from=r,this.to=l}function Nr(t,r){if(t)for(var l=0;l<t.length;++l){var a=t[l];if(a.marker==r)return a}}function Gd(t,r){for(var l,a=0;a<t.length;++a)t[a]!=r&&(l||(l=[])).push(t[a]);return l}function qd(t,r,l){var a=l&&window.WeakSet&&(l.markedSpans||(l.markedSpans=new WeakSet));a&&a.has(t.markedSpans)?t.markedSpans.push(r):(t.markedSpans=t.markedSpans?t.markedSpans.concat([r]):[r],a&&a.add(t.markedSpans)),r.marker.attachLine(t)}function Yd(t,r,l){var a;if(t)for(var u=0;u<t.length;++u){var d=t[u],m=d.marker,y=d.from==null||(m.inclusiveLeft?d.from<=r:d.from<r);if(y||d.from==r&&m.type=="bookmark"&&(!l||!d.marker.insertLeft)){var x=d.to==null||(m.inclusiveRight?d.to>=r:d.to>r);(a||(a=[])).push(new Es(m,d.from,x?null:d.to))}}return a}function Zd(t,r,l){var a;if(t)for(var u=0;u<t.length;++u){var d=t[u],m=d.marker,y=d.to==null||(m.inclusiveRight?d.to>=r:d.to>r);if(y||d.from==r&&m.type=="bookmark"&&(!l||d.marker.insertLeft)){var x=d.from==null||(m.inclusiveLeft?d.from<=r:d.from<r);(a||(a=[])).push(new Es(m,x?null:d.from-r,d.to==null?null:d.to-r))}}return a}function Jo(t,r){if(r.full)return null;var l=vi(t,r.from.line)&&Ce(t,r.from.line).markedSpans,a=vi(t,r.to.line)&&Ce(t,r.to.line).markedSpans;if(!l&&!a)return null;var u=r.from.ch,d=r.to.ch,m=k(r.from,r.to)==0,y=Yd(l,u,m),x=Zd(a,d,m),w=r.text.length==1,M=V(r.text).length+(w?u:0);if(y)for(var O=0;O<y.length;++O){var W=y[O];if(W.to==null){var H=Nr(x,W.marker);H?w&&(W.to=H.to==null?null:H.to+M):W.to=u}}if(x)for(var q=0;q<x.length;++q){var re=x[q];if(re.to!=null&&(re.to+=M),re.from==null){var ue=Nr(y,re.marker);ue||(re.from=M,w&&(y||(y=[])).push(re))}else re.from+=M,w&&(y||(y=[])).push(re)}y&&(y=Yl(y)),x&&x!=y&&(x=Yl(x));var de=[y];if(!w){var ve=r.text.length-2,pe;if(ve>0&&y)for(var we=0;we<y.length;++we)y[we].to==null&&(pe||(pe=[])).push(new Es(y[we].marker,null,null));for(var Pe=0;Pe<ve;++Pe)de.push(pe);de.push(x)}return de}function Yl(t){for(var r=0;r<t.length;++r){var l=t[r];l.from!=null&&l.from==l.to&&l.marker.clearWhenEmpty!==!1&&t.splice(r--,1)}return t.length?t:null}function Jd(t,r,l){var a=null;if(t.iter(r.line,l.line+1,function(H){if(H.markedSpans)for(var q=0;q<H.markedSpans.length;++q){var re=H.markedSpans[q].marker;re.readOnly&&(!a||Z(a,re)==-1)&&(a||(a=[])).push(re)}}),!a)return null;for(var u=[{from:r,to:l}],d=0;d<a.length;++d)for(var m=a[d],y=m.find(0),x=0;x<u.length;++x){var w=u[x];if(!(k(w.to,y.from)<0||k(w.from,y.to)>0)){var M=[x,1],O=k(w.from,y.from),W=k(w.to,y.to);(O<0||!m.inclusiveLeft&&!O)&&M.push({from:w.from,to:y.from}),(W>0||!m.inclusiveRight&&!W)&&M.push({from:y.to,to:w.to}),u.splice.apply(u,M),x+=M.length-3}}return u}function Zl(t){var r=t.markedSpans;if(r){for(var l=0;l<r.length;++l)r[l].marker.detachLine(t);t.markedSpans=null}}function Jl(t,r){if(r){for(var l=0;l<r.length;++l)r[l].marker.attachLine(t);t.markedSpans=r}}function Rs(t){return t.inclusiveLeft?-1:0}function Fs(t){return t.inclusiveRight?1:0}function Qo(t,r){var l=t.lines.length-r.lines.length;if(l!=0)return l;var a=t.find(),u=r.find(),d=k(a.from,u.from)||Rs(t)-Rs(r);if(d)return-d;var m=k(a.to,u.to)||Fs(t)-Fs(r);return m||r.id-t.id}function Ql(t,r){var l=zn&&t.markedSpans,a;if(l)for(var u=void 0,d=0;d<l.length;++d)u=l[d],u.marker.collapsed&&(r?u.from:u.to)==null&&(!a||Qo(a,u.marker)<0)&&(a=u.marker);return a}function ec(t){return Ql(t,!0)}function Hs(t){return Ql(t,!1)}function Qd(t,r){var l=zn&&t.markedSpans,a;if(l)for(var u=0;u<l.length;++u){var d=l[u];d.marker.collapsed&&(d.from==null||d.from<r)&&(d.to==null||d.to>r)&&(!a||Qo(a,d.marker)<0)&&(a=d.marker)}return a}function tc(t,r,l,a,u){var d=Ce(t,r),m=zn&&d.markedSpans;if(m)for(var y=0;y<m.length;++y){var x=m[y];if(x.marker.collapsed){var w=x.marker.find(0),M=k(w.from,l)||Rs(x.marker)-Rs(u),O=k(w.to,a)||Fs(x.marker)-Fs(u);if(!(M>=0&&O<=0||M<=0&&O>=0)&&(M<=0&&(x.marker.inclusiveRight&&u.inclusiveLeft?k(w.to,l)>=0:k(w.to,l)>0)||M>=0&&(x.marker.inclusiveRight&&u.inclusiveLeft?k(w.from,a)<=0:k(w.from,a)<0)))return!0}}}function xn(t){for(var r;r=ec(t);)t=r.find(-1,!0).line;return t}function ep(t){for(var r;r=Hs(t);)t=r.find(1,!0).line;return t}function tp(t){for(var r,l;r=Hs(t);)t=r.find(1,!0).line,(l||(l=[])).push(t);return l}function ea(t,r){var l=Ce(t,r),a=xn(l);return l==a?r:Je(a)}function nc(t,r){if(r>t.lastLine())return r;var l=Ce(t,r),a;if(!ti(t,l))return r;for(;a=Hs(l);)l=a.find(1,!0).line;return Je(l)+1}function ti(t,r){var l=zn&&r.markedSpans;if(l){for(var a=void 0,u=0;u<l.length;++u)if(a=l[u],!!a.marker.collapsed){if(a.from==null)return!0;if(!a.marker.widgetNode&&a.from==0&&a.marker.inclusiveLeft&&ta(t,r,a))return!0}}}function ta(t,r,l){if(l.to==null){var a=l.marker.find(1,!0);return ta(t,a.line,Nr(a.line.markedSpans,l.marker))}if(l.marker.inclusiveRight&&l.to==r.text.length)return!0;for(var u=void 0,d=0;d<r.markedSpans.length;++d)if(u=r.markedSpans[d],u.marker.collapsed&&!u.marker.widgetNode&&u.from==l.to&&(u.to==null||u.to!=l.from)&&(u.marker.inclusiveLeft||l.marker.inclusiveRight)&&ta(t,r,u))return!0}function Wn(t){t=xn(t);for(var r=0,l=t.parent,a=0;a<l.lines.length;++a){var u=l.lines[a];if(u==t)break;r+=u.height}for(var d=l.parent;d;l=d,d=l.parent)for(var m=0;m<d.children.length;++m){var y=d.children[m];if(y==l)break;r+=y.height}return r}function zs(t){if(t.height==0)return 0;for(var r=t.text.length,l,a=t;l=ec(a);){var u=l.find(0,!0);a=u.from.line,r+=u.from.ch-u.to.ch}for(a=t;l=Hs(a);){var d=l.find(0,!0);r-=a.text.length-d.from.ch,a=d.to.line,r+=a.text.length-d.to.ch}return r}function na(t){var r=t.display,l=t.doc;r.maxLine=Ce(l,l.first),r.maxLineLength=zs(r.maxLine),r.maxLineChanged=!0,l.iter(function(a){var u=zs(a);u>r.maxLineLength&&(r.maxLineLength=u,r.maxLine=a)})}var ji=function(t,r,l){this.text=t,Jl(this,r),this.height=l?l(this):1};ji.prototype.lineNo=function(){return Je(this)},rn(ji);function np(t,r,l,a){t.text=r,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),t.order!=null&&(t.order=null),Zl(t),Jl(t,l);var u=a?a(t):1;u!=t.height&&Zt(t,u)}function ip(t){t.parent=null,Zl(t)}var rp={},sp={};function ic(t,r){if(!t||/^\s*$/.test(t))return null;var l=r.addModeClass?sp:rp;return l[t]||(l[t]=t.replace(/\S+/g,"cm-$&"))}function rc(t,r){var l=S("span",null,null,b?"padding-right: .1px":null),a={pre:S("pre",[l],"CodeMirror-line"),content:l,col:0,pos:0,cm:t,trailingSpace:!1,splitSpaces:t.getOption("lineWrapping")};r.measure={};for(var u=0;u<=(r.rest?r.rest.length:0);u++){var d=u?r.rest[u-1]:r.line,m=void 0;a.pos=0,a.addToken=ap,Cn(t.display.measure)&&(m=J(d,t.doc.direction))&&(a.addToken=cp(a.addToken,m)),a.map=[];var y=r!=t.display.externalMeasured&&Je(d);up(d,a,$l(t,d,y)),d.styleClasses&&(d.styleClasses.bgClass&&(a.bgClass=Ke(d.styleClasses.bgClass,a.bgClass||"")),d.styleClasses.textClass&&(a.textClass=Ke(d.styleClasses.textClass,a.textClass||""))),a.map.length==0&&a.map.push(0,0,a.content.appendChild(Ps(t.display.measure))),u==0?(r.measure.map=a.map,r.measure.cache={}):((r.measure.maps||(r.measure.maps=[])).push(a.map),(r.measure.caches||(r.measure.caches=[])).push({}))}if(b){var x=a.content.lastChild;(/\bcm-tab\b/.test(x.className)||x.querySelector&&x.querySelector(".cm-tab"))&&(a.content.className="cm-tab-wrap-hack")}return Me(t,"renderLine",t,r.line,a.pre),a.pre.className&&(a.textClass=Ke(a.pre.className,a.textClass||"")),a}function op(t){var r=F("span","â€¢","cm-invalidchar");return r.title="\\u"+t.charCodeAt(0).toString(16),r.setAttribute("aria-label",r.title),r}function ap(t,r,l,a,u,d,m){if(r){var y=t.splitSpaces?lp(r,t.trailingSpace):r,x=t.cm.state.specialChars,w=!1,M;if(!x.test(r))t.col+=r.length,M=document.createTextNode(y),t.map.push(t.pos,t.pos+r.length,M),p&&g<9&&(w=!0),t.pos+=r.length;else{M=document.createDocumentFragment();for(var O=0;;){x.lastIndex=O;var W=x.exec(r),H=W?W.index-O:r.length-O;if(H){var q=document.createTextNode(y.slice(O,O+H));p&&g<9?M.appendChild(F("span",[q])):M.appendChild(q),t.map.push(t.pos,t.pos+H,q),t.col+=H,t.pos+=H}if(!W)break;O+=H+1;var re=void 0;if(W[0]=="	"){var ue=t.cm.options.tabSize,de=ue-t.col%ue;re=M.appendChild(F("span",$t(de),"cm-tab")),re.setAttribute("role","presentation"),re.setAttribute("cm-text","	"),t.col+=de}else W[0]=="\r"||W[0]==`
`?(re=M.appendChild(F("span",W[0]=="\r"?"â":"â¤","cm-invalidchar")),re.setAttribute("cm-text",W[0]),t.col+=1):(re=t.cm.options.specialCharPlaceholder(W[0]),re.setAttribute("cm-text",W[0]),p&&g<9?M.appendChild(F("span",[re])):M.appendChild(re),t.col+=1);t.map.push(t.pos,t.pos+1,re),t.pos++}}if(t.trailingSpace=y.charCodeAt(r.length-1)==32,l||a||u||w||d||m){var ve=l||"";a&&(ve+=a),u&&(ve+=u);var pe=F("span",[M],ve,d);if(m)for(var we in m)m.hasOwnProperty(we)&&we!="style"&&we!="class"&&pe.setAttribute(we,m[we]);return t.content.appendChild(pe)}t.content.appendChild(M)}}function lp(t,r){if(t.length>1&&!/  /.test(t))return t;for(var l=r,a="",u=0;u<t.length;u++){var d=t.charAt(u);d==" "&&l&&(u==t.length-1||t.charCodeAt(u+1)==32)&&(d="Â "),a+=d,l=d==" "}return a}function cp(t,r){return function(l,a,u,d,m,y,x){u=u?u+" cm-force-border":"cm-force-border";for(var w=l.pos,M=w+a.length;;){for(var O=void 0,W=0;W<r.length&&(O=r[W],!(O.to>w&&O.from<=w));W++);if(O.to>=M)return t(l,a,u,d,m,y,x);t(l,a.slice(0,O.to-w),u,d,null,y,x),d=null,a=a.slice(O.to-w),w=O.to}}}function sc(t,r,l,a){var u=!a&&l.widgetNode;u&&t.map.push(t.pos,t.pos+r,u),!a&&t.cm.display.input.needsContentAttribute&&(u||(u=t.content.appendChild(document.createElement("span"))),u.setAttribute("cm-marker",l.id)),u&&(t.cm.display.input.setUneditable(u),t.content.appendChild(u)),t.pos+=r,t.trailingSpace=!1}function up(t,r,l){var a=t.markedSpans,u=t.text,d=0;if(!a){for(var m=1;m<l.length;m+=2)r.addToken(r,u.slice(d,d=l[m]),ic(l[m+1],r.cm.options));return}for(var y=u.length,x=0,w=1,M="",O,W,H=0,q,re,ue,de,ve;;){if(H==x){q=re=ue=W="",ve=null,de=null,H=1/0;for(var pe=[],we=void 0,Pe=0;Pe<a.length;++Pe){var De=a[Pe],Be=De.marker;if(Be.type=="bookmark"&&De.from==x&&Be.widgetNode)pe.push(Be);else if(De.from<=x&&(De.to==null||De.to>x||Be.collapsed&&De.to==x&&De.from==x)){if(De.to!=null&&De.to!=x&&H>De.to&&(H=De.to,re=""),Be.className&&(q+=" "+Be.className),Be.css&&(W=(W?W+";":"")+Be.css),Be.startStyle&&De.from==x&&(ue+=" "+Be.startStyle),Be.endStyle&&De.to==H&&(we||(we=[])).push(Be.endStyle,De.to),Be.title&&((ve||(ve={})).title=Be.title),Be.attributes)for(var st in Be.attributes)(ve||(ve={}))[st]=Be.attributes[st];Be.collapsed&&(!de||Qo(de.marker,Be)<0)&&(de=De)}else De.from>x&&H>De.from&&(H=De.from)}if(we)for(var Tt=0;Tt<we.length;Tt+=2)we[Tt+1]==H&&(re+=" "+we[Tt]);if(!de||de.from==x)for(var ft=0;ft<pe.length;++ft)sc(r,0,pe[ft]);if(de&&(de.from||0)==x){if(sc(r,(de.to==null?y+1:de.to)-x,de.marker,de.from==null),de.to==null)return;de.to==x&&(de=!1)}}if(x>=y)break;for(var Qt=Math.min(y,H);;){if(M){var Xt=x+M.length;if(!de){var bt=Xt>Qt?M.slice(0,Qt-x):M;r.addToken(r,bt,O?O+q:q,ue,x+bt.length==H?re:"",W,ve)}if(Xt>=Qt){M=M.slice(Qt-x),x=Qt;break}x=Xt,ue=""}M=u.slice(d,d=l[w++]),O=ic(l[w++],r.cm.options)}}}function oc(t,r,l){this.line=r,this.rest=tp(r),this.size=this.rest?Je(V(this.rest))-l+1:1,this.node=this.text=null,this.hidden=ti(t,r)}function Ws(t,r,l){for(var a=[],u,d=r;d<l;d=u){var m=new oc(t.doc,Ce(t.doc,d),d);u=d+m.size,a.push(m)}return a}var Vi=null;function fp(t){Vi?Vi.ops.push(t):t.ownsGroup=Vi={ops:[t],delayedCallbacks:[]}}function hp(t){var r=t.delayedCallbacks,l=0;do{for(;l<r.length;l++)r[l].call(null);for(var a=0;a<t.ops.length;a++){var u=t.ops[a];if(u.cursorActivityHandlers)for(;u.cursorActivityCalled<u.cursorActivityHandlers.length;)u.cursorActivityHandlers[u.cursorActivityCalled++].call(null,u.cm)}}while(l<r.length)}function dp(t,r){var l=t.ownsGroup;if(l)try{hp(l)}finally{Vi=null,r(l)}}var Mr=null;function kt(t,r){var l=Xe(t,r);if(l.length){var a=Array.prototype.slice.call(arguments,2),u;Vi?u=Vi.delayedCallbacks:Mr?u=Mr:(u=Mr=[],setTimeout(pp,0));for(var d=function(y){u.push(function(){return l[y].apply(null,a)})},m=0;m<l.length;++m)d(m)}}function pp(){var t=Mr;Mr=null;for(var r=0;r<t.length;++r)t[r]()}function ac(t,r,l,a){for(var u=0;u<r.changes.length;u++){var d=r.changes[u];d=="text"?mp(t,r):d=="gutter"?cc(t,r,l,a):d=="class"?ia(t,r):d=="widget"&&vp(t,r,a)}r.changes=null}function Dr(t){return t.node==t.text&&(t.node=F("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),p&&g<8&&(t.node.style.zIndex=2)),t.node}function gp(t,r){var l=r.bgClass?r.bgClass+" "+(r.line.bgClass||""):r.line.bgClass;if(l&&(l+=" CodeMirror-linebackground"),r.background)l?r.background.className=l:(r.background.parentNode.removeChild(r.background),r.background=null);else if(l){var a=Dr(r);r.background=a.insertBefore(F("div",null,l),a.firstChild),t.display.input.setUneditable(r.background)}}function lc(t,r){var l=t.display.externalMeasured;return l&&l.line==r.line?(t.display.externalMeasured=null,r.measure=l.measure,l.built):rc(t,r)}function mp(t,r){var l=r.text.className,a=lc(t,r);r.text==r.node&&(r.node=a.pre),r.text.parentNode.replaceChild(a.pre,r.text),r.text=a.pre,a.bgClass!=r.bgClass||a.textClass!=r.textClass?(r.bgClass=a.bgClass,r.textClass=a.textClass,ia(t,r)):l&&(r.text.className=l)}function ia(t,r){gp(t,r),r.line.wrapClass?Dr(r).className=r.line.wrapClass:r.node!=r.text&&(r.node.className="");var l=r.textClass?r.textClass+" "+(r.line.textClass||""):r.line.textClass;r.text.className=l||""}function cc(t,r,l,a){if(r.gutter&&(r.node.removeChild(r.gutter),r.gutter=null),r.gutterBackground&&(r.node.removeChild(r.gutterBackground),r.gutterBackground=null),r.line.gutterClass){var u=Dr(r);r.gutterBackground=F("div",null,"CodeMirror-gutter-background "+r.line.gutterClass,"left: "+(t.options.fixedGutter?a.fixedPos:-a.gutterTotalWidth)+"px; width: "+a.gutterTotalWidth+"px"),t.display.input.setUneditable(r.gutterBackground),u.insertBefore(r.gutterBackground,r.text)}var d=r.line.gutterMarkers;if(t.options.lineNumbers||d){var m=Dr(r),y=r.gutter=F("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?a.fixedPos:-a.gutterTotalWidth)+"px");if(y.setAttribute("aria-hidden","true"),t.display.input.setUneditable(y),m.insertBefore(y,r.text),r.line.gutterClass&&(y.className+=" "+r.line.gutterClass),t.options.lineNumbers&&(!d||!d["CodeMirror-linenumbers"])&&(r.lineNumber=y.appendChild(F("div",Tr(t.options,l),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+a.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),d)for(var x=0;x<t.display.gutterSpecs.length;++x){var w=t.display.gutterSpecs[x].className,M=d.hasOwnProperty(w)&&d[w];M&&y.appendChild(F("div",[M],"CodeMirror-gutter-elt","left: "+a.gutterLeft[w]+"px; width: "+a.gutterWidth[w]+"px"))}}}function vp(t,r,l){r.alignable&&(r.alignable=null);for(var a=fe("CodeMirror-linewidget"),u=r.node.firstChild,d=void 0;u;u=d)d=u.nextSibling,a.test(u.className)&&r.node.removeChild(u);uc(t,r,l)}function yp(t,r,l,a){var u=lc(t,r);return r.text=r.node=u.pre,u.bgClass&&(r.bgClass=u.bgClass),u.textClass&&(r.textClass=u.textClass),ia(t,r),cc(t,r,l,a),uc(t,r,a),r.node}function uc(t,r,l){if(fc(t,r.line,r,l,!0),r.rest)for(var a=0;a<r.rest.length;a++)fc(t,r.rest[a],r,l,!1)}function fc(t,r,l,a,u){if(r.widgets)for(var d=Dr(l),m=0,y=r.widgets;m<y.length;++m){var x=y[m],w=F("div",[x.node],"CodeMirror-linewidget"+(x.className?" "+x.className:""));x.handleMouseEvents||w.setAttribute("cm-ignore-events","true"),bp(x,w,l,a),t.display.input.setUneditable(w),u&&x.above?d.insertBefore(w,l.gutter||l.text):d.appendChild(w),kt(x,"redraw")}}function bp(t,r,l,a){if(t.noHScroll){(l.alignable||(l.alignable=[])).push(r);var u=a.wrapperWidth;r.style.left=a.fixedPos+"px",t.coverGutter||(u-=a.gutterTotalWidth,r.style.paddingLeft=a.gutterTotalWidth+"px"),r.style.width=u+"px"}t.coverGutter&&(r.style.zIndex=5,r.style.position="relative",t.noHScroll||(r.style.marginLeft=-a.gutterTotalWidth+"px"))}function Pr(t){if(t.height!=null)return t.height;var r=t.doc.cm;if(!r)return 0;if(!Le(document.body,t.node)){var l="position: relative;";t.coverGutter&&(l+="margin-left: -"+r.display.gutters.offsetWidth+"px;"),t.noHScroll&&(l+="width: "+r.display.wrapper.clientWidth+"px;"),R(r.display.measure,F("div",[t.node],null,l))}return t.height=t.node.parentNode.offsetHeight}function Bn(t,r){for(var l=Qn(r);l!=t.wrapper;l=l.parentNode)if(!l||l.nodeType==1&&l.getAttribute("cm-ignore-events")=="true"||l.parentNode==t.sizer&&l!=t.mover)return!0}function Bs(t){return t.lineSpace.offsetTop}function ra(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function hc(t){if(t.cachedPaddingH)return t.cachedPaddingH;var r=R(t.measure,F("pre","x","CodeMirror-line-like")),l=window.getComputedStyle?window.getComputedStyle(r):r.currentStyle,a={left:parseInt(l.paddingLeft),right:parseInt(l.paddingRight)};return!isNaN(a.left)&&!isNaN(a.right)&&(t.cachedPaddingH=a),a}function Mn(t){return ie-t.display.nativeBarWidth}function yi(t){return t.display.scroller.clientWidth-Mn(t)-t.display.barWidth}function sa(t){return t.display.scroller.clientHeight-Mn(t)-t.display.barHeight}function xp(t,r,l){var a=t.options.lineWrapping,u=a&&yi(t);if(!r.measure.heights||a&&r.measure.width!=u){var d=r.measure.heights=[];if(a){r.measure.width=u;for(var m=r.text.firstChild.getClientRects(),y=0;y<m.length-1;y++){var x=m[y],w=m[y+1];Math.abs(x.bottom-w.bottom)>2&&d.push((x.bottom+w.top)/2-l.top)}}d.push(l.bottom-l.top)}}function dc(t,r,l){if(t.line==r)return{map:t.measure.map,cache:t.measure.cache};if(t.rest){for(var a=0;a<t.rest.length;a++)if(t.rest[a]==r)return{map:t.measure.maps[a],cache:t.measure.caches[a]};for(var u=0;u<t.rest.length;u++)if(Je(t.rest[u])>l)return{map:t.measure.maps[u],cache:t.measure.caches[u],before:!0}}}function _p(t,r){r=xn(r);var l=Je(r),a=t.display.externalMeasured=new oc(t.doc,r,l);a.lineN=l;var u=a.built=rc(t,a);return a.text=u.pre,R(t.display.lineMeasure,u.pre),a}function pc(t,r,l,a){return Dn(t,Ki(t,r),l,a)}function oa(t,r){if(r>=t.display.viewFrom&&r<t.display.viewTo)return t.display.view[_i(t,r)];var l=t.display.externalMeasured;if(l&&r>=l.lineN&&r<l.lineN+l.size)return l}function Ki(t,r){var l=Je(r),a=oa(t,l);a&&!a.text?a=null:a&&a.changes&&(ac(t,a,l,fa(t)),t.curOp.forceUpdate=!0),a||(a=_p(t,r));var u=dc(a,r,l);return{line:r,view:a,rect:null,map:u.map,cache:u.cache,before:u.before,hasHeights:!1}}function Dn(t,r,l,a,u){r.before&&(l=-1);var d=l+(a||""),m;return r.cache.hasOwnProperty(d)?m=r.cache[d]:(r.rect||(r.rect=r.view.text.getBoundingClientRect()),r.hasHeights||(xp(t,r.view,r.rect),r.hasHeights=!0),m=kp(t,r,l,a),m.bogus||(r.cache[d]=m)),{left:m.left,right:m.right,top:u?m.rtop:m.top,bottom:u?m.rbottom:m.bottom}}var gc={left:0,right:0,top:0,bottom:0};function mc(t,r,l){for(var a,u,d,m,y,x,w=0;w<t.length;w+=3)if(y=t[w],x=t[w+1],r<y?(u=0,d=1,m="left"):r<x?(u=r-y,d=u+1):(w==t.length-3||r==x&&t[w+3]>r)&&(d=x-y,u=d-1,r>=x&&(m="right")),u!=null){if(a=t[w+2],y==x&&l==(a.insertLeft?"left":"right")&&(m=l),l=="left"&&u==0)for(;w&&t[w-2]==t[w-3]&&t[w-1].insertLeft;)a=t[(w-=3)+2],m="left";if(l=="right"&&u==x-y)for(;w<t.length-3&&t[w+3]==t[w+4]&&!t[w+5].insertLeft;)a=t[(w+=3)+2],m="right";break}return{node:a,start:u,end:d,collapse:m,coverStart:y,coverEnd:x}}function wp(t,r){var l=gc;if(r=="left")for(var a=0;a<t.length&&(l=t[a]).left==l.right;a++);else for(var u=t.length-1;u>=0&&(l=t[u]).left==l.right;u--);return l}function kp(t,r,l,a){var u=mc(r.map,l,a),d=u.node,m=u.start,y=u.end,x=u.collapse,w;if(d.nodeType==3){for(var M=0;M<4;M++){for(;m&&vn(r.line.text.charAt(u.coverStart+m));)--m;for(;u.coverStart+y<u.coverEnd&&vn(r.line.text.charAt(u.coverStart+y));)++y;if(p&&g<9&&m==0&&y==u.coverEnd-u.coverStart?w=d.parentNode.getBoundingClientRect():w=wp(ge(d,m,y).getClientRects(),a),w.left||w.right||m==0)break;y=m,m=m-1,x="right"}p&&g<11&&(w=Sp(t.display.measure,w))}else{m>0&&(x=a="right");var O;t.options.lineWrapping&&(O=d.getClientRects()).length>1?w=O[a=="right"?O.length-1:0]:w=d.getBoundingClientRect()}if(p&&g<9&&!m&&(!w||!w.left&&!w.right)){var W=d.parentNode.getClientRects()[0];W?w={left:W.left,right:W.left+Gi(t.display),top:W.top,bottom:W.bottom}:w=gc}for(var H=w.top-r.rect.top,q=w.bottom-r.rect.top,re=(H+q)/2,ue=r.view.measure.heights,de=0;de<ue.length-1&&!(re<ue[de]);de++);var ve=de?ue[de-1]:0,pe=ue[de],we={left:(x=="right"?w.right:w.left)-r.rect.left,right:(x=="left"?w.left:w.right)-r.rect.left,top:ve,bottom:pe};return!w.left&&!w.right&&(we.bogus=!0),t.options.singleCursorHeightPerLine||(we.rtop=H,we.rbottom=q),we}function Sp(t,r){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!ei(t))return r;var l=screen.logicalXDPI/screen.deviceXDPI,a=screen.logicalYDPI/screen.deviceYDPI;return{left:r.left*l,right:r.right*l,top:r.top*a,bottom:r.bottom*a}}function vc(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var r=0;r<t.rest.length;r++)t.measure.caches[r]={}}function yc(t){t.display.externalMeasure=null,se(t.display.lineMeasure);for(var r=0;r<t.display.view.length;r++)vc(t.display.view[r])}function Or(t){yc(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function bc(){return T&&I?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function xc(){return T&&I?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function aa(t){var r=xn(t),l=r.widgets,a=0;if(l)for(var u=0;u<l.length;++u)l[u].above&&(a+=Pr(l[u]));return a}function Us(t,r,l,a,u){if(!u){var d=aa(r);l.top+=d,l.bottom+=d}if(a=="line")return l;a||(a="local");var m=Wn(r);if(a=="local"?m+=Bs(t.display):m-=t.display.viewOffset,a=="page"||a=="window"){var y=t.display.lineSpace.getBoundingClientRect();m+=y.top+(a=="window"?0:xc());var x=y.left+(a=="window"?0:bc());l.left+=x,l.right+=x}return l.top+=m,l.bottom+=m,l}function _c(t,r,l){if(l=="div")return r;var a=r.left,u=r.top;if(l=="page")a-=bc(),u-=xc();else if(l=="local"||!l){var d=t.display.sizer.getBoundingClientRect();a+=d.left,u+=d.top}var m=t.display.lineSpace.getBoundingClientRect();return{left:a-m.left,top:u-m.top}}function $s(t,r,l,a,u){return a||(a=Ce(t.doc,r.line)),Us(t,a,pc(t,a,r.ch,u),l)}function _n(t,r,l,a,u,d){a=a||Ce(t.doc,r.line),u||(u=Ki(t,a));function m(q,re){var ue=Dn(t,u,q,re?"right":"left",d);return re?ue.left=ue.right:ue.right=ue.left,Us(t,a,ue,l)}var y=J(a,t.doc.direction),x=r.ch,w=r.sticky;if(x>=a.text.length?(x=a.text.length,w="before"):x<=0&&(x=0,w="after"),!y)return m(w=="before"?x-1:x,w=="before");function M(q,re,ue){var de=y[re],ve=de.level==1;return m(ue?q-1:q,ve!=ue)}var O=te(y,x,w),W=$,H=M(x,O,w=="before");return W!=null&&(H.other=M(x,W,w!="before")),H}function wc(t,r){var l=0;r=ye(t.doc,r),t.options.lineWrapping||(l=Gi(t.display)*r.ch);var a=Ce(t.doc,r.line),u=Wn(a)+Bs(t.display);return{left:l,right:l,top:u,bottom:u+a.height}}function la(t,r,l,a,u){var d=le(t,r,l);return d.xRel=u,a&&(d.outside=a),d}function ca(t,r,l){var a=t.doc;if(l+=t.display.viewOffset,l<0)return la(a.first,0,null,-1,-1);var u=Ln(a,l),d=a.first+a.size-1;if(u>d)return la(a.first+a.size-1,Ce(a,d).text.length,null,1,1);r<0&&(r=0);for(var m=Ce(a,u);;){var y=Cp(t,m,u,r,l),x=Qd(m,y.ch+(y.xRel>0||y.outside>0?1:0));if(!x)return y;var w=x.find(1);if(w.line==u)return w;m=Ce(a,u=w.line)}}function kc(t,r,l,a){a-=aa(r);var u=r.text.length,d=C(function(m){return Dn(t,l,m-1).bottom<=a},u,0);return u=C(function(m){return Dn(t,l,m).top>a},d,u),{begin:d,end:u}}function Sc(t,r,l,a){l||(l=Ki(t,r));var u=Us(t,r,Dn(t,l,a),"line").top;return kc(t,r,l,u)}function ua(t,r,l,a){return t.bottom<=l?!1:t.top>l?!0:(a?t.left:t.right)>r}function Cp(t,r,l,a,u){u-=Wn(r);var d=Ki(t,r),m=aa(r),y=0,x=r.text.length,w=!0,M=J(r,t.doc.direction);if(M){var O=(t.options.lineWrapping?Lp:Tp)(t,r,l,d,M,a,u);w=O.level!=1,y=w?O.from:O.to-1,x=w?O.to:O.from-1}var W=null,H=null,q=C(function(Pe){var De=Dn(t,d,Pe);return De.top+=m,De.bottom+=m,ua(De,a,u,!1)?(De.top<=u&&De.left<=a&&(W=Pe,H=De),!0):!1},y,x),re,ue,de=!1;if(H){var ve=a-H.left<H.right-a,pe=ve==w;q=W+(pe?0:1),ue=pe?"after":"before",re=ve?H.left:H.right}else{!w&&(q==x||q==y)&&q++,ue=q==0?"after":q==r.text.length?"before":Dn(t,d,q-(w?1:0)).bottom+m<=u==w?"after":"before";var we=_n(t,le(l,q,ue),"line",r,d);re=we.left,de=u<we.top?-1:u>=we.bottom?1:0}return q=un(r.text,q,1),la(l,q,ue,de,a-re)}function Tp(t,r,l,a,u,d,m){var y=C(function(O){var W=u[O],H=W.level!=1;return ua(_n(t,le(l,H?W.to:W.from,H?"before":"after"),"line",r,a),d,m,!0)},0,u.length-1),x=u[y];if(y>0){var w=x.level!=1,M=_n(t,le(l,w?x.from:x.to,w?"after":"before"),"line",r,a);ua(M,d,m,!0)&&M.top>m&&(x=u[y-1])}return x}function Lp(t,r,l,a,u,d,m){var y=kc(t,r,a,m),x=y.begin,w=y.end;/\s/.test(r.text.charAt(w-1))&&w--;for(var M=null,O=null,W=0;W<u.length;W++){var H=u[W];if(!(H.from>=w||H.to<=x)){var q=H.level!=1,re=Dn(t,a,q?Math.min(w,H.to)-1:Math.max(x,H.from)).right,ue=re<d?d-re+1e9:re-d;(!M||O>ue)&&(M=H,O=ue)}}return M||(M=u[u.length-1]),M.from<x&&(M={from:x,to:M.to,level:M.level}),M.to>w&&(M={from:M.from,to:w,level:M.level}),M}var bi;function Xi(t){if(t.cachedTextHeight!=null)return t.cachedTextHeight;if(bi==null){bi=F("pre",null,"CodeMirror-line-like");for(var r=0;r<49;++r)bi.appendChild(document.createTextNode("x")),bi.appendChild(F("br"));bi.appendChild(document.createTextNode("x"))}R(t.measure,bi);var l=bi.offsetHeight/50;return l>3&&(t.cachedTextHeight=l),se(t.measure),l||1}function Gi(t){if(t.cachedCharWidth!=null)return t.cachedCharWidth;var r=F("span","xxxxxxxxxx"),l=F("pre",[r],"CodeMirror-line-like");R(t.measure,l);var a=r.getBoundingClientRect(),u=(a.right-a.left)/10;return u>2&&(t.cachedCharWidth=u),u||10}function fa(t){for(var r=t.display,l={},a={},u=r.gutters.clientLeft,d=r.gutters.firstChild,m=0;d;d=d.nextSibling,++m){var y=t.display.gutterSpecs[m].className;l[y]=d.offsetLeft+d.clientLeft+u,a[y]=d.clientWidth}return{fixedPos:ha(r),gutterTotalWidth:r.gutters.offsetWidth,gutterLeft:l,gutterWidth:a,wrapperWidth:r.wrapper.clientWidth}}function ha(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function Cc(t){var r=Xi(t.display),l=t.options.lineWrapping,a=l&&Math.max(5,t.display.scroller.clientWidth/Gi(t.display)-3);return function(u){if(ti(t.doc,u))return 0;var d=0;if(u.widgets)for(var m=0;m<u.widgets.length;m++)u.widgets[m].height&&(d+=u.widgets[m].height);return l?d+(Math.ceil(u.text.length/a)||1)*r:d+r}}function da(t){var r=t.doc,l=Cc(t);r.iter(function(a){var u=l(a);u!=a.height&&Zt(a,u)})}function xi(t,r,l,a){var u=t.display;if(!l&&Qn(r).getAttribute("cm-not-content")=="true")return null;var d,m,y=u.lineSpace.getBoundingClientRect();try{d=r.clientX-y.left,m=r.clientY-y.top}catch{return null}var x=ca(t,d,m),w;if(a&&x.xRel>0&&(w=Ce(t.doc,x.line).text).length==x.ch){var M=Oe(w,w.length,t.options.tabSize)-w.length;x=le(x.line,Math.max(0,Math.round((d-hc(t.display).left)/Gi(t.display))-M))}return x}function _i(t,r){if(r>=t.display.viewTo||(r-=t.display.viewFrom,r<0))return null;for(var l=t.display.view,a=0;a<l.length;a++)if(r-=l[a].size,r<0)return a}function Vt(t,r,l,a){r==null&&(r=t.doc.first),l==null&&(l=t.doc.first+t.doc.size),a||(a=0);var u=t.display;if(a&&l<u.viewTo&&(u.updateLineNumbers==null||u.updateLineNumbers>r)&&(u.updateLineNumbers=r),t.curOp.viewChanged=!0,r>=u.viewTo)zn&&ea(t.doc,r)<u.viewTo&&ii(t);else if(l<=u.viewFrom)zn&&nc(t.doc,l+a)>u.viewFrom?ii(t):(u.viewFrom+=a,u.viewTo+=a);else if(r<=u.viewFrom&&l>=u.viewTo)ii(t);else if(r<=u.viewFrom){var d=js(t,l,l+a,1);d?(u.view=u.view.slice(d.index),u.viewFrom=d.lineN,u.viewTo+=a):ii(t)}else if(l>=u.viewTo){var m=js(t,r,r,-1);m?(u.view=u.view.slice(0,m.index),u.viewTo=m.lineN):ii(t)}else{var y=js(t,r,r,-1),x=js(t,l,l+a,1);y&&x?(u.view=u.view.slice(0,y.index).concat(Ws(t,y.lineN,x.lineN)).concat(u.view.slice(x.index)),u.viewTo+=a):ii(t)}var w=u.externalMeasured;w&&(l<w.lineN?w.lineN+=a:r<w.lineN+w.size&&(u.externalMeasured=null))}function ni(t,r,l){t.curOp.viewChanged=!0;var a=t.display,u=t.display.externalMeasured;if(u&&r>=u.lineN&&r<u.lineN+u.size&&(a.externalMeasured=null),!(r<a.viewFrom||r>=a.viewTo)){var d=a.view[_i(t,r)];if(d.node!=null){var m=d.changes||(d.changes=[]);Z(m,l)==-1&&m.push(l)}}}function ii(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function js(t,r,l,a){var u=_i(t,r),d,m=t.display.view;if(!zn||l==t.doc.first+t.doc.size)return{index:u,lineN:l};for(var y=t.display.viewFrom,x=0;x<u;x++)y+=m[x].size;if(y!=r){if(a>0){if(u==m.length-1)return null;d=y+m[u].size-r,u++}else d=y-r;r+=d,l+=d}for(;ea(t.doc,l)!=l;){if(u==(a<0?0:m.length-1))return null;l+=a*m[u-(a<0?1:0)].size,u+=a}return{index:u,lineN:l}}function Np(t,r,l){var a=t.display,u=a.view;u.length==0||r>=a.viewTo||l<=a.viewFrom?(a.view=Ws(t,r,l),a.viewFrom=r):(a.viewFrom>r?a.view=Ws(t,r,a.viewFrom).concat(a.view):a.viewFrom<r&&(a.view=a.view.slice(_i(t,r))),a.viewFrom=r,a.viewTo<l?a.view=a.view.concat(Ws(t,a.viewTo,l)):a.viewTo>l&&(a.view=a.view.slice(0,_i(t,l)))),a.viewTo=l}function Tc(t){for(var r=t.display.view,l=0,a=0;a<r.length;a++){var u=r[a];!u.hidden&&(!u.node||u.changes)&&++l}return l}function Ar(t){t.display.input.showSelection(t.display.input.prepareSelection())}function Lc(t,r){r===void 0&&(r=!0);var l=t.doc,a={},u=a.cursors=document.createDocumentFragment(),d=a.selection=document.createDocumentFragment(),m=t.options.$customCursor;m&&(r=!0);for(var y=0;y<l.sel.ranges.length;y++)if(!(!r&&y==l.sel.primIndex)){var x=l.sel.ranges[y];if(!(x.from().line>=t.display.viewTo||x.to().line<t.display.viewFrom)){var w=x.empty();if(m){var M=m(t,x);M&&pa(t,M,u)}else(w||t.options.showCursorWhenSelecting)&&pa(t,x.head,u);w||Mp(t,x,d)}}return a}function pa(t,r,l){var a=_n(t,r,"div",null,null,!t.options.singleCursorHeightPerLine),u=l.appendChild(F("div","Â ","CodeMirror-cursor"));if(u.style.left=a.left+"px",u.style.top=a.top+"px",u.style.height=Math.max(0,a.bottom-a.top)*t.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(t.getWrapperElement().className)){var d=$s(t,r,"div",null,null),m=d.right-d.left;u.style.width=(m>0?m:t.defaultCharWidth())+"px"}if(a.other){var y=l.appendChild(F("div","Â ","CodeMirror-cursor CodeMirror-secondarycursor"));y.style.display="",y.style.left=a.other.left+"px",y.style.top=a.other.top+"px",y.style.height=(a.other.bottom-a.other.top)*.85+"px"}}function Vs(t,r){return t.top-r.top||t.left-r.left}function Mp(t,r,l){var a=t.display,u=t.doc,d=document.createDocumentFragment(),m=hc(t.display),y=m.left,x=Math.max(a.sizerWidth,yi(t)-a.sizer.offsetLeft)-m.right,w=u.direction=="ltr";function M(pe,we,Pe,De){we<0&&(we=0),we=Math.round(we),De=Math.round(De),d.appendChild(F("div",null,"CodeMirror-selected","position: absolute; left: "+pe+`px;
                             top: `+we+"px; width: "+(Pe??x-pe)+`px;
                             height: `+(De-we)+"px"))}function O(pe,we,Pe){var De=Ce(u,pe),Be=De.text.length,st,Tt;function ft(bt,Gt){return $s(t,le(pe,bt),"div",De,Gt)}function Qt(bt,Gt,Nt){var wt=Sc(t,De,null,bt),xt=Gt=="ltr"==(Nt=="after")?"left":"right",dt=Nt=="after"?wt.begin:wt.end-(/\s/.test(De.text.charAt(wt.end-1))?2:1);return ft(dt,xt)[xt]}var Xt=J(De,u.direction);return z(Xt,we||0,Pe??Be,function(bt,Gt,Nt,wt){var xt=Nt=="ltr",dt=ft(bt,xt?"left":"right"),qt=ft(Gt-1,xt?"right":"left"),ar=we==null&&bt==0,ci=Pe==null&&Gt==Be,Rt=wt==0,Pn=!Xt||wt==Xt.length-1;if(qt.top-dt.top<=3){var Lt=(w?ar:ci)&&Rt,Wa=(w?ci:ar)&&Pn,jn=Lt?y:(xt?dt:qt).left,Ti=Wa?x:(xt?qt:dt).right;M(jn,dt.top,Ti-jn,dt.bottom)}else{var Li,Wt,lr,Ba;xt?(Li=w&&ar&&Rt?y:dt.left,Wt=w?x:Qt(bt,Nt,"before"),lr=w?y:Qt(Gt,Nt,"after"),Ba=w&&ci&&Pn?x:qt.right):(Li=w?Qt(bt,Nt,"before"):y,Wt=!w&&ar&&Rt?x:dt.right,lr=!w&&ci&&Pn?y:qt.left,Ba=w?Qt(Gt,Nt,"after"):x),M(Li,dt.top,Wt-Li,dt.bottom),dt.bottom<qt.top&&M(y,dt.bottom,null,qt.top),M(lr,qt.top,Ba-lr,qt.bottom)}(!st||Vs(dt,st)<0)&&(st=dt),Vs(qt,st)<0&&(st=qt),(!Tt||Vs(dt,Tt)<0)&&(Tt=dt),Vs(qt,Tt)<0&&(Tt=qt)}),{start:st,end:Tt}}var W=r.from(),H=r.to();if(W.line==H.line)O(W.line,W.ch,H.ch);else{var q=Ce(u,W.line),re=Ce(u,H.line),ue=xn(q)==xn(re),de=O(W.line,W.ch,ue?q.text.length+1:null).end,ve=O(H.line,ue?0:null,H.ch).start;ue&&(de.top<ve.top-2?(M(de.right,de.top,null,de.bottom),M(y,ve.top,ve.left,ve.bottom)):M(de.right,de.top,ve.left-de.right,de.bottom)),de.bottom<ve.top&&M(y,de.bottom,null,ve.top)}l.appendChild(d)}function ga(t){if(t.state.focused){var r=t.display;clearInterval(r.blinker);var l=!0;r.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?r.blinker=setInterval(function(){t.hasFocus()||qi(t),r.cursorDiv.style.visibility=(l=!l)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(r.cursorDiv.style.visibility="hidden")}}function Nc(t){t.hasFocus()||(t.display.input.focus(),t.state.focused||va(t))}function ma(t){t.state.delayingBlurEvent=!0,setTimeout(function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,t.state.focused&&qi(t))},100)}function va(t,r){t.state.delayingBlurEvent&&!t.state.draggingText&&(t.state.delayingBlurEvent=!1),t.options.readOnly!="nocursor"&&(t.state.focused||(Me(t,"focus",t,r),t.state.focused=!0,Ye(t.display.wrapper,"CodeMirror-focused"),!t.curOp&&t.display.selForContextMenu!=t.doc.sel&&(t.display.input.reset(),b&&setTimeout(function(){return t.display.input.reset(!0)},20)),t.display.input.receivedFocus()),ga(t))}function qi(t,r){t.state.delayingBlurEvent||(t.state.focused&&(Me(t,"blur",t,r),t.state.focused=!1,oe(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150))}function Ks(t){for(var r=t.display,l=r.lineDiv.offsetTop,a=Math.max(0,r.scroller.getBoundingClientRect().top),u=r.lineDiv.getBoundingClientRect().top,d=0,m=0;m<r.view.length;m++){var y=r.view[m],x=t.options.lineWrapping,w=void 0,M=0;if(!y.hidden){if(u+=y.line.height,p&&g<8){var O=y.node.offsetTop+y.node.offsetHeight;w=O-l,l=O}else{var W=y.node.getBoundingClientRect();w=W.bottom-W.top,!x&&y.text.firstChild&&(M=y.text.firstChild.getBoundingClientRect().right-W.left-1)}var H=y.line.height-w;if((H>.005||H<-.005)&&(u<a&&(d-=H),Zt(y.line,w),Mc(y.line),y.rest))for(var q=0;q<y.rest.length;q++)Mc(y.rest[q]);if(M>t.display.sizerWidth){var re=Math.ceil(M/Gi(t.display));re>t.display.maxLineLength&&(t.display.maxLineLength=re,t.display.maxLine=y.line,t.display.maxLineChanged=!0)}}}Math.abs(d)>2&&(r.scroller.scrollTop+=d)}function Mc(t){if(t.widgets)for(var r=0;r<t.widgets.length;++r){var l=t.widgets[r],a=l.node.parentNode;a&&(l.height=a.offsetHeight)}}function Xs(t,r,l){var a=l&&l.top!=null?Math.max(0,l.top):t.scroller.scrollTop;a=Math.floor(a-Bs(t));var u=l&&l.bottom!=null?l.bottom:a+t.wrapper.clientHeight,d=Ln(r,a),m=Ln(r,u);if(l&&l.ensure){var y=l.ensure.from.line,x=l.ensure.to.line;y<d?(d=y,m=Ln(r,Wn(Ce(r,y))+t.wrapper.clientHeight)):Math.min(x,r.lastLine())>=m&&(d=Ln(r,Wn(Ce(r,x))-t.wrapper.clientHeight),m=x)}return{from:d,to:Math.max(m,d+1)}}function Dp(t,r){if(!ot(t,"scrollCursorIntoView")){var l=t.display,a=l.sizer.getBoundingClientRect(),u=null;if(r.top+a.top<0?u=!0:r.bottom+a.top>(window.innerHeight||document.documentElement.clientHeight)&&(u=!1),u!=null&&!N){var d=F("div","â€‹",null,`position: absolute;
                         top: `+(r.top-l.viewOffset-Bs(t.display))+`px;
                         height: `+(r.bottom-r.top+Mn(t)+l.barHeight)+`px;
                         left: `+r.left+"px; width: "+Math.max(2,r.right-r.left)+"px;");t.display.lineSpace.appendChild(d),d.scrollIntoView(u),t.display.lineSpace.removeChild(d)}}}function Pp(t,r,l,a){a==null&&(a=0);var u;!t.options.lineWrapping&&r==l&&(l=r.sticky=="before"?le(r.line,r.ch+1,"before"):r,r=r.ch?le(r.line,r.sticky=="before"?r.ch-1:r.ch,"after"):r);for(var d=0;d<5;d++){var m=!1,y=_n(t,r),x=!l||l==r?y:_n(t,l);u={left:Math.min(y.left,x.left),top:Math.min(y.top,x.top)-a,right:Math.max(y.left,x.left),bottom:Math.max(y.bottom,x.bottom)+a};var w=ya(t,u),M=t.doc.scrollTop,O=t.doc.scrollLeft;if(w.scrollTop!=null&&(Er(t,w.scrollTop),Math.abs(t.doc.scrollTop-M)>1&&(m=!0)),w.scrollLeft!=null&&(wi(t,w.scrollLeft),Math.abs(t.doc.scrollLeft-O)>1&&(m=!0)),!m)break}return u}function Op(t,r){var l=ya(t,r);l.scrollTop!=null&&Er(t,l.scrollTop),l.scrollLeft!=null&&wi(t,l.scrollLeft)}function ya(t,r){var l=t.display,a=Xi(t.display);r.top<0&&(r.top=0);var u=t.curOp&&t.curOp.scrollTop!=null?t.curOp.scrollTop:l.scroller.scrollTop,d=sa(t),m={};r.bottom-r.top>d&&(r.bottom=r.top+d);var y=t.doc.height+ra(l),x=r.top<a,w=r.bottom>y-a;if(r.top<u)m.scrollTop=x?0:r.top;else if(r.bottom>u+d){var M=Math.min(r.top,(w?y:r.bottom)-d);M!=u&&(m.scrollTop=M)}var O=t.options.fixedGutter?0:l.gutters.offsetWidth,W=t.curOp&&t.curOp.scrollLeft!=null?t.curOp.scrollLeft:l.scroller.scrollLeft-O,H=yi(t)-l.gutters.offsetWidth,q=r.right-r.left>H;return q&&(r.right=r.left+H),r.left<10?m.scrollLeft=0:r.left<W?m.scrollLeft=Math.max(0,r.left+O-(q?0:10)):r.right>H+W-3&&(m.scrollLeft=r.right+(q?0:10)-H),m}function ba(t,r){r!=null&&(Gs(t),t.curOp.scrollTop=(t.curOp.scrollTop==null?t.doc.scrollTop:t.curOp.scrollTop)+r)}function Yi(t){Gs(t);var r=t.getCursor();t.curOp.scrollToPos={from:r,to:r,margin:t.options.cursorScrollMargin}}function Ir(t,r,l){(r!=null||l!=null)&&Gs(t),r!=null&&(t.curOp.scrollLeft=r),l!=null&&(t.curOp.scrollTop=l)}function Ap(t,r){Gs(t),t.curOp.scrollToPos=r}function Gs(t){var r=t.curOp.scrollToPos;if(r){t.curOp.scrollToPos=null;var l=wc(t,r.from),a=wc(t,r.to);Dc(t,l,a,r.margin)}}function Dc(t,r,l,a){var u=ya(t,{left:Math.min(r.left,l.left),top:Math.min(r.top,l.top)-a,right:Math.max(r.right,l.right),bottom:Math.max(r.bottom,l.bottom)+a});Ir(t,u.scrollLeft,u.scrollTop)}function Er(t,r){Math.abs(t.doc.scrollTop-r)<2||(o||_a(t,{top:r}),Pc(t,r,!0),o&&_a(t),Hr(t,100))}function Pc(t,r,l){r=Math.max(0,Math.min(t.display.scroller.scrollHeight-t.display.scroller.clientHeight,r)),!(t.display.scroller.scrollTop==r&&!l)&&(t.doc.scrollTop=r,t.display.scrollbars.setScrollTop(r),t.display.scroller.scrollTop!=r&&(t.display.scroller.scrollTop=r))}function wi(t,r,l,a){r=Math.max(0,Math.min(r,t.display.scroller.scrollWidth-t.display.scroller.clientWidth)),!((l?r==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-r)<2)&&!a)&&(t.doc.scrollLeft=r,Rc(t),t.display.scroller.scrollLeft!=r&&(t.display.scroller.scrollLeft=r),t.display.scrollbars.setScrollLeft(r))}function Rr(t){var r=t.display,l=r.gutters.offsetWidth,a=Math.round(t.doc.height+ra(t.display));return{clientHeight:r.scroller.clientHeight,viewHeight:r.wrapper.clientHeight,scrollWidth:r.scroller.scrollWidth,clientWidth:r.scroller.clientWidth,viewWidth:r.wrapper.clientWidth,barLeft:t.options.fixedGutter?l:0,docHeight:a,scrollHeight:a+Mn(t)+r.barHeight,nativeBarWidth:r.nativeBarWidth,gutterWidth:l}}var ki=function(t,r,l){this.cm=l;var a=this.vert=F("div",[F("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),u=this.horiz=F("div",[F("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");a.tabIndex=u.tabIndex=-1,t(a),t(u),ne(a,"scroll",function(){a.clientHeight&&r(a.scrollTop,"vertical")}),ne(u,"scroll",function(){u.clientWidth&&r(u.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,p&&g<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};ki.prototype.update=function(t){var r=t.scrollWidth>t.clientWidth+1,l=t.scrollHeight>t.clientHeight+1,a=t.nativeBarWidth;if(l){this.vert.style.display="block",this.vert.style.bottom=r?a+"px":"0";var u=t.viewHeight-(r?a:0);this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+u)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(r){this.horiz.style.display="block",this.horiz.style.right=l?a+"px":"0",this.horiz.style.left=t.barLeft+"px";var d=t.viewWidth-t.barLeft-(l?a:0);this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+d)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&t.clientHeight>0&&(a==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:l?a:0,bottom:r?a:0}},ki.prototype.setScrollLeft=function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},ki.prototype.setScrollTop=function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},ki.prototype.zeroWidthHack=function(){var t=X&&!P?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new U,this.disableVert=new U},ki.prototype.enableZeroWidthBar=function(t,r,l){t.style.pointerEvents="auto";function a(){var u=t.getBoundingClientRect(),d=l=="vert"?document.elementFromPoint(u.right-1,(u.top+u.bottom)/2):document.elementFromPoint((u.right+u.left)/2,u.bottom-1);d!=t?t.style.pointerEvents="none":r.set(1e3,a)}r.set(1e3,a)},ki.prototype.clear=function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)};var Fr=function(){};Fr.prototype.update=function(){return{bottom:0,right:0}},Fr.prototype.setScrollLeft=function(){},Fr.prototype.setScrollTop=function(){},Fr.prototype.clear=function(){};function Zi(t,r){r||(r=Rr(t));var l=t.display.barWidth,a=t.display.barHeight;Oc(t,r);for(var u=0;u<4&&l!=t.display.barWidth||a!=t.display.barHeight;u++)l!=t.display.barWidth&&t.options.lineWrapping&&Ks(t),Oc(t,Rr(t)),l=t.display.barWidth,a=t.display.barHeight}function Oc(t,r){var l=t.display,a=l.scrollbars.update(r);l.sizer.style.paddingRight=(l.barWidth=a.right)+"px",l.sizer.style.paddingBottom=(l.barHeight=a.bottom)+"px",l.heightForcer.style.borderBottom=a.bottom+"px solid transparent",a.right&&a.bottom?(l.scrollbarFiller.style.display="block",l.scrollbarFiller.style.height=a.bottom+"px",l.scrollbarFiller.style.width=a.right+"px"):l.scrollbarFiller.style.display="",a.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(l.gutterFiller.style.display="block",l.gutterFiller.style.height=a.bottom+"px",l.gutterFiller.style.width=r.gutterWidth+"px"):l.gutterFiller.style.display=""}var Ac={native:ki,null:Fr};function Ic(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&oe(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new Ac[t.options.scrollbarStyle](function(r){t.display.wrapper.insertBefore(r,t.display.scrollbarFiller),ne(r,"mousedown",function(){t.state.focused&&setTimeout(function(){return t.display.input.focus()},0)}),r.setAttribute("cm-not-content","true")},function(r,l){l=="horizontal"?wi(t,r):Er(t,r)},t),t.display.scrollbars.addClass&&Ye(t.display.wrapper,t.display.scrollbars.addClass)}var Ip=0;function Si(t){t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Ip,markArrays:null},fp(t.curOp)}function Ci(t){var r=t.curOp;r&&dp(r,function(l){for(var a=0;a<l.ops.length;a++)l.ops[a].cm.curOp=null;Ep(l)})}function Ep(t){for(var r=t.ops,l=0;l<r.length;l++)Rp(r[l]);for(var a=0;a<r.length;a++)Fp(r[a]);for(var u=0;u<r.length;u++)Hp(r[u]);for(var d=0;d<r.length;d++)zp(r[d]);for(var m=0;m<r.length;m++)Wp(r[m])}function Rp(t){var r=t.cm,l=r.display;Up(r),t.updateMaxLine&&na(r),t.mustUpdate=t.viewChanged||t.forceUpdate||t.scrollTop!=null||t.scrollToPos&&(t.scrollToPos.from.line<l.viewFrom||t.scrollToPos.to.line>=l.viewTo)||l.maxLineChanged&&r.options.lineWrapping,t.update=t.mustUpdate&&new qs(r,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function Fp(t){t.updatedDisplay=t.mustUpdate&&xa(t.cm,t.update)}function Hp(t){var r=t.cm,l=r.display;t.updatedDisplay&&Ks(r),t.barMeasure=Rr(r),l.maxLineChanged&&!r.options.lineWrapping&&(t.adjustWidthTo=pc(r,l.maxLine,l.maxLine.text.length).left+3,r.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(l.scroller.clientWidth,l.sizer.offsetLeft+t.adjustWidthTo+Mn(r)+r.display.barWidth),t.maxScrollLeft=Math.max(0,l.sizer.offsetLeft+t.adjustWidthTo-yi(r))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=l.input.prepareSelection())}function zp(t){var r=t.cm;t.adjustWidthTo!=null&&(r.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<r.doc.scrollLeft&&wi(r,Math.min(r.display.scroller.scrollLeft,t.maxScrollLeft),!0),r.display.maxLineChanged=!1);var l=t.focus&&t.focus==je();t.preparedSelection&&r.display.input.showSelection(t.preparedSelection,l),(t.updatedDisplay||t.startHeight!=r.doc.height)&&Zi(r,t.barMeasure),t.updatedDisplay&&ka(r,t.barMeasure),t.selectionChanged&&ga(r),r.state.focused&&t.updateInput&&r.display.input.reset(t.typing),l&&Nc(t.cm)}function Wp(t){var r=t.cm,l=r.display,a=r.doc;if(t.updatedDisplay&&Ec(r,t.update),l.wheelStartX!=null&&(t.scrollTop!=null||t.scrollLeft!=null||t.scrollToPos)&&(l.wheelStartX=l.wheelStartY=null),t.scrollTop!=null&&Pc(r,t.scrollTop,t.forceScroll),t.scrollLeft!=null&&wi(r,t.scrollLeft,!0,!0),t.scrollToPos){var u=Pp(r,ye(a,t.scrollToPos.from),ye(a,t.scrollToPos.to),t.scrollToPos.margin);Dp(r,u)}var d=t.maybeHiddenMarkers,m=t.maybeUnhiddenMarkers;if(d)for(var y=0;y<d.length;++y)d[y].lines.length||Me(d[y],"hide");if(m)for(var x=0;x<m.length;++x)m[x].lines.length&&Me(m[x],"unhide");l.wrapper.offsetHeight&&(a.scrollTop=r.display.scroller.scrollTop),t.changeObjs&&Me(r,"changes",r,t.changeObjs),t.update&&t.update.finish()}function Jt(t,r){if(t.curOp)return r();Si(t);try{return r()}finally{Ci(t)}}function St(t,r){return function(){if(t.curOp)return r.apply(t,arguments);Si(t);try{return r.apply(t,arguments)}finally{Ci(t)}}}function zt(t){return function(){if(this.curOp)return t.apply(this,arguments);Si(this);try{return t.apply(this,arguments)}finally{Ci(this)}}}function Ct(t){return function(){var r=this.cm;if(!r||r.curOp)return t.apply(this,arguments);Si(r);try{return t.apply(this,arguments)}finally{Ci(r)}}}function Hr(t,r){t.doc.highlightFrontier<t.display.viewTo&&t.state.highlight.set(r,_e(Bp,t))}function Bp(t){var r=t.doc;if(!(r.highlightFrontier>=t.display.viewTo)){var l=+new Date+t.options.workTime,a=Lr(t,r.highlightFrontier),u=[];r.iter(a.line,Math.min(r.first+r.size,t.display.viewTo+500),function(d){if(a.line>=t.display.viewFrom){var m=d.styles,y=d.text.length>t.options.maxHighlightLength?an(r.mode,a.state):null,x=Ul(t,d,a,!0);y&&(a.state=y),d.styles=x.styles;var w=d.styleClasses,M=x.classes;M?d.styleClasses=M:w&&(d.styleClasses=null);for(var O=!m||m.length!=d.styles.length||w!=M&&(!w||!M||w.bgClass!=M.bgClass||w.textClass!=M.textClass),W=0;!O&&W<m.length;++W)O=m[W]!=d.styles[W];O&&u.push(a.line),d.stateAfter=a.save(),a.nextLine()}else d.text.length<=t.options.maxHighlightLength&&Yo(t,d.text,a),d.stateAfter=a.line%5==0?a.save():null,a.nextLine();if(+new Date>l)return Hr(t,t.options.workDelay),!0}),r.highlightFrontier=a.line,r.modeFrontier=Math.max(r.modeFrontier,a.line),u.length&&Jt(t,function(){for(var d=0;d<u.length;d++)ni(t,u[d],"text")})}}var qs=function(t,r,l){var a=t.display;this.viewport=r,this.visible=Xs(a,t.doc,r),this.editorIsHidden=!a.wrapper.offsetWidth,this.wrapperHeight=a.wrapper.clientHeight,this.wrapperWidth=a.wrapper.clientWidth,this.oldDisplayWidth=yi(t),this.force=l,this.dims=fa(t),this.events=[]};qs.prototype.signal=function(t,r){tt(t,r)&&this.events.push(arguments)},qs.prototype.finish=function(){for(var t=0;t<this.events.length;t++)Me.apply(null,this.events[t])};function Up(t){var r=t.display;!r.scrollbarsClipped&&r.scroller.offsetWidth&&(r.nativeBarWidth=r.scroller.offsetWidth-r.scroller.clientWidth,r.heightForcer.style.height=Mn(t)+"px",r.sizer.style.marginBottom=-r.nativeBarWidth+"px",r.sizer.style.borderRightWidth=Mn(t)+"px",r.scrollbarsClipped=!0)}function $p(t){if(t.hasFocus())return null;var r=je();if(!r||!Le(t.display.lineDiv,r))return null;var l={activeElt:r};if(window.getSelection){var a=window.getSelection();a.anchorNode&&a.extend&&Le(t.display.lineDiv,a.anchorNode)&&(l.anchorNode=a.anchorNode,l.anchorOffset=a.anchorOffset,l.focusNode=a.focusNode,l.focusOffset=a.focusOffset)}return l}function jp(t){if(!(!t||!t.activeElt||t.activeElt==je())&&(t.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(t.activeElt.nodeName)&&t.anchorNode&&Le(document.body,t.anchorNode)&&Le(document.body,t.focusNode))){var r=window.getSelection(),l=document.createRange();l.setEnd(t.anchorNode,t.anchorOffset),l.collapse(!1),r.removeAllRanges(),r.addRange(l),r.extend(t.focusNode,t.focusOffset)}}function xa(t,r){var l=t.display,a=t.doc;if(r.editorIsHidden)return ii(t),!1;if(!r.force&&r.visible.from>=l.viewFrom&&r.visible.to<=l.viewTo&&(l.updateLineNumbers==null||l.updateLineNumbers>=l.viewTo)&&l.renderedView==l.view&&Tc(t)==0)return!1;Fc(t)&&(ii(t),r.dims=fa(t));var u=a.first+a.size,d=Math.max(r.visible.from-t.options.viewportMargin,a.first),m=Math.min(u,r.visible.to+t.options.viewportMargin);l.viewFrom<d&&d-l.viewFrom<20&&(d=Math.max(a.first,l.viewFrom)),l.viewTo>m&&l.viewTo-m<20&&(m=Math.min(u,l.viewTo)),zn&&(d=ea(t.doc,d),m=nc(t.doc,m));var y=d!=l.viewFrom||m!=l.viewTo||l.lastWrapHeight!=r.wrapperHeight||l.lastWrapWidth!=r.wrapperWidth;Np(t,d,m),l.viewOffset=Wn(Ce(t.doc,l.viewFrom)),t.display.mover.style.top=l.viewOffset+"px";var x=Tc(t);if(!y&&x==0&&!r.force&&l.renderedView==l.view&&(l.updateLineNumbers==null||l.updateLineNumbers>=l.viewTo))return!1;var w=$p(t);return x>4&&(l.lineDiv.style.display="none"),Vp(t,l.updateLineNumbers,r.dims),x>4&&(l.lineDiv.style.display=""),l.renderedView=l.view,jp(w),se(l.cursorDiv),se(l.selectionDiv),l.gutters.style.height=l.sizer.style.minHeight=0,y&&(l.lastWrapHeight=r.wrapperHeight,l.lastWrapWidth=r.wrapperWidth,Hr(t,400)),l.updateLineNumbers=null,!0}function Ec(t,r){for(var l=r.viewport,a=!0;;a=!1){if(!a||!t.options.lineWrapping||r.oldDisplayWidth==yi(t)){if(l&&l.top!=null&&(l={top:Math.min(t.doc.height+ra(t.display)-sa(t),l.top)}),r.visible=Xs(t.display,t.doc,l),r.visible.from>=t.display.viewFrom&&r.visible.to<=t.display.viewTo)break}else a&&(r.visible=Xs(t.display,t.doc,l));if(!xa(t,r))break;Ks(t);var u=Rr(t);Ar(t),Zi(t,u),ka(t,u),r.force=!1}r.signal(t,"update",t),(t.display.viewFrom!=t.display.reportedViewFrom||t.display.viewTo!=t.display.reportedViewTo)&&(r.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function _a(t,r){var l=new qs(t,r);if(xa(t,l)){Ks(t),Ec(t,l);var a=Rr(t);Ar(t),Zi(t,a),ka(t,a),l.finish()}}function Vp(t,r,l){var a=t.display,u=t.options.lineNumbers,d=a.lineDiv,m=d.firstChild;function y(q){var re=q.nextSibling;return b&&X&&t.display.currentWheelTarget==q?q.style.display="none":q.parentNode.removeChild(q),re}for(var x=a.view,w=a.viewFrom,M=0;M<x.length;M++){var O=x[M];if(!O.hidden)if(!O.node||O.node.parentNode!=d){var W=yp(t,O,w,l);d.insertBefore(W,m)}else{for(;m!=O.node;)m=y(m);var H=u&&r!=null&&r<=w&&O.lineNumber;O.changes&&(Z(O.changes,"gutter")>-1&&(H=!1),ac(t,O,w,l)),H&&(se(O.lineNumber),O.lineNumber.appendChild(document.createTextNode(Tr(t.options,w)))),m=O.node.nextSibling}w+=O.size}for(;m;)m=y(m)}function wa(t){var r=t.gutters.offsetWidth;t.sizer.style.marginLeft=r+"px",kt(t,"gutterChanged",t)}function ka(t,r){t.display.sizer.style.minHeight=r.docHeight+"px",t.display.heightForcer.style.top=r.docHeight+"px",t.display.gutters.style.height=r.docHeight+t.display.barHeight+Mn(t)+"px"}function Rc(t){var r=t.display,l=r.view;if(!(!r.alignWidgets&&(!r.gutters.firstChild||!t.options.fixedGutter))){for(var a=ha(r)-r.scroller.scrollLeft+t.doc.scrollLeft,u=r.gutters.offsetWidth,d=a+"px",m=0;m<l.length;m++)if(!l[m].hidden){t.options.fixedGutter&&(l[m].gutter&&(l[m].gutter.style.left=d),l[m].gutterBackground&&(l[m].gutterBackground.style.left=d));var y=l[m].alignable;if(y)for(var x=0;x<y.length;x++)y[x].style.left=d}t.options.fixedGutter&&(r.gutters.style.left=a+u+"px")}}function Fc(t){if(!t.options.lineNumbers)return!1;var r=t.doc,l=Tr(t.options,r.first+r.size-1),a=t.display;if(l.length!=a.lineNumChars){var u=a.measure.appendChild(F("div",[F("div",l)],"CodeMirror-linenumber CodeMirror-gutter-elt")),d=u.firstChild.offsetWidth,m=u.offsetWidth-d;return a.lineGutter.style.width="",a.lineNumInnerWidth=Math.max(d,a.lineGutter.offsetWidth-m)+1,a.lineNumWidth=a.lineNumInnerWidth+m,a.lineNumChars=a.lineNumInnerWidth?l.length:-1,a.lineGutter.style.width=a.lineNumWidth+"px",wa(t.display),!0}return!1}function Sa(t,r){for(var l=[],a=!1,u=0;u<t.length;u++){var d=t[u],m=null;if(typeof d!="string"&&(m=d.style,d=d.className),d=="CodeMirror-linenumbers")if(r)a=!0;else continue;l.push({className:d,style:m})}return r&&!a&&l.push({className:"CodeMirror-linenumbers",style:null}),l}function Hc(t){var r=t.gutters,l=t.gutterSpecs;se(r),t.lineGutter=null;for(var a=0;a<l.length;++a){var u=l[a],d=u.className,m=u.style,y=r.appendChild(F("div",null,"CodeMirror-gutter "+d));m&&(y.style.cssText=m),d=="CodeMirror-linenumbers"&&(t.lineGutter=y,y.style.width=(t.lineNumWidth||1)+"px")}r.style.display=l.length?"":"none",wa(t)}function zr(t){Hc(t.display),Vt(t),Rc(t)}function Kp(t,r,l,a){var u=this;this.input=l,u.scrollbarFiller=F("div",null,"CodeMirror-scrollbar-filler"),u.scrollbarFiller.setAttribute("cm-not-content","true"),u.gutterFiller=F("div",null,"CodeMirror-gutter-filler"),u.gutterFiller.setAttribute("cm-not-content","true"),u.lineDiv=S("div",null,"CodeMirror-code"),u.selectionDiv=F("div",null,null,"position: relative; z-index: 1"),u.cursorDiv=F("div",null,"CodeMirror-cursors"),u.measure=F("div",null,"CodeMirror-measure"),u.lineMeasure=F("div",null,"CodeMirror-measure"),u.lineSpace=S("div",[u.measure,u.lineMeasure,u.selectionDiv,u.cursorDiv,u.lineDiv],null,"position: relative; outline: none");var d=S("div",[u.lineSpace],"CodeMirror-lines");u.mover=F("div",[d],null,"position: relative"),u.sizer=F("div",[u.mover],"CodeMirror-sizer"),u.sizerWidth=null,u.heightForcer=F("div",null,null,"position: absolute; height: "+ie+"px; width: 1px;"),u.gutters=F("div",null,"CodeMirror-gutters"),u.lineGutter=null,u.scroller=F("div",[u.sizer,u.heightForcer,u.gutters],"CodeMirror-scroll"),u.scroller.setAttribute("tabIndex","-1"),u.wrapper=F("div",[u.scrollbarFiller,u.gutterFiller,u.scroller],"CodeMirror"),u.wrapper.setAttribute("translate","no"),p&&g<8&&(u.gutters.style.zIndex=-1,u.scroller.style.paddingRight=0),!b&&!(o&&j)&&(u.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(u.wrapper):t(u.wrapper)),u.viewFrom=u.viewTo=r.first,u.reportedViewFrom=u.reportedViewTo=r.first,u.view=[],u.renderedView=null,u.externalMeasured=null,u.viewOffset=0,u.lastWrapHeight=u.lastWrapWidth=0,u.updateLineNumbers=null,u.nativeBarWidth=u.barHeight=u.barWidth=0,u.scrollbarsClipped=!1,u.lineNumWidth=u.lineNumInnerWidth=u.lineNumChars=null,u.alignWidgets=!1,u.cachedCharWidth=u.cachedTextHeight=u.cachedPaddingH=null,u.maxLine=null,u.maxLineLength=0,u.maxLineChanged=!1,u.wheelDX=u.wheelDY=u.wheelStartX=u.wheelStartY=null,u.shift=!1,u.selForContextMenu=null,u.activeTouch=null,u.gutterSpecs=Sa(a.gutters,a.lineNumbers),Hc(u),l.init(u)}var Ys=0,Un=null;p?Un=-.53:o?Un=15:T?Un=-.7:D&&(Un=-1/3);function zc(t){var r=t.wheelDeltaX,l=t.wheelDeltaY;return r==null&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(r=t.detail),l==null&&t.detail&&t.axis==t.VERTICAL_AXIS?l=t.detail:l==null&&(l=t.wheelDelta),{x:r,y:l}}function Xp(t){var r=zc(t);return r.x*=Un,r.y*=Un,r}function Wc(t,r){var l=zc(r),a=l.x,u=l.y,d=Un;r.deltaMode===0&&(a=r.deltaX,u=r.deltaY,d=1);var m=t.display,y=m.scroller,x=y.scrollWidth>y.clientWidth,w=y.scrollHeight>y.clientHeight;if(a&&x||u&&w){if(u&&X&&b){e:for(var M=r.target,O=m.view;M!=y;M=M.parentNode)for(var W=0;W<O.length;W++)if(O[W].node==M){t.display.currentWheelTarget=M;break e}}if(a&&!o&&!L&&d!=null){u&&w&&Er(t,Math.max(0,y.scrollTop+u*d)),wi(t,Math.max(0,y.scrollLeft+a*d)),(!u||u&&w)&&At(r),m.wheelStartX=null;return}if(u&&d!=null){var H=u*d,q=t.doc.scrollTop,re=q+m.wrapper.clientHeight;H<0?q=Math.max(0,q+H-50):re=Math.min(t.doc.height,re+H+50),_a(t,{top:q,bottom:re})}Ys<20&&r.deltaMode!==0&&(m.wheelStartX==null?(m.wheelStartX=y.scrollLeft,m.wheelStartY=y.scrollTop,m.wheelDX=a,m.wheelDY=u,setTimeout(function(){if(m.wheelStartX!=null){var ue=y.scrollLeft-m.wheelStartX,de=y.scrollTop-m.wheelStartY,ve=de&&m.wheelDY&&de/m.wheelDY||ue&&m.wheelDX&&ue/m.wheelDX;m.wheelStartX=m.wheelStartY=null,ve&&(Un=(Un*Ys+ve)/(Ys+1),++Ys)}},200)):(m.wheelDX+=a,m.wheelDY+=u))}}var cn=function(t,r){this.ranges=t,this.primIndex=r};cn.prototype.primary=function(){return this.ranges[this.primIndex]},cn.prototype.equals=function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var r=0;r<this.ranges.length;r++){var l=this.ranges[r],a=t.ranges[r];if(!A(l.anchor,a.anchor)||!A(l.head,a.head))return!1}return!0},cn.prototype.deepCopy=function(){for(var t=[],r=0;r<this.ranges.length;r++)t[r]=new Qe(ee(this.ranges[r].anchor),ee(this.ranges[r].head));return new cn(t,this.primIndex)},cn.prototype.somethingSelected=function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},cn.prototype.contains=function(t,r){r||(r=t);for(var l=0;l<this.ranges.length;l++){var a=this.ranges[l];if(k(r,a.from())>=0&&k(t,a.to())<=0)return l}return-1};var Qe=function(t,r){this.anchor=t,this.head=r};Qe.prototype.from=function(){return Re(this.anchor,this.head)},Qe.prototype.to=function(){return ce(this.anchor,this.head)},Qe.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function wn(t,r,l){var a=t&&t.options.selectionsMayTouch,u=r[l];r.sort(function(W,H){return k(W.from(),H.from())}),l=Z(r,u);for(var d=1;d<r.length;d++){var m=r[d],y=r[d-1],x=k(y.to(),m.from());if(a&&!m.empty()?x>0:x>=0){var w=Re(y.from(),m.from()),M=ce(y.to(),m.to()),O=y.empty()?m.from()==m.head:y.from()==y.head;d<=l&&--l,r.splice(--d,2,new Qe(O?M:w,O?w:M))}}return new cn(r,l)}function ri(t,r){return new cn([new Qe(t,r||t)],0)}function si(t){return t.text?le(t.from.line+t.text.length-1,V(t.text).length+(t.text.length==1?t.from.ch:0)):t.to}function Bc(t,r){if(k(t,r.from)<0)return t;if(k(t,r.to)<=0)return si(r);var l=t.line+r.text.length-(r.to.line-r.from.line)-1,a=t.ch;return t.line==r.to.line&&(a+=si(r).ch-r.to.ch),le(l,a)}function Ca(t,r){for(var l=[],a=0;a<t.sel.ranges.length;a++){var u=t.sel.ranges[a];l.push(new Qe(Bc(u.anchor,r),Bc(u.head,r)))}return wn(t.cm,l,t.sel.primIndex)}function Uc(t,r,l){return t.line==r.line?le(l.line,t.ch-r.ch+l.ch):le(l.line+(t.line-r.line),t.ch)}function Gp(t,r,l){for(var a=[],u=le(t.first,0),d=u,m=0;m<r.length;m++){var y=r[m],x=Uc(y.from,u,d),w=Uc(si(y),u,d);if(u=y.to,d=w,l=="around"){var M=t.sel.ranges[m],O=k(M.head,M.anchor)<0;a[m]=new Qe(O?w:x,O?x:w)}else a[m]=new Qe(x,x)}return new cn(a,t.sel.primIndex)}function Ta(t){t.doc.mode=Ui(t.options,t.doc.modeOption),Wr(t)}function Wr(t){t.doc.iter(function(r){r.stateAfter&&(r.stateAfter=null),r.styles&&(r.styles=null)}),t.doc.modeFrontier=t.doc.highlightFrontier=t.doc.first,Hr(t,100),t.state.modeGen++,t.curOp&&Vt(t)}function $c(t,r){return r.from.ch==0&&r.to.ch==0&&V(r.text)==""&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function La(t,r,l,a){function u(ve){return l?l[ve]:null}function d(ve,pe,we){np(ve,pe,we,a),kt(ve,"change",ve,r)}function m(ve,pe){for(var we=[],Pe=ve;Pe<pe;++Pe)we.push(new ji(w[Pe],u(Pe),a));return we}var y=r.from,x=r.to,w=r.text,M=Ce(t,y.line),O=Ce(t,x.line),W=V(w),H=u(w.length-1),q=x.line-y.line;if(r.full)t.insert(0,m(0,w.length)),t.remove(w.length,t.size-w.length);else if($c(t,r)){var re=m(0,w.length-1);d(O,O.text,H),q&&t.remove(y.line,q),re.length&&t.insert(y.line,re)}else if(M==O)if(w.length==1)d(M,M.text.slice(0,y.ch)+W+M.text.slice(x.ch),H);else{var ue=m(1,w.length-1);ue.push(new ji(W+M.text.slice(x.ch),H,a)),d(M,M.text.slice(0,y.ch)+w[0],u(0)),t.insert(y.line+1,ue)}else if(w.length==1)d(M,M.text.slice(0,y.ch)+w[0]+O.text.slice(x.ch),u(0)),t.remove(y.line+1,q);else{d(M,M.text.slice(0,y.ch)+w[0],u(0)),d(O,W+O.text.slice(x.ch),H);var de=m(1,w.length-1);q>1&&t.remove(y.line+1,q-1),t.insert(y.line+1,de)}kt(t,"change",t,r)}function oi(t,r,l){function a(u,d,m){if(u.linked)for(var y=0;y<u.linked.length;++y){var x=u.linked[y];if(x.doc!=d){var w=m&&x.sharedHist;l&&!w||(r(x.doc,w),a(x.doc,u,w))}}}a(t,null,!0)}function jc(t,r){if(r.cm)throw new Error("This document is already in use.");t.doc=r,r.cm=t,da(t),Ta(t),Vc(t),t.options.direction=r.direction,t.options.lineWrapping||na(t),t.options.mode=r.modeOption,Vt(t)}function Vc(t){(t.doc.direction=="rtl"?Ye:oe)(t.display.lineDiv,"CodeMirror-rtl")}function qp(t){Jt(t,function(){Vc(t),Vt(t)})}function Zs(t){this.done=[],this.undone=[],this.undoDepth=t?t.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t?t.maxGeneration:1}function Na(t,r){var l={from:ee(r.from),to:si(r),text:Tn(t,r.from,r.to)};return Gc(t,l,r.from.line,r.to.line+1),oi(t,function(a){return Gc(a,l,r.from.line,r.to.line+1)},!0),l}function Kc(t){for(;t.length;){var r=V(t);if(r.ranges)t.pop();else break}}function Yp(t,r){if(r)return Kc(t.done),V(t.done);if(t.done.length&&!V(t.done).ranges)return V(t.done);if(t.done.length>1&&!t.done[t.done.length-2].ranges)return t.done.pop(),V(t.done)}function Xc(t,r,l,a){var u=t.history;u.undone.length=0;var d=+new Date,m,y;if((u.lastOp==a||u.lastOrigin==r.origin&&r.origin&&(r.origin.charAt(0)=="+"&&u.lastModTime>d-(t.cm?t.cm.options.historyEventDelay:500)||r.origin.charAt(0)=="*"))&&(m=Yp(u,u.lastOp==a)))y=V(m.changes),k(r.from,r.to)==0&&k(r.from,y.to)==0?y.to=si(r):m.changes.push(Na(t,r));else{var x=V(u.done);for((!x||!x.ranges)&&Js(t.sel,u.done),m={changes:[Na(t,r)],generation:u.generation},u.done.push(m);u.done.length>u.undoDepth;)u.done.shift(),u.done[0].ranges||u.done.shift()}u.done.push(l),u.generation=++u.maxGeneration,u.lastModTime=u.lastSelTime=d,u.lastOp=u.lastSelOp=a,u.lastOrigin=u.lastSelOrigin=r.origin,y||Me(t,"historyAdded")}function Zp(t,r,l,a){var u=r.charAt(0);return u=="*"||u=="+"&&l.ranges.length==a.ranges.length&&l.somethingSelected()==a.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}function Jp(t,r,l,a){var u=t.history,d=a&&a.origin;l==u.lastSelOp||d&&u.lastSelOrigin==d&&(u.lastModTime==u.lastSelTime&&u.lastOrigin==d||Zp(t,d,V(u.done),r))?u.done[u.done.length-1]=r:Js(r,u.done),u.lastSelTime=+new Date,u.lastSelOrigin=d,u.lastSelOp=l,a&&a.clearRedo!==!1&&Kc(u.undone)}function Js(t,r){var l=V(r);l&&l.ranges&&l.equals(t)||r.push(t)}function Gc(t,r,l,a){var u=r["spans_"+t.id],d=0;t.iter(Math.max(t.first,l),Math.min(t.first+t.size,a),function(m){m.markedSpans&&((u||(u=r["spans_"+t.id]={}))[d]=m.markedSpans),++d})}function Qp(t){if(!t)return null;for(var r,l=0;l<t.length;++l)t[l].marker.explicitlyCleared?r||(r=t.slice(0,l)):r&&r.push(t[l]);return r?r.length?r:null:t}function eg(t,r){var l=r["spans_"+t.id];if(!l)return null;for(var a=[],u=0;u<r.text.length;++u)a.push(Qp(l[u]));return a}function qc(t,r){var l=eg(t,r),a=Jo(t,r);if(!l)return a;if(!a)return l;for(var u=0;u<l.length;++u){var d=l[u],m=a[u];if(d&&m)e:for(var y=0;y<m.length;++y){for(var x=m[y],w=0;w<d.length;++w)if(d[w].marker==x.marker)continue e;d.push(x)}else m&&(l[u]=m)}return l}function Ji(t,r,l){for(var a=[],u=0;u<t.length;++u){var d=t[u];if(d.ranges){a.push(l?cn.prototype.deepCopy.call(d):d);continue}var m=d.changes,y=[];a.push({changes:y});for(var x=0;x<m.length;++x){var w=m[x],M=void 0;if(y.push({from:w.from,to:w.to,text:w.text}),r)for(var O in w)(M=O.match(/^spans_(\d+)$/))&&Z(r,Number(M[1]))>-1&&(V(y)[O]=w[O],delete w[O])}}return a}function Ma(t,r,l,a){if(a){var u=t.anchor;if(l){var d=k(r,u)<0;d!=k(l,u)<0?(u=r,r=l):d!=k(r,l)<0&&(r=l)}return new Qe(u,r)}else return new Qe(l||r,r)}function Qs(t,r,l,a,u){u==null&&(u=t.cm&&(t.cm.display.shift||t.extend)),Et(t,new cn([Ma(t.sel.primary(),r,l,u)],0),a)}function Yc(t,r,l){for(var a=[],u=t.cm&&(t.cm.display.shift||t.extend),d=0;d<t.sel.ranges.length;d++)a[d]=Ma(t.sel.ranges[d],r[d],null,u);var m=wn(t.cm,a,t.sel.primIndex);Et(t,m,l)}function Da(t,r,l,a){var u=t.sel.ranges.slice(0);u[r]=l,Et(t,wn(t.cm,u,t.sel.primIndex),a)}function Zc(t,r,l,a){Et(t,ri(r,l),a)}function tg(t,r,l){var a={ranges:r.ranges,update:function(u){this.ranges=[];for(var d=0;d<u.length;d++)this.ranges[d]=new Qe(ye(t,u[d].anchor),ye(t,u[d].head))},origin:l&&l.origin};return Me(t,"beforeSelectionChange",t,a),t.cm&&Me(t.cm,"beforeSelectionChange",t.cm,a),a.ranges!=r.ranges?wn(t.cm,a.ranges,a.ranges.length-1):r}function Jc(t,r,l){var a=t.history.done,u=V(a);u&&u.ranges?(a[a.length-1]=r,eo(t,r,l)):Et(t,r,l)}function Et(t,r,l){eo(t,r,l),Jp(t,t.sel,t.cm?t.cm.curOp.id:NaN,l)}function eo(t,r,l){(tt(t,"beforeSelectionChange")||t.cm&&tt(t.cm,"beforeSelectionChange"))&&(r=tg(t,r,l));var a=l&&l.bias||(k(r.primary().head,t.sel.primary().head)<0?-1:1);Qc(t,tu(t,r,a,!0)),!(l&&l.scroll===!1)&&t.cm&&t.cm.getOption("readOnly")!="nocursor"&&Yi(t.cm)}function Qc(t,r){r.equals(t.sel)||(t.sel=r,t.cm&&(t.cm.curOp.updateInput=1,t.cm.curOp.selectionChanged=!0,Yt(t.cm)),kt(t,"cursorActivity",t))}function eu(t){Qc(t,tu(t,t.sel,null,!1))}function tu(t,r,l,a){for(var u,d=0;d<r.ranges.length;d++){var m=r.ranges[d],y=r.ranges.length==t.sel.ranges.length&&t.sel.ranges[d],x=to(t,m.anchor,y&&y.anchor,l,a),w=to(t,m.head,y&&y.head,l,a);(u||x!=m.anchor||w!=m.head)&&(u||(u=r.ranges.slice(0,d)),u[d]=new Qe(x,w))}return u?wn(t.cm,u,r.primIndex):r}function Qi(t,r,l,a,u){var d=Ce(t,r.line);if(d.markedSpans)for(var m=0;m<d.markedSpans.length;++m){var y=d.markedSpans[m],x=y.marker,w="selectLeft"in x?!x.selectLeft:x.inclusiveLeft,M="selectRight"in x?!x.selectRight:x.inclusiveRight;if((y.from==null||(w?y.from<=r.ch:y.from<r.ch))&&(y.to==null||(M?y.to>=r.ch:y.to>r.ch))){if(u&&(Me(x,"beforeCursorEnter"),x.explicitlyCleared))if(d.markedSpans){--m;continue}else break;if(!x.atomic)continue;if(l){var O=x.find(a<0?1:-1),W=void 0;if((a<0?M:w)&&(O=nu(t,O,-a,O&&O.line==r.line?d:null)),O&&O.line==r.line&&(W=k(O,l))&&(a<0?W<0:W>0))return Qi(t,O,r,a,u)}var H=x.find(a<0?-1:1);return(a<0?w:M)&&(H=nu(t,H,a,H.line==r.line?d:null)),H?Qi(t,H,r,a,u):null}}return r}function to(t,r,l,a,u){var d=a||1,m=Qi(t,r,l,d,u)||!u&&Qi(t,r,l,d,!0)||Qi(t,r,l,-d,u)||!u&&Qi(t,r,l,-d,!0);return m||(t.cantEdit=!0,le(t.first,0))}function nu(t,r,l,a){return l<0&&r.ch==0?r.line>t.first?ye(t,le(r.line-1)):null:l>0&&r.ch==(a||Ce(t,r.line)).text.length?r.line<t.first+t.size-1?le(r.line+1,0):null:new le(r.line,r.ch+l)}function iu(t){t.setSelection(le(t.firstLine(),0),le(t.lastLine()),Ie)}function ru(t,r,l){var a={canceled:!1,from:r.from,to:r.to,text:r.text,origin:r.origin,cancel:function(){return a.canceled=!0}};return l&&(a.update=function(u,d,m,y){u&&(a.from=ye(t,u)),d&&(a.to=ye(t,d)),m&&(a.text=m),y!==void 0&&(a.origin=y)}),Me(t,"beforeChange",t,a),t.cm&&Me(t.cm,"beforeChange",t.cm,a),a.canceled?(t.cm&&(t.cm.curOp.updateInput=2),null):{from:a.from,to:a.to,text:a.text,origin:a.origin}}function er(t,r,l){if(t.cm){if(!t.cm.curOp)return St(t.cm,er)(t,r,l);if(t.cm.state.suppressEdits)return}if(!((tt(t,"beforeChange")||t.cm&&tt(t.cm,"beforeChange"))&&(r=ru(t,r,!0),!r))){var a=ql&&!l&&Jd(t,r.from,r.to);if(a)for(var u=a.length-1;u>=0;--u)su(t,{from:a[u].from,to:a[u].to,text:u?[""]:r.text,origin:r.origin});else su(t,r)}}function su(t,r){if(!(r.text.length==1&&r.text[0]==""&&k(r.from,r.to)==0)){var l=Ca(t,r);Xc(t,r,l,t.cm?t.cm.curOp.id:NaN),Br(t,r,l,Jo(t,r));var a=[];oi(t,function(u,d){!d&&Z(a,u.history)==-1&&(cu(u.history,r),a.push(u.history)),Br(u,r,null,Jo(u,r))})}}function no(t,r,l){var a=t.cm&&t.cm.state.suppressEdits;if(!(a&&!l)){for(var u=t.history,d,m=t.sel,y=r=="undo"?u.done:u.undone,x=r=="undo"?u.undone:u.done,w=0;w<y.length&&(d=y[w],!(l?d.ranges&&!d.equals(t.sel):!d.ranges));w++);if(w!=y.length){for(u.lastOrigin=u.lastSelOrigin=null;;)if(d=y.pop(),d.ranges){if(Js(d,x),l&&!d.equals(t.sel)){Et(t,d,{clearRedo:!1});return}m=d}else if(a){y.push(d);return}else break;var M=[];Js(m,x),x.push({changes:M,generation:u.generation}),u.generation=d.generation||++u.maxGeneration;for(var O=tt(t,"beforeChange")||t.cm&&tt(t.cm,"beforeChange"),W=function(re){var ue=d.changes[re];if(ue.origin=r,O&&!ru(t,ue,!1))return y.length=0,{};M.push(Na(t,ue));var de=re?Ca(t,ue):V(y);Br(t,ue,de,qc(t,ue)),!re&&t.cm&&t.cm.scrollIntoView({from:ue.from,to:si(ue)});var ve=[];oi(t,function(pe,we){!we&&Z(ve,pe.history)==-1&&(cu(pe.history,ue),ve.push(pe.history)),Br(pe,ue,null,qc(pe,ue))})},H=d.changes.length-1;H>=0;--H){var q=W(H);if(q)return q.v}}}}function ou(t,r){if(r!=0&&(t.first+=r,t.sel=new cn(me(t.sel.ranges,function(u){return new Qe(le(u.anchor.line+r,u.anchor.ch),le(u.head.line+r,u.head.ch))}),t.sel.primIndex),t.cm)){Vt(t.cm,t.first,t.first-r,r);for(var l=t.cm.display,a=l.viewFrom;a<l.viewTo;a++)ni(t.cm,a,"gutter")}}function Br(t,r,l,a){if(t.cm&&!t.cm.curOp)return St(t.cm,Br)(t,r,l,a);if(r.to.line<t.first){ou(t,r.text.length-1-(r.to.line-r.from.line));return}if(!(r.from.line>t.lastLine())){if(r.from.line<t.first){var u=r.text.length-1-(t.first-r.from.line);ou(t,u),r={from:le(t.first,0),to:le(r.to.line+u,r.to.ch),text:[V(r.text)],origin:r.origin}}var d=t.lastLine();r.to.line>d&&(r={from:r.from,to:le(d,Ce(t,d).text.length),text:[r.text[0]],origin:r.origin}),r.removed=Tn(t,r.from,r.to),l||(l=Ca(t,r)),t.cm?ng(t.cm,r,a):La(t,r,a),eo(t,l,Ie),t.cantEdit&&to(t,le(t.firstLine(),0))&&(t.cantEdit=!1)}}function ng(t,r,l){var a=t.doc,u=t.display,d=r.from,m=r.to,y=!1,x=d.line;t.options.lineWrapping||(x=Je(xn(Ce(a,d.line))),a.iter(x,m.line+1,function(H){if(H==u.maxLine)return y=!0,!0})),a.sel.contains(r.from,r.to)>-1&&Yt(t),La(a,r,l,Cc(t)),t.options.lineWrapping||(a.iter(x,d.line+r.text.length,function(H){var q=zs(H);q>u.maxLineLength&&(u.maxLine=H,u.maxLineLength=q,u.maxLineChanged=!0,y=!1)}),y&&(t.curOp.updateMaxLine=!0)),Vd(a,d.line),Hr(t,400);var w=r.text.length-(m.line-d.line)-1;r.full?Vt(t):d.line==m.line&&r.text.length==1&&!$c(t.doc,r)?ni(t,d.line,"text"):Vt(t,d.line,m.line+1,w);var M=tt(t,"changes"),O=tt(t,"change");if(O||M){var W={from:d,to:m,text:r.text,removed:r.removed,origin:r.origin};O&&kt(t,"change",t,W),M&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(W)}t.display.selForContextMenu=null}function tr(t,r,l,a,u){var d;a||(a=l),k(a,l)<0&&(d=[a,l],l=d[0],a=d[1]),typeof r=="string"&&(r=t.splitLines(r)),er(t,{from:l,to:a,text:r,origin:u})}function au(t,r,l,a){l<t.line?t.line+=a:r<t.line&&(t.line=r,t.ch=0)}function lu(t,r,l,a){for(var u=0;u<t.length;++u){var d=t[u],m=!0;if(d.ranges){d.copied||(d=t[u]=d.deepCopy(),d.copied=!0);for(var y=0;y<d.ranges.length;y++)au(d.ranges[y].anchor,r,l,a),au(d.ranges[y].head,r,l,a);continue}for(var x=0;x<d.changes.length;++x){var w=d.changes[x];if(l<w.from.line)w.from=le(w.from.line+a,w.from.ch),w.to=le(w.to.line+a,w.to.ch);else if(r<=w.to.line){m=!1;break}}m||(t.splice(0,u+1),u=0)}}function cu(t,r){var l=r.from.line,a=r.to.line,u=r.text.length-(a-l)-1;lu(t.done,l,a,u),lu(t.undone,l,a,u)}function Ur(t,r,l,a){var u=r,d=r;return typeof r=="number"?d=Ce(t,qe(t,r)):u=Je(r),u==null?null:(a(d,u)&&t.cm&&ni(t.cm,u,l),d)}function $r(t){this.lines=t,this.parent=null;for(var r=0,l=0;l<t.length;++l)t[l].parent=this,r+=t[l].height;this.height=r}$r.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,r){for(var l=t,a=t+r;l<a;++l){var u=this.lines[l];this.height-=u.height,ip(u),kt(u,"delete")}this.lines.splice(t,r)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,r,l){this.height+=l,this.lines=this.lines.slice(0,t).concat(r).concat(this.lines.slice(t));for(var a=0;a<r.length;++a)r[a].parent=this},iterN:function(t,r,l){for(var a=t+r;t<a;++t)if(l(this.lines[t]))return!0}};function jr(t){this.children=t;for(var r=0,l=0,a=0;a<t.length;++a){var u=t[a];r+=u.chunkSize(),l+=u.height,u.parent=this}this.size=r,this.height=l,this.parent=null}jr.prototype={chunkSize:function(){return this.size},removeInner:function(t,r){this.size-=r;for(var l=0;l<this.children.length;++l){var a=this.children[l],u=a.chunkSize();if(t<u){var d=Math.min(r,u-t),m=a.height;if(a.removeInner(t,d),this.height-=m-a.height,u==d&&(this.children.splice(l--,1),a.parent=null),(r-=d)==0)break;t=0}else t-=u}if(this.size-r<25&&(this.children.length>1||!(this.children[0]instanceof $r))){var y=[];this.collapse(y),this.children=[new $r(y)],this.children[0].parent=this}},collapse:function(t){for(var r=0;r<this.children.length;++r)this.children[r].collapse(t)},insertInner:function(t,r,l){this.size+=r.length,this.height+=l;for(var a=0;a<this.children.length;++a){var u=this.children[a],d=u.chunkSize();if(t<=d){if(u.insertInner(t,r,l),u.lines&&u.lines.length>50){for(var m=u.lines.length%25+25,y=m;y<u.lines.length;){var x=new $r(u.lines.slice(y,y+=25));u.height-=x.height,this.children.splice(++a,0,x),x.parent=this}u.lines=u.lines.slice(0,m),this.maybeSpill()}break}t-=d}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var r=t.children.splice(t.children.length-5,5),l=new jr(r);if(t.parent){t.size-=l.size,t.height-=l.height;var u=Z(t.parent.children,t);t.parent.children.splice(u+1,0,l)}else{var a=new jr(t.children);a.parent=t,t.children=[a,l],t=a}l.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,r,l){for(var a=0;a<this.children.length;++a){var u=this.children[a],d=u.chunkSize();if(t<d){var m=Math.min(r,d-t);if(u.iterN(t,m,l))return!0;if((r-=m)==0)break;t=0}else t-=d}}};var Vr=function(t,r,l){if(l)for(var a in l)l.hasOwnProperty(a)&&(this[a]=l[a]);this.doc=t,this.node=r};Vr.prototype.clear=function(){var t=this.doc.cm,r=this.line.widgets,l=this.line,a=Je(l);if(!(a==null||!r)){for(var u=0;u<r.length;++u)r[u]==this&&r.splice(u--,1);r.length||(l.widgets=null);var d=Pr(this);Zt(l,Math.max(0,l.height-d)),t&&(Jt(t,function(){uu(t,l,-d),ni(t,a,"widget")}),kt(t,"lineWidgetCleared",t,this,a))}},Vr.prototype.changed=function(){var t=this,r=this.height,l=this.doc.cm,a=this.line;this.height=null;var u=Pr(this)-r;u&&(ti(this.doc,a)||Zt(a,a.height+u),l&&Jt(l,function(){l.curOp.forceUpdate=!0,uu(l,a,u),kt(l,"lineWidgetChanged",l,t,Je(a))}))},rn(Vr);function uu(t,r,l){Wn(r)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&ba(t,l)}function ig(t,r,l,a){var u=new Vr(t,l,a),d=t.cm;return d&&u.noHScroll&&(d.display.alignWidgets=!0),Ur(t,r,"widget",function(m){var y=m.widgets||(m.widgets=[]);if(u.insertAt==null?y.push(u):y.splice(Math.min(y.length,Math.max(0,u.insertAt)),0,u),u.line=m,d&&!ti(t,m)){var x=Wn(m)<t.scrollTop;Zt(m,m.height+Pr(u)),x&&ba(d,u.height),d.curOp.forceUpdate=!0}return!0}),d&&kt(d,"lineWidgetAdded",d,u,typeof r=="number"?r:Je(r)),u}var fu=0,ai=function(t,r){this.lines=[],this.type=r,this.doc=t,this.id=++fu};ai.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,r=t&&!t.curOp;if(r&&Si(t),tt(this,"clear")){var l=this.find();l&&kt(this,"clear",l.from,l.to)}for(var a=null,u=null,d=0;d<this.lines.length;++d){var m=this.lines[d],y=Nr(m.markedSpans,this);t&&!this.collapsed?ni(t,Je(m),"text"):t&&(y.to!=null&&(u=Je(m)),y.from!=null&&(a=Je(m))),m.markedSpans=Gd(m.markedSpans,y),y.from==null&&this.collapsed&&!ti(this.doc,m)&&t&&Zt(m,Xi(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var x=0;x<this.lines.length;++x){var w=xn(this.lines[x]),M=zs(w);M>t.display.maxLineLength&&(t.display.maxLine=w,t.display.maxLineLength=M,t.display.maxLineChanged=!0)}a!=null&&t&&this.collapsed&&Vt(t,a,u+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&eu(t.doc)),t&&kt(t,"markerCleared",t,this,a,u),r&&Ci(t),this.parent&&this.parent.clear()}},ai.prototype.find=function(t,r){t==null&&this.type=="bookmark"&&(t=1);for(var l,a,u=0;u<this.lines.length;++u){var d=this.lines[u],m=Nr(d.markedSpans,this);if(m.from!=null&&(l=le(r?d:Je(d),m.from),t==-1))return l;if(m.to!=null&&(a=le(r?d:Je(d),m.to),t==1))return a}return l&&{from:l,to:a}},ai.prototype.changed=function(){var t=this,r=this.find(-1,!0),l=this,a=this.doc.cm;!r||!a||Jt(a,function(){var u=r.line,d=Je(r.line),m=oa(a,d);if(m&&(vc(m),a.curOp.selectionChanged=a.curOp.forceUpdate=!0),a.curOp.updateMaxLine=!0,!ti(l.doc,u)&&l.height!=null){var y=l.height;l.height=null;var x=Pr(l)-y;x&&Zt(u,u.height+x)}kt(a,"markerChanged",a,t)})},ai.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;(!r.maybeHiddenMarkers||Z(r.maybeHiddenMarkers,this)==-1)&&(r.maybeUnhiddenMarkers||(r.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},ai.prototype.detachLine=function(t){if(this.lines.splice(Z(this.lines,t),1),!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;(r.maybeHiddenMarkers||(r.maybeHiddenMarkers=[])).push(this)}},rn(ai);function nr(t,r,l,a,u){if(a&&a.shared)return rg(t,r,l,a,u);if(t.cm&&!t.cm.curOp)return St(t.cm,nr)(t,r,l,a,u);var d=new ai(t,u),m=k(r,l);if(a&&Ne(a,d,!1),m>0||m==0&&d.clearWhenEmpty!==!1)return d;if(d.replacedWith&&(d.collapsed=!0,d.widgetNode=S("span",[d.replacedWith],"CodeMirror-widget"),a.handleMouseEvents||d.widgetNode.setAttribute("cm-ignore-events","true"),a.insertLeft&&(d.widgetNode.insertLeft=!0)),d.collapsed){if(tc(t,r.line,r,l,d)||r.line!=l.line&&tc(t,l.line,r,l,d))throw new Error("Inserting collapsed marker partially overlapping an existing one");Xd()}d.addToHistory&&Xc(t,{from:r,to:l,origin:"markText"},t.sel,NaN);var y=r.line,x=t.cm,w;if(t.iter(y,l.line+1,function(O){x&&d.collapsed&&!x.options.lineWrapping&&xn(O)==x.display.maxLine&&(w=!0),d.collapsed&&y!=r.line&&Zt(O,0),qd(O,new Es(d,y==r.line?r.ch:null,y==l.line?l.ch:null),t.cm&&t.cm.curOp),++y}),d.collapsed&&t.iter(r.line,l.line+1,function(O){ti(t,O)&&Zt(O,0)}),d.clearOnEnter&&ne(d,"beforeCursorEnter",function(){return d.clear()}),d.readOnly&&(Kd(),(t.history.done.length||t.history.undone.length)&&t.clearHistory()),d.collapsed&&(d.id=++fu,d.atomic=!0),x){if(w&&(x.curOp.updateMaxLine=!0),d.collapsed)Vt(x,r.line,l.line+1);else if(d.className||d.startStyle||d.endStyle||d.css||d.attributes||d.title)for(var M=r.line;M<=l.line;M++)ni(x,M,"text");d.atomic&&eu(x.doc),kt(x,"markerAdded",x,d)}return d}var Kr=function(t,r){this.markers=t,this.primary=r;for(var l=0;l<t.length;++l)t[l].parent=this};Kr.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();kt(this,"clear")}},Kr.prototype.find=function(t,r){return this.primary.find(t,r)},rn(Kr);function rg(t,r,l,a,u){a=Ne(a),a.shared=!1;var d=[nr(t,r,l,a,u)],m=d[0],y=a.widgetNode;return oi(t,function(x){y&&(a.widgetNode=y.cloneNode(!0)),d.push(nr(x,ye(x,r),ye(x,l),a,u));for(var w=0;w<x.linked.length;++w)if(x.linked[w].isParent)return;m=V(d)}),new Kr(d,m)}function hu(t){return t.findMarks(le(t.first,0),t.clipPos(le(t.lastLine())),function(r){return r.parent})}function sg(t,r){for(var l=0;l<r.length;l++){var a=r[l],u=a.find(),d=t.clipPos(u.from),m=t.clipPos(u.to);if(k(d,m)){var y=nr(t,d,m,a.primary,a.primary.type);a.markers.push(y),y.parent=a}}}function og(t){for(var r=function(a){var u=t[a],d=[u.primary.doc];oi(u.primary.doc,function(x){return d.push(x)});for(var m=0;m<u.markers.length;m++){var y=u.markers[m];Z(d,y.doc)==-1&&(y.parent=null,u.markers.splice(m--,1))}},l=0;l<t.length;l++)r(l)}var ag=0,Kt=function(t,r,l,a,u){if(!(this instanceof Kt))return new Kt(t,r,l,a,u);l==null&&(l=0),jr.call(this,[new $r([new ji("",null)])]),this.first=l,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=l;var d=le(l,0);this.sel=ri(d),this.history=new Zs(null),this.id=++ag,this.modeOption=r,this.lineSep=a,this.direction=u=="rtl"?"rtl":"ltr",this.extend=!1,typeof t=="string"&&(t=this.splitLines(t)),La(this,{from:d,to:d,text:t}),Et(this,ri(d),Ie)};Kt.prototype=Ge(jr.prototype,{constructor:Kt,iter:function(t,r,l){l?this.iterN(t-this.first,r-t,l):this.iterN(this.first,this.first+this.size,t)},insert:function(t,r){for(var l=0,a=0;a<r.length;++a)l+=r[a].height;this.insertInner(t-this.first,r,l)},remove:function(t,r){this.removeInner(t-this.first,r)},getValue:function(t){var r=Cr(this,this.first,this.first+this.size);return t===!1?r:r.join(t||this.lineSeparator())},setValue:Ct(function(t){var r=le(this.first,0),l=this.first+this.size-1;er(this,{from:r,to:le(l,Ce(this,l).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),this.cm&&Ir(this.cm,0,0),Et(this,ri(r),Ie)}),replaceRange:function(t,r,l,a){r=ye(this,r),l=l?ye(this,l):r,tr(this,t,r,l,a)},getRange:function(t,r,l){var a=Tn(this,ye(this,t),ye(this,r));return l===!1?a:l===""?a.join(""):a.join(l||this.lineSeparator())},getLine:function(t){var r=this.getLineHandle(t);return r&&r.text},getLineHandle:function(t){if(vi(this,t))return Ce(this,t)},getLineNumber:function(t){return Je(t)},getLineHandleVisualStart:function(t){return typeof t=="number"&&(t=Ce(this,t)),xn(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return ye(this,t)},getCursor:function(t){var r=this.sel.primary(),l;return t==null||t=="head"?l=r.head:t=="anchor"?l=r.anchor:t=="end"||t=="to"||t===!1?l=r.to():l=r.from(),l},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Ct(function(t,r,l){Zc(this,ye(this,typeof t=="number"?le(t,r||0):t),null,l)}),setSelection:Ct(function(t,r,l){Zc(this,ye(this,t),ye(this,r||t),l)}),extendSelection:Ct(function(t,r,l){Qs(this,ye(this,t),r&&ye(this,r),l)}),extendSelections:Ct(function(t,r){Yc(this,ln(this,t),r)}),extendSelectionsBy:Ct(function(t,r){var l=me(this.sel.ranges,t);Yc(this,ln(this,l),r)}),setSelections:Ct(function(t,r,l){if(t.length){for(var a=[],u=0;u<t.length;u++)a[u]=new Qe(ye(this,t[u].anchor),ye(this,t[u].head||t[u].anchor));r==null&&(r=Math.min(t.length-1,this.sel.primIndex)),Et(this,wn(this.cm,a,r),l)}}),addSelection:Ct(function(t,r,l){var a=this.sel.ranges.slice(0);a.push(new Qe(ye(this,t),ye(this,r||t))),Et(this,wn(this.cm,a,a.length-1),l)}),getSelection:function(t){for(var r=this.sel.ranges,l,a=0;a<r.length;a++){var u=Tn(this,r[a].from(),r[a].to());l=l?l.concat(u):u}return t===!1?l:l.join(t||this.lineSeparator())},getSelections:function(t){for(var r=[],l=this.sel.ranges,a=0;a<l.length;a++){var u=Tn(this,l[a].from(),l[a].to());t!==!1&&(u=u.join(t||this.lineSeparator())),r[a]=u}return r},replaceSelection:function(t,r,l){for(var a=[],u=0;u<this.sel.ranges.length;u++)a[u]=t;this.replaceSelections(a,r,l||"+input")},replaceSelections:Ct(function(t,r,l){for(var a=[],u=this.sel,d=0;d<u.ranges.length;d++){var m=u.ranges[d];a[d]={from:m.from(),to:m.to(),text:this.splitLines(t[d]),origin:l}}for(var y=r&&r!="end"&&Gp(this,a,r),x=a.length-1;x>=0;x--)er(this,a[x]);y?Jc(this,y):this.cm&&Yi(this.cm)}),undo:Ct(function(){no(this,"undo")}),redo:Ct(function(){no(this,"redo")}),undoSelection:Ct(function(){no(this,"undo",!0)}),redoSelection:Ct(function(){no(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,r=0,l=0,a=0;a<t.done.length;a++)t.done[a].ranges||++r;for(var u=0;u<t.undone.length;u++)t.undone[u].ranges||++l;return{undo:r,redo:l}},clearHistory:function(){var t=this;this.history=new Zs(this.history),oi(this,function(r){return r.history=t.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:Ji(this.history.done),undone:Ji(this.history.undone)}},setHistory:function(t){var r=this.history=new Zs(this.history);r.done=Ji(t.done.slice(0),null,!0),r.undone=Ji(t.undone.slice(0),null,!0)},setGutterMarker:Ct(function(t,r,l){return Ur(this,t,"gutter",function(a){var u=a.gutterMarkers||(a.gutterMarkers={});return u[r]=l,!l&&Ht(u)&&(a.gutterMarkers=null),!0})}),clearGutter:Ct(function(t){var r=this;this.iter(function(l){l.gutterMarkers&&l.gutterMarkers[t]&&Ur(r,l,"gutter",function(){return l.gutterMarkers[t]=null,Ht(l.gutterMarkers)&&(l.gutterMarkers=null),!0})})}),lineInfo:function(t){var r;if(typeof t=="number"){if(!vi(this,t)||(r=t,t=Ce(this,t),!t))return null}else if(r=Je(t),r==null)return null;return{line:r,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:Ct(function(t,r,l){return Ur(this,t,r=="gutter"?"gutter":"class",function(a){var u=r=="text"?"textClass":r=="background"?"bgClass":r=="gutter"?"gutterClass":"wrapClass";if(!a[u])a[u]=l;else{if(fe(l).test(a[u]))return!1;a[u]+=" "+l}return!0})}),removeLineClass:Ct(function(t,r,l){return Ur(this,t,r=="gutter"?"gutter":"class",function(a){var u=r=="text"?"textClass":r=="background"?"bgClass":r=="gutter"?"gutterClass":"wrapClass",d=a[u];if(d)if(l==null)a[u]=null;else{var m=d.match(fe(l));if(!m)return!1;var y=m.index+m[0].length;a[u]=d.slice(0,m.index)+(!m.index||y==d.length?"":" ")+d.slice(y)||null}else return!1;return!0})}),addLineWidget:Ct(function(t,r,l){return ig(this,t,r,l)}),removeLineWidget:function(t){t.clear()},markText:function(t,r,l){return nr(this,ye(this,t),ye(this,r),l,l&&l.type||"range")},setBookmark:function(t,r){var l={replacedWith:r&&(r.nodeType==null?r.widget:r),insertLeft:r&&r.insertLeft,clearWhenEmpty:!1,shared:r&&r.shared,handleMouseEvents:r&&r.handleMouseEvents};return t=ye(this,t),nr(this,t,t,l,"bookmark")},findMarksAt:function(t){t=ye(this,t);var r=[],l=Ce(this,t.line).markedSpans;if(l)for(var a=0;a<l.length;++a){var u=l[a];(u.from==null||u.from<=t.ch)&&(u.to==null||u.to>=t.ch)&&r.push(u.marker.parent||u.marker)}return r},findMarks:function(t,r,l){t=ye(this,t),r=ye(this,r);var a=[],u=t.line;return this.iter(t.line,r.line+1,function(d){var m=d.markedSpans;if(m)for(var y=0;y<m.length;y++){var x=m[y];!(x.to!=null&&u==t.line&&t.ch>=x.to||x.from==null&&u!=t.line||x.from!=null&&u==r.line&&x.from>=r.ch)&&(!l||l(x.marker))&&a.push(x.marker.parent||x.marker)}++u}),a},getAllMarks:function(){var t=[];return this.iter(function(r){var l=r.markedSpans;if(l)for(var a=0;a<l.length;++a)l[a].from!=null&&t.push(l[a].marker)}),t},posFromIndex:function(t){var r,l=this.first,a=this.lineSeparator().length;return this.iter(function(u){var d=u.text.length+a;if(d>t)return r=t,!0;t-=d,++l}),ye(this,le(l,r))},indexFromPos:function(t){t=ye(this,t);var r=t.ch;if(t.line<this.first||t.ch<0)return 0;var l=this.lineSeparator().length;return this.iter(this.first,t.line,function(a){r+=a.text.length+l}),r},copy:function(t){var r=new Kt(Cr(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return r.scrollTop=this.scrollTop,r.scrollLeft=this.scrollLeft,r.sel=this.sel,r.extend=!1,t&&(r.history.undoDepth=this.history.undoDepth,r.setHistory(this.getHistory())),r},linkedDoc:function(t){t||(t={});var r=this.first,l=this.first+this.size;t.from!=null&&t.from>r&&(r=t.from),t.to!=null&&t.to<l&&(l=t.to);var a=new Kt(Cr(this,r,l),t.mode||this.modeOption,r,this.lineSep,this.direction);return t.sharedHist&&(a.history=this.history),(this.linked||(this.linked=[])).push({doc:a,sharedHist:t.sharedHist}),a.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],sg(a,hu(this)),a},unlinkDoc:function(t){if(t instanceof lt&&(t=t.doc),this.linked)for(var r=0;r<this.linked.length;++r){var l=this.linked[r];if(l.doc==t){this.linked.splice(r,1),t.unlinkDoc(this),og(hu(this));break}}if(t.history==this.history){var a=[t.id];oi(t,function(u){return a.push(u.id)},!0),t.history=new Zs(null),t.history.done=Ji(this.history.done,a),t.history.undone=Ji(this.history.undone,a)}},iterLinkedDocs:function(t){oi(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):_r(t)},lineSeparator:function(){return this.lineSep||`
`},setDirection:Ct(function(t){t!="rtl"&&(t="ltr"),t!=this.direction&&(this.direction=t,this.iter(function(r){return r.order=null}),this.cm&&qp(this.cm))})}),Kt.prototype.eachLine=Kt.prototype.iter;var du=0;function lg(t){var r=this;if(pu(r),!(ot(r,t)||Bn(r.display,t))){At(t),p&&(du=+new Date);var l=xi(r,t,!0),a=t.dataTransfer.files;if(!(!l||r.isReadOnly()))if(a&&a.length&&window.FileReader&&window.File)for(var u=a.length,d=Array(u),m=0,y=function(){++m==u&&St(r,function(){l=ye(r.doc,l);var H={from:l,to:l,text:r.doc.splitLines(d.filter(function(q){return q!=null}).join(r.doc.lineSeparator())),origin:"paste"};er(r.doc,H),Jc(r.doc,ri(ye(r.doc,l),ye(r.doc,si(H))))})()},x=function(H,q){if(r.options.allowDropFileTypes&&Z(r.options.allowDropFileTypes,H.type)==-1){y();return}var re=new FileReader;re.onerror=function(){return y()},re.onload=function(){var ue=re.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(ue)){y();return}d[q]=ue,y()},re.readAsText(H)},w=0;w<a.length;w++)x(a[w],w);else{if(r.state.draggingText&&r.doc.sel.contains(l)>-1){r.state.draggingText(t),setTimeout(function(){return r.display.input.focus()},20);return}try{var M=t.dataTransfer.getData("Text");if(M){var O;if(r.state.draggingText&&!r.state.draggingText.copy&&(O=r.listSelections()),eo(r.doc,ri(l,l)),O)for(var W=0;W<O.length;++W)tr(r.doc,"",O[W].anchor,O[W].head,"drag");r.replaceSelection(M,"around","paste"),r.display.input.focus()}}catch{}}}}function cg(t,r){if(p&&(!t.state.draggingText||+new Date-du<100)){mi(r);return}if(!(ot(t,r)||Bn(t.display,r))&&(r.dataTransfer.setData("Text",t.getSelection()),r.dataTransfer.effectAllowed="copyMove",r.dataTransfer.setDragImage&&!D)){var l=F("img",null,null,"position: fixed; left: 0; top: 0;");l.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",L&&(l.width=l.height=1,t.display.wrapper.appendChild(l),l._top=l.offsetTop),r.dataTransfer.setDragImage(l,0,0),L&&l.parentNode.removeChild(l)}}function ug(t,r){var l=xi(t,r);if(l){var a=document.createDocumentFragment();pa(t,l,a),t.display.dragCursor||(t.display.dragCursor=F("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),R(t.display.dragCursor,a)}}function pu(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function gu(t){if(document.getElementsByClassName){for(var r=document.getElementsByClassName("CodeMirror"),l=[],a=0;a<r.length;a++){var u=r[a].CodeMirror;u&&l.push(u)}l.length&&l[0].operation(function(){for(var d=0;d<l.length;d++)t(l[d])})}}var mu=!1;function fg(){mu||(hg(),mu=!0)}function hg(){var t;ne(window,"resize",function(){t==null&&(t=setTimeout(function(){t=null,gu(dg)},100))}),ne(window,"blur",function(){return gu(qi)})}function dg(t){var r=t.display;r.cachedCharWidth=r.cachedTextHeight=r.cachedPaddingH=null,r.scrollbarsClipped=!1,t.setSize()}for(var li={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Xr=0;Xr<10;Xr++)li[Xr+48]=li[Xr+96]=String(Xr);for(var io=65;io<=90;io++)li[io]=String.fromCharCode(io);for(var Gr=1;Gr<=12;Gr++)li[Gr+111]=li[Gr+63235]="F"+Gr;var $n={};$n.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},$n.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},$n.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},$n.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},$n.default=X?$n.macDefault:$n.pcDefault;function pg(t){var r=t.split(/-(?!$)/);t=r[r.length-1];for(var l,a,u,d,m=0;m<r.length-1;m++){var y=r[m];if(/^(cmd|meta|m)$/i.test(y))d=!0;else if(/^a(lt)?$/i.test(y))l=!0;else if(/^(c|ctrl|control)$/i.test(y))a=!0;else if(/^s(hift)?$/i.test(y))u=!0;else throw new Error("Unrecognized modifier name: "+y)}return l&&(t="Alt-"+t),a&&(t="Ctrl-"+t),d&&(t="Cmd-"+t),u&&(t="Shift-"+t),t}function gg(t){var r={};for(var l in t)if(t.hasOwnProperty(l)){var a=t[l];if(/^(name|fallthrough|(de|at)tach)$/.test(l))continue;if(a=="..."){delete t[l];continue}for(var u=me(l.split(" "),pg),d=0;d<u.length;d++){var m=void 0,y=void 0;d==u.length-1?(y=u.join(" "),m=a):(y=u.slice(0,d+1).join(" "),m="...");var x=r[y];if(!x)r[y]=m;else if(x!=m)throw new Error("Inconsistent bindings for "+y)}delete t[l]}for(var w in r)t[w]=r[w];return t}function ir(t,r,l,a){r=ro(r);var u=r.call?r.call(t,a):r[t];if(u===!1)return"nothing";if(u==="...")return"multi";if(u!=null&&l(u))return"handled";if(r.fallthrough){if(Object.prototype.toString.call(r.fallthrough)!="[object Array]")return ir(t,r.fallthrough,l,a);for(var d=0;d<r.fallthrough.length;d++){var m=ir(t,r.fallthrough[d],l,a);if(m)return m}}}function vu(t){var r=typeof t=="string"?t:li[t.keyCode];return r=="Ctrl"||r=="Alt"||r=="Shift"||r=="Mod"}function yu(t,r,l){var a=t;return r.altKey&&a!="Alt"&&(t="Alt-"+t),(Q?r.metaKey:r.ctrlKey)&&a!="Ctrl"&&(t="Ctrl-"+t),(Q?r.ctrlKey:r.metaKey)&&a!="Mod"&&(t="Cmd-"+t),!l&&r.shiftKey&&a!="Shift"&&(t="Shift-"+t),t}function bu(t,r){if(L&&t.keyCode==34&&t.char)return!1;var l=li[t.keyCode];return l==null||t.altGraphKey?!1:(t.keyCode==3&&t.code&&(l=t.code),yu(l,t,r))}function ro(t){return typeof t=="string"?$n[t]:t}function rr(t,r){for(var l=t.doc.sel.ranges,a=[],u=0;u<l.length;u++){for(var d=r(l[u]);a.length&&k(d.from,V(a).to)<=0;){var m=a.pop();if(k(m.from,d.from)<0){d.from=m.from;break}}a.push(d)}Jt(t,function(){for(var y=a.length-1;y>=0;y--)tr(t.doc,"",a[y].from,a[y].to,"+delete");Yi(t)})}function Pa(t,r,l){var a=un(t.text,r+l,l);return a<0||a>t.text.length?null:a}function Oa(t,r,l){var a=Pa(t,r.ch,l);return a==null?null:new le(r.line,a,l<0?"after":"before")}function Aa(t,r,l,a,u){if(t){r.doc.direction=="rtl"&&(u=-u);var d=J(l,r.doc.direction);if(d){var m=u<0?V(d):d[0],y=u<0==(m.level==1),x=y?"after":"before",w;if(m.level>0||r.doc.direction=="rtl"){var M=Ki(r,l);w=u<0?l.text.length-1:0;var O=Dn(r,M,w).top;w=C(function(W){return Dn(r,M,W).top==O},u<0==(m.level==1)?m.from:m.to-1,w),x=="before"&&(w=Pa(l,w,1))}else w=u<0?m.to:m.from;return new le(a,w,x)}}return new le(a,u<0?l.text.length:0,u<0?"before":"after")}function mg(t,r,l,a){var u=J(r,t.doc.direction);if(!u)return Oa(r,l,a);l.ch>=r.text.length?(l.ch=r.text.length,l.sticky="before"):l.ch<=0&&(l.ch=0,l.sticky="after");var d=te(u,l.ch,l.sticky),m=u[d];if(t.doc.direction=="ltr"&&m.level%2==0&&(a>0?m.to>l.ch:m.from<l.ch))return Oa(r,l,a);var y=function(de,ve){return Pa(r,de instanceof le?de.ch:de,ve)},x,w=function(de){return t.options.lineWrapping?(x=x||Ki(t,r),Sc(t,r,x,de)):{begin:0,end:r.text.length}},M=w(l.sticky=="before"?y(l,-1):l.ch);if(t.doc.direction=="rtl"||m.level==1){var O=m.level==1==a<0,W=y(l,O?1:-1);if(W!=null&&(O?W<=m.to&&W<=M.end:W>=m.from&&W>=M.begin)){var H=O?"before":"after";return new le(l.line,W,H)}}var q=function(de,ve,pe){for(var we=function(st,Tt){return Tt?new le(l.line,y(st,1),"before"):new le(l.line,st,"after")};de>=0&&de<u.length;de+=ve){var Pe=u[de],De=ve>0==(Pe.level!=1),Be=De?pe.begin:y(pe.end,-1);if(Pe.from<=Be&&Be<Pe.to||(Be=De?Pe.from:y(Pe.to,-1),pe.begin<=Be&&Be<pe.end))return we(Be,De)}},re=q(d+a,a,M);if(re)return re;var ue=a>0?M.end:y(M.begin,-1);return ue!=null&&!(a>0&&ue==r.text.length)&&(re=q(a>0?0:u.length-1,a,w(ue)),re)?re:null}var qr={selectAll:iu,singleSelection:function(t){return t.setSelection(t.getCursor("anchor"),t.getCursor("head"),Ie)},killLine:function(t){return rr(t,function(r){if(r.empty()){var l=Ce(t.doc,r.head.line).text.length;return r.head.ch==l&&r.head.line<t.lastLine()?{from:r.head,to:le(r.head.line+1,0)}:{from:r.head,to:le(r.head.line,l)}}else return{from:r.from(),to:r.to()}})},deleteLine:function(t){return rr(t,function(r){return{from:le(r.from().line,0),to:ye(t.doc,le(r.to().line+1,0))}})},delLineLeft:function(t){return rr(t,function(r){return{from:le(r.from().line,0),to:r.from()}})},delWrappedLineLeft:function(t){return rr(t,function(r){var l=t.charCoords(r.head,"div").top+5,a=t.coordsChar({left:0,top:l},"div");return{from:a,to:r.from()}})},delWrappedLineRight:function(t){return rr(t,function(r){var l=t.charCoords(r.head,"div").top+5,a=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:l},"div");return{from:r.from(),to:a}})},undo:function(t){return t.undo()},redo:function(t){return t.redo()},undoSelection:function(t){return t.undoSelection()},redoSelection:function(t){return t.redoSelection()},goDocStart:function(t){return t.extendSelection(le(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(le(t.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(r){return xu(t,r.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(r){return _u(t,r.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(r){return vg(t,r.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(r){var l=t.cursorCoords(r.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:l},"div")},He)},goLineLeft:function(t){return t.extendSelectionsBy(function(r){var l=t.cursorCoords(r.head,"div").top+5;return t.coordsChar({left:0,top:l},"div")},He)},goLineLeftSmart:function(t){return t.extendSelectionsBy(function(r){var l=t.cursorCoords(r.head,"div").top+5,a=t.coordsChar({left:0,top:l},"div");return a.ch<t.getLine(a.line).search(/\S/)?_u(t,r.head):a},He)},goLineUp:function(t){return t.moveV(-1,"line")},goLineDown:function(t){return t.moveV(1,"line")},goPageUp:function(t){return t.moveV(-1,"page")},goPageDown:function(t){return t.moveV(1,"page")},goCharLeft:function(t){return t.moveH(-1,"char")},goCharRight:function(t){return t.moveH(1,"char")},goColumnLeft:function(t){return t.moveH(-1,"column")},goColumnRight:function(t){return t.moveH(1,"column")},goWordLeft:function(t){return t.moveH(-1,"word")},goGroupRight:function(t){return t.moveH(1,"group")},goGroupLeft:function(t){return t.moveH(-1,"group")},goWordRight:function(t){return t.moveH(1,"word")},delCharBefore:function(t){return t.deleteH(-1,"codepoint")},delCharAfter:function(t){return t.deleteH(1,"char")},delWordBefore:function(t){return t.deleteH(-1,"word")},delWordAfter:function(t){return t.deleteH(1,"word")},delGroupBefore:function(t){return t.deleteH(-1,"group")},delGroupAfter:function(t){return t.deleteH(1,"group")},indentAuto:function(t){return t.indentSelection("smart")},indentMore:function(t){return t.indentSelection("add")},indentLess:function(t){return t.indentSelection("subtract")},insertTab:function(t){return t.replaceSelection("	")},insertSoftTab:function(t){for(var r=[],l=t.listSelections(),a=t.options.tabSize,u=0;u<l.length;u++){var d=l[u].from(),m=Oe(t.getLine(d.line),d.ch,a);r.push($t(a-m%a))}t.replaceSelections(r)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){return Jt(t,function(){for(var r=t.listSelections(),l=[],a=0;a<r.length;a++)if(r[a].empty()){var u=r[a].head,d=Ce(t.doc,u.line).text;if(d){if(u.ch==d.length&&(u=new le(u.line,u.ch-1)),u.ch>0)u=new le(u.line,u.ch+1),t.replaceRange(d.charAt(u.ch-1)+d.charAt(u.ch-2),le(u.line,u.ch-2),u,"+transpose");else if(u.line>t.doc.first){var m=Ce(t.doc,u.line-1).text;m&&(u=new le(u.line,1),t.replaceRange(d.charAt(0)+t.doc.lineSeparator()+m.charAt(m.length-1),le(u.line-1,m.length-1),u,"+transpose"))}}l.push(new Qe(u,u))}t.setSelections(l)})},newlineAndIndent:function(t){return Jt(t,function(){for(var r=t.listSelections(),l=r.length-1;l>=0;l--)t.replaceRange(t.doc.lineSeparator(),r[l].anchor,r[l].head,"+input");r=t.listSelections();for(var a=0;a<r.length;a++)t.indentLine(r[a].from().line,null,!0);Yi(t)})},openLine:function(t){return t.replaceSelection(`
`,"start")},toggleOverwrite:function(t){return t.toggleOverwrite()}};function xu(t,r){var l=Ce(t.doc,r),a=xn(l);return a!=l&&(r=Je(a)),Aa(!0,t,a,r,1)}function vg(t,r){var l=Ce(t.doc,r),a=ep(l);return a!=l&&(r=Je(a)),Aa(!0,t,l,r,-1)}function _u(t,r){var l=xu(t,r.line),a=Ce(t.doc,l.line),u=J(a,t.doc.direction);if(!u||u[0].level==0){var d=Math.max(l.ch,a.text.search(/\S/)),m=r.line==l.line&&r.ch<=d&&r.ch;return le(l.line,m?0:d,l.sticky)}return l}function so(t,r,l){if(typeof r=="string"&&(r=qr[r],!r))return!1;t.display.input.ensurePolled();var a=t.display.shift,u=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),l&&(t.display.shift=!1),u=r(t)!=be}finally{t.display.shift=a,t.state.suppressEdits=!1}return u}function yg(t,r,l){for(var a=0;a<t.state.keyMaps.length;a++){var u=ir(r,t.state.keyMaps[a],l,t);if(u)return u}return t.options.extraKeys&&ir(r,t.options.extraKeys,l,t)||ir(r,t.options.keyMap,l,t)}var bg=new U;function Yr(t,r,l,a){var u=t.state.keySeq;if(u){if(vu(r))return"handled";if(/\'$/.test(r)?t.state.keySeq=null:bg.set(50,function(){t.state.keySeq==u&&(t.state.keySeq=null,t.display.input.reset())}),wu(t,u+" "+r,l,a))return!0}return wu(t,r,l,a)}function wu(t,r,l,a){var u=yg(t,r,a);return u=="multi"&&(t.state.keySeq=r),u=="handled"&&kt(t,"keyHandled",t,r,l),(u=="handled"||u=="multi")&&(At(l),ga(t)),!!u}function ku(t,r){var l=bu(r,!0);return l?r.shiftKey&&!t.state.keySeq?Yr(t,"Shift-"+l,r,function(a){return so(t,a,!0)})||Yr(t,l,r,function(a){if(typeof a=="string"?/^go[A-Z]/.test(a):a.motion)return so(t,a)}):Yr(t,l,r,function(a){return so(t,a)}):!1}function xg(t,r,l){return Yr(t,"'"+l+"'",r,function(a){return so(t,a,!0)})}var Ia=null;function Su(t){var r=this;if(!(t.target&&t.target!=r.display.input.getField())&&(r.curOp.focus=je(),!ot(r,t))){p&&g<11&&t.keyCode==27&&(t.returnValue=!1);var l=t.keyCode;r.display.shift=l==16||t.shiftKey;var a=ku(r,t);L&&(Ia=a?l:null,!a&&l==88&&!As&&(X?t.metaKey:t.ctrlKey)&&r.replaceSelection("",null,"cut")),o&&!X&&!a&&l==46&&t.shiftKey&&!t.ctrlKey&&document.execCommand&&document.execCommand("cut"),l==18&&!/\bCodeMirror-crosshair\b/.test(r.display.lineDiv.className)&&_g(r)}}function _g(t){var r=t.display.lineDiv;Ye(r,"CodeMirror-crosshair");function l(a){(a.keyCode==18||!a.altKey)&&(oe(r,"CodeMirror-crosshair"),Ue(document,"keyup",l),Ue(document,"mouseover",l))}ne(document,"keyup",l),ne(document,"mouseover",l)}function Cu(t){t.keyCode==16&&(this.doc.sel.shift=!1),ot(this,t)}function Tu(t){var r=this;if(!(t.target&&t.target!=r.display.input.getField())&&!(Bn(r.display,t)||ot(r,t)||t.ctrlKey&&!t.altKey||X&&t.metaKey)){var l=t.keyCode,a=t.charCode;if(L&&l==Ia){Ia=null,At(t);return}if(!(L&&(!t.which||t.which<10)&&ku(r,t))){var u=String.fromCharCode(a??l);u!="\b"&&(xg(r,t,u)||r.display.input.onKeyPress(t))}}}var wg=400,Ea=function(t,r,l){this.time=t,this.pos=r,this.button=l};Ea.prototype.compare=function(t,r,l){return this.time+wg>t&&k(r,this.pos)==0&&l==this.button};var Zr,Jr;function kg(t,r){var l=+new Date;return Jr&&Jr.compare(l,t,r)?(Zr=Jr=null,"triple"):Zr&&Zr.compare(l,t,r)?(Jr=new Ea(l,t,r),Zr=null,"double"):(Zr=new Ea(l,t,r),Jr=null,"single")}function Lu(t){var r=this,l=r.display;if(!(ot(r,t)||l.activeTouch&&l.input.supportsTouch())){if(l.input.ensurePolled(),l.shift=t.shiftKey,Bn(l,t)){b||(l.scroller.draggable=!1,setTimeout(function(){return l.scroller.draggable=!0},100));return}if(!Ra(r,t)){var a=xi(r,t),u=Ds(t),d=a?kg(a,u):"single";window.focus(),u==1&&r.state.selectingText&&r.state.selectingText(t),!(a&&Sg(r,u,a,d,t))&&(u==1?a?Tg(r,a,d,t):Qn(t)==l.scroller&&At(t):u==2?(a&&Qs(r.doc,a),setTimeout(function(){return l.input.focus()},20)):u==3&&(he?r.display.input.onContextMenu(t):ma(r)))}}}function Sg(t,r,l,a,u){var d="Click";return a=="double"?d="Double"+d:a=="triple"&&(d="Triple"+d),d=(r==1?"Left":r==2?"Middle":"Right")+d,Yr(t,yu(d,u),u,function(m){if(typeof m=="string"&&(m=qr[m]),!m)return!1;var y=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),y=m(t,l)!=be}finally{t.state.suppressEdits=!1}return y})}function Cg(t,r,l){var a=t.getOption("configureMouse"),u=a?a(t,r,l):{};if(u.unit==null){var d=G?l.shiftKey&&l.metaKey:l.altKey;u.unit=d?"rectangle":r=="single"?"char":r=="double"?"word":"line"}return(u.extend==null||t.doc.extend)&&(u.extend=t.doc.extend||l.shiftKey),u.addNew==null&&(u.addNew=X?l.metaKey:l.ctrlKey),u.moveOnDrag==null&&(u.moveOnDrag=!(X?l.altKey:l.ctrlKey)),u}function Tg(t,r,l,a){p?setTimeout(_e(Nc,t),0):t.curOp.focus=je();var u=Cg(t,l,a),d=t.doc.sel,m;t.options.dragDrop&&br&&!t.isReadOnly()&&l=="single"&&(m=d.contains(r))>-1&&(k((m=d.ranges[m]).from(),r)<0||r.xRel>0)&&(k(m.to(),r)>0||r.xRel<0)?Lg(t,a,r,u):Ng(t,a,r,u)}function Lg(t,r,l,a){var u=t.display,d=!1,m=St(t,function(w){b&&(u.scroller.draggable=!1),t.state.draggingText=!1,t.state.delayingBlurEvent&&(t.hasFocus()?t.state.delayingBlurEvent=!1:ma(t)),Ue(u.wrapper.ownerDocument,"mouseup",m),Ue(u.wrapper.ownerDocument,"mousemove",y),Ue(u.scroller,"dragstart",x),Ue(u.scroller,"drop",m),d||(At(w),a.addNew||Qs(t.doc,l,null,null,a.extend),b&&!D||p&&g==9?setTimeout(function(){u.wrapper.ownerDocument.body.focus({preventScroll:!0}),u.input.focus()},20):u.input.focus())}),y=function(w){d=d||Math.abs(r.clientX-w.clientX)+Math.abs(r.clientY-w.clientY)>=10},x=function(){return d=!0};b&&(u.scroller.draggable=!0),t.state.draggingText=m,m.copy=!a.moveOnDrag,ne(u.wrapper.ownerDocument,"mouseup",m),ne(u.wrapper.ownerDocument,"mousemove",y),ne(u.scroller,"dragstart",x),ne(u.scroller,"drop",m),t.state.delayingBlurEvent=!0,setTimeout(function(){return u.input.focus()},20),u.scroller.dragDrop&&u.scroller.dragDrop()}function Nu(t,r,l){if(l=="char")return new Qe(r,r);if(l=="word")return t.findWordAt(r);if(l=="line")return new Qe(le(r.line,0),ye(t.doc,le(r.line+1,0)));var a=l(t,r);return new Qe(a.from,a.to)}function Ng(t,r,l,a){p&&ma(t);var u=t.display,d=t.doc;At(r);var m,y,x=d.sel,w=x.ranges;if(a.addNew&&!a.extend?(y=d.sel.contains(l),y>-1?m=w[y]:m=new Qe(l,l)):(m=d.sel.primary(),y=d.sel.primIndex),a.unit=="rectangle")a.addNew||(m=new Qe(l,l)),l=xi(t,r,!0,!0),y=-1;else{var M=Nu(t,l,a.unit);a.extend?m=Ma(m,M.anchor,M.head,a.extend):m=M}a.addNew?y==-1?(y=w.length,Et(d,wn(t,w.concat([m]),y),{scroll:!1,origin:"*mouse"})):w.length>1&&w[y].empty()&&a.unit=="char"&&!a.extend?(Et(d,wn(t,w.slice(0,y).concat(w.slice(y+1)),0),{scroll:!1,origin:"*mouse"}),x=d.sel):Da(d,y,m,Ot):(y=0,Et(d,new cn([m],0),Ot),x=d.sel);var O=l;function W(pe){if(k(O,pe)!=0)if(O=pe,a.unit=="rectangle"){for(var we=[],Pe=t.options.tabSize,De=Oe(Ce(d,l.line).text,l.ch,Pe),Be=Oe(Ce(d,pe.line).text,pe.ch,Pe),st=Math.min(De,Be),Tt=Math.max(De,Be),ft=Math.min(l.line,pe.line),Qt=Math.min(t.lastLine(),Math.max(l.line,pe.line));ft<=Qt;ft++){var Xt=Ce(d,ft).text,bt=at(Xt,st,Pe);st==Tt?we.push(new Qe(le(ft,bt),le(ft,bt))):Xt.length>bt&&we.push(new Qe(le(ft,bt),le(ft,at(Xt,Tt,Pe))))}we.length||we.push(new Qe(l,l)),Et(d,wn(t,x.ranges.slice(0,y).concat(we),y),{origin:"*mouse",scroll:!1}),t.scrollIntoView(pe)}else{var Gt=m,Nt=Nu(t,pe,a.unit),wt=Gt.anchor,xt;k(Nt.anchor,wt)>0?(xt=Nt.head,wt=Re(Gt.from(),Nt.anchor)):(xt=Nt.anchor,wt=ce(Gt.to(),Nt.head));var dt=x.ranges.slice(0);dt[y]=Mg(t,new Qe(ye(d,wt),xt)),Et(d,wn(t,dt,y),Ot)}}var H=u.wrapper.getBoundingClientRect(),q=0;function re(pe){var we=++q,Pe=xi(t,pe,!0,a.unit=="rectangle");if(Pe)if(k(Pe,O)!=0){t.curOp.focus=je(),W(Pe);var De=Xs(u,d);(Pe.line>=De.to||Pe.line<De.from)&&setTimeout(St(t,function(){q==we&&re(pe)}),150)}else{var Be=pe.clientY<H.top?-20:pe.clientY>H.bottom?20:0;Be&&setTimeout(St(t,function(){q==we&&(u.scroller.scrollTop+=Be,re(pe))}),50)}}function ue(pe){t.state.selectingText=!1,q=1/0,pe&&(At(pe),u.input.focus()),Ue(u.wrapper.ownerDocument,"mousemove",de),Ue(u.wrapper.ownerDocument,"mouseup",ve),d.history.lastSelOrigin=null}var de=St(t,function(pe){pe.buttons===0||!Ds(pe)?ue(pe):re(pe)}),ve=St(t,ue);t.state.selectingText=ve,ne(u.wrapper.ownerDocument,"mousemove",de),ne(u.wrapper.ownerDocument,"mouseup",ve)}function Mg(t,r){var l=r.anchor,a=r.head,u=Ce(t.doc,l.line);if(k(l,a)==0&&l.sticky==a.sticky)return r;var d=J(u);if(!d)return r;var m=te(d,l.ch,l.sticky),y=d[m];if(y.from!=l.ch&&y.to!=l.ch)return r;var x=m+(y.from==l.ch==(y.level!=1)?0:1);if(x==0||x==d.length)return r;var w;if(a.line!=l.line)w=(a.line-l.line)*(t.doc.direction=="ltr"?1:-1)>0;else{var M=te(d,a.ch,a.sticky),O=M-m||(a.ch-l.ch)*(y.level==1?-1:1);M==x-1||M==x?w=O<0:w=O>0}var W=d[x+(w?-1:0)],H=w==(W.level==1),q=H?W.from:W.to,re=H?"after":"before";return l.ch==q&&l.sticky==re?r:new Qe(new le(l.line,q,re),a)}function Mu(t,r,l,a){var u,d;if(r.touches)u=r.touches[0].clientX,d=r.touches[0].clientY;else try{u=r.clientX,d=r.clientY}catch{return!1}if(u>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;a&&At(r);var m=t.display,y=m.lineDiv.getBoundingClientRect();if(d>y.bottom||!tt(t,l))return sn(r);d-=y.top-m.viewOffset;for(var x=0;x<t.display.gutterSpecs.length;++x){var w=m.gutters.childNodes[x];if(w&&w.getBoundingClientRect().right>=u){var M=Ln(t.doc,d),O=t.display.gutterSpecs[x];return Me(t,l,t,M,O.className,r),sn(r)}}}function Ra(t,r){return Mu(t,r,"gutterClick",!0)}function Du(t,r){Bn(t.display,r)||Dg(t,r)||ot(t,r,"contextmenu")||he||t.display.input.onContextMenu(r)}function Dg(t,r){return tt(t,"gutterContextMenu")?Mu(t,r,"gutterContextMenu",!1):!1}function Pu(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Or(t)}var sr={toString:function(){return"CodeMirror.Init"}},Ou={},oo={};function Pg(t){var r=t.optionHandlers;function l(a,u,d,m){t.defaults[a]=u,d&&(r[a]=m?function(y,x,w){w!=sr&&d(y,x,w)}:d)}t.defineOption=l,t.Init=sr,l("value","",function(a,u){return a.setValue(u)},!0),l("mode",null,function(a,u){a.doc.modeOption=u,Ta(a)},!0),l("indentUnit",2,Ta,!0),l("indentWithTabs",!1),l("smartIndent",!0),l("tabSize",4,function(a){Wr(a),Or(a),Vt(a)},!0),l("lineSeparator",null,function(a,u){if(a.doc.lineSep=u,!!u){var d=[],m=a.doc.first;a.doc.iter(function(x){for(var w=0;;){var M=x.text.indexOf(u,w);if(M==-1)break;w=M+u.length,d.push(le(m,M))}m++});for(var y=d.length-1;y>=0;y--)tr(a.doc,u,d[y],le(d[y].line,d[y].ch+u.length))}}),l("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(a,u,d){a.state.specialChars=new RegExp(u.source+(u.test("	")?"":"|	"),"g"),d!=sr&&a.refresh()}),l("specialCharPlaceholder",op,function(a){return a.refresh()},!0),l("electricChars",!0),l("inputStyle",j?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),l("spellcheck",!1,function(a,u){return a.getInputField().spellcheck=u},!0),l("autocorrect",!1,function(a,u){return a.getInputField().autocorrect=u},!0),l("autocapitalize",!1,function(a,u){return a.getInputField().autocapitalize=u},!0),l("rtlMoveVisually",!K),l("wholeLineUpdateBefore",!0),l("theme","default",function(a){Pu(a),zr(a)},!0),l("keyMap","default",function(a,u,d){var m=ro(u),y=d!=sr&&ro(d);y&&y.detach&&y.detach(a,m),m.attach&&m.attach(a,y||null)}),l("extraKeys",null),l("configureMouse",null),l("lineWrapping",!1,Ag,!0),l("gutters",[],function(a,u){a.display.gutterSpecs=Sa(u,a.options.lineNumbers),zr(a)},!0),l("fixedGutter",!0,function(a,u){a.display.gutters.style.left=u?ha(a.display)+"px":"0",a.refresh()},!0),l("coverGutterNextToScrollbar",!1,function(a){return Zi(a)},!0),l("scrollbarStyle","native",function(a){Ic(a),Zi(a),a.display.scrollbars.setScrollTop(a.doc.scrollTop),a.display.scrollbars.setScrollLeft(a.doc.scrollLeft)},!0),l("lineNumbers",!1,function(a,u){a.display.gutterSpecs=Sa(a.options.gutters,u),zr(a)},!0),l("firstLineNumber",1,zr,!0),l("lineNumberFormatter",function(a){return a},zr,!0),l("showCursorWhenSelecting",!1,Ar,!0),l("resetSelectionOnContextMenu",!0),l("lineWiseCopyCut",!0),l("pasteLinesPerSelection",!0),l("selectionsMayTouch",!1),l("readOnly",!1,function(a,u){u=="nocursor"&&(qi(a),a.display.input.blur()),a.display.input.readOnlyChanged(u)}),l("screenReaderLabel",null,function(a,u){u=u===""?null:u,a.display.input.screenReaderLabelChanged(u)}),l("disableInput",!1,function(a,u){u||a.display.input.reset()},!0),l("dragDrop",!0,Og),l("allowDropFileTypes",null),l("cursorBlinkRate",530),l("cursorScrollMargin",0),l("cursorHeight",1,Ar,!0),l("singleCursorHeightPerLine",!0,Ar,!0),l("workTime",100),l("workDelay",100),l("flattenSpans",!0,Wr,!0),l("addModeClass",!1,Wr,!0),l("pollInterval",100),l("undoDepth",200,function(a,u){return a.doc.history.undoDepth=u}),l("historyEventDelay",1250),l("viewportMargin",10,function(a){return a.refresh()},!0),l("maxHighlightLength",1e4,Wr,!0),l("moveInputWithCursor",!0,function(a,u){u||a.display.input.resetPosition()}),l("tabindex",null,function(a,u){return a.display.input.getField().tabIndex=u||""}),l("autofocus",null),l("direction","ltr",function(a,u){return a.doc.setDirection(u)},!0),l("phrases",null)}function Og(t,r,l){var a=l&&l!=sr;if(!r!=!a){var u=t.display.dragFunctions,d=r?ne:Ue;d(t.display.scroller,"dragstart",u.start),d(t.display.scroller,"dragenter",u.enter),d(t.display.scroller,"dragover",u.over),d(t.display.scroller,"dragleave",u.leave),d(t.display.scroller,"drop",u.drop)}}function Ag(t){t.options.lineWrapping?(Ye(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):(oe(t.display.wrapper,"CodeMirror-wrap"),na(t)),da(t),Vt(t),Or(t),setTimeout(function(){return Zi(t)},100)}function lt(t,r){var l=this;if(!(this instanceof lt))return new lt(t,r);this.options=r=r?Ne(r):{},Ne(Ou,r,!1);var a=r.value;typeof a=="string"?a=new Kt(a,r.mode,null,r.lineSeparator,r.direction):r.mode&&(a.modeOption=r.mode),this.doc=a;var u=new lt.inputStyles[r.inputStyle](this),d=this.display=new Kp(t,a,u,r);d.wrapper.CodeMirror=this,Pu(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Ic(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new U,keySeq:null,specialChars:null},r.autofocus&&!j&&d.input.focus(),p&&g<11&&setTimeout(function(){return l.display.input.reset(!0)},20),Ig(this),fg(),Si(this),this.curOp.forceUpdate=!0,jc(this,a),r.autofocus&&!j||this.hasFocus()?setTimeout(function(){l.hasFocus()&&!l.state.focused&&va(l)},20):qi(this);for(var m in oo)oo.hasOwnProperty(m)&&oo[m](this,r[m],sr);Fc(this),r.finishInit&&r.finishInit(this);for(var y=0;y<Fa.length;++y)Fa[y](this);Ci(this),b&&r.lineWrapping&&getComputedStyle(d.lineDiv).textRendering=="optimizelegibility"&&(d.lineDiv.style.textRendering="auto")}lt.defaults=Ou,lt.optionHandlers=oo;function Ig(t){var r=t.display;ne(r.scroller,"mousedown",St(t,Lu)),p&&g<11?ne(r.scroller,"dblclick",St(t,function(x){if(!ot(t,x)){var w=xi(t,x);if(!(!w||Ra(t,x)||Bn(t.display,x))){At(x);var M=t.findWordAt(w);Qs(t.doc,M.anchor,M.head)}}})):ne(r.scroller,"dblclick",function(x){return ot(t,x)||At(x)}),ne(r.scroller,"contextmenu",function(x){return Du(t,x)}),ne(r.input.getField(),"contextmenu",function(x){r.scroller.contains(x.target)||Du(t,x)});var l,a={end:0};function u(){r.activeTouch&&(l=setTimeout(function(){return r.activeTouch=null},1e3),a=r.activeTouch,a.end=+new Date)}function d(x){if(x.touches.length!=1)return!1;var w=x.touches[0];return w.radiusX<=1&&w.radiusY<=1}function m(x,w){if(w.left==null)return!0;var M=w.left-x.left,O=w.top-x.top;return M*M+O*O>20*20}ne(r.scroller,"touchstart",function(x){if(!ot(t,x)&&!d(x)&&!Ra(t,x)){r.input.ensurePolled(),clearTimeout(l);var w=+new Date;r.activeTouch={start:w,moved:!1,prev:w-a.end<=300?a:null},x.touches.length==1&&(r.activeTouch.left=x.touches[0].pageX,r.activeTouch.top=x.touches[0].pageY)}}),ne(r.scroller,"touchmove",function(){r.activeTouch&&(r.activeTouch.moved=!0)}),ne(r.scroller,"touchend",function(x){var w=r.activeTouch;if(w&&!Bn(r,x)&&w.left!=null&&!w.moved&&new Date-w.start<300){var M=t.coordsChar(r.activeTouch,"page"),O;!w.prev||m(w,w.prev)?O=new Qe(M,M):!w.prev.prev||m(w,w.prev.prev)?O=t.findWordAt(M):O=new Qe(le(M.line,0),ye(t.doc,le(M.line+1,0))),t.setSelection(O.anchor,O.head),t.focus(),At(x)}u()}),ne(r.scroller,"touchcancel",u),ne(r.scroller,"scroll",function(){r.scroller.clientHeight&&(Er(t,r.scroller.scrollTop),wi(t,r.scroller.scrollLeft,!0),Me(t,"scroll",t))}),ne(r.scroller,"mousewheel",function(x){return Wc(t,x)}),ne(r.scroller,"DOMMouseScroll",function(x){return Wc(t,x)}),ne(r.wrapper,"scroll",function(){return r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),r.dragFunctions={enter:function(x){ot(t,x)||mi(x)},over:function(x){ot(t,x)||(ug(t,x),mi(x))},start:function(x){return cg(t,x)},drop:St(t,lg),leave:function(x){ot(t,x)||pu(t)}};var y=r.input.getField();ne(y,"keyup",function(x){return Cu.call(t,x)}),ne(y,"keydown",St(t,Su)),ne(y,"keypress",St(t,Tu)),ne(y,"focus",function(x){return va(t,x)}),ne(y,"blur",function(x){return qi(t,x)})}var Fa=[];lt.defineInitHook=function(t){return Fa.push(t)};function Qr(t,r,l,a){var u=t.doc,d;l==null&&(l="add"),l=="smart"&&(u.mode.indent?d=Lr(t,r).state:l="prev");var m=t.options.tabSize,y=Ce(u,r),x=Oe(y.text,null,m);y.stateAfter&&(y.stateAfter=null);var w=y.text.match(/^\s*/)[0],M;if(!a&&!/\S/.test(y.text))M=0,l="not";else if(l=="smart"&&(M=u.mode.indent(d,y.text.slice(w.length),y.text),M==be||M>150)){if(!a)return;l="prev"}l=="prev"?r>u.first?M=Oe(Ce(u,r-1).text,null,m):M=0:l=="add"?M=x+t.options.indentUnit:l=="subtract"?M=x-t.options.indentUnit:typeof l=="number"&&(M=x+l),M=Math.max(0,M);var O="",W=0;if(t.options.indentWithTabs)for(var H=Math.floor(M/m);H;--H)W+=m,O+="	";if(W<M&&(O+=$t(M-W)),O!=w)return tr(u,O,le(r,0),le(r,w.length),"+input"),y.stateAfter=null,!0;for(var q=0;q<u.sel.ranges.length;q++){var re=u.sel.ranges[q];if(re.head.line==r&&re.head.ch<w.length){var ue=le(r,w.length);Da(u,q,new Qe(ue,ue));break}}}var kn=null;function ao(t){kn=t}function Ha(t,r,l,a,u){var d=t.doc;t.display.shift=!1,a||(a=d.sel);var m=+new Date-200,y=u=="paste"||t.state.pasteIncoming>m,x=_r(r),w=null;if(y&&a.ranges.length>1)if(kn&&kn.text.join(`
`)==r){if(a.ranges.length%kn.text.length==0){w=[];for(var M=0;M<kn.text.length;M++)w.push(d.splitLines(kn.text[M]))}}else x.length==a.ranges.length&&t.options.pasteLinesPerSelection&&(w=me(x,function(de){return[de]}));for(var O=t.curOp.updateInput,W=a.ranges.length-1;W>=0;W--){var H=a.ranges[W],q=H.from(),re=H.to();H.empty()&&(l&&l>0?q=le(q.line,q.ch-l):t.state.overwrite&&!y?re=le(re.line,Math.min(Ce(d,re.line).text.length,re.ch+V(x).length)):y&&kn&&kn.lineWise&&kn.text.join(`
`)==x.join(`
`)&&(q=re=le(q.line,0)));var ue={from:q,to:re,text:w?w[W%w.length]:x,origin:u||(y?"paste":t.state.cutIncoming>m?"cut":"+input")};er(t.doc,ue),kt(t,"inputRead",t,ue)}r&&!y&&Iu(t,r),Yi(t),t.curOp.updateInput<2&&(t.curOp.updateInput=O),t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=-1}function Au(t,r){var l=t.clipboardData&&t.clipboardData.getData("Text");if(l)return t.preventDefault(),!r.isReadOnly()&&!r.options.disableInput&&Jt(r,function(){return Ha(r,l,0,null,"paste")}),!0}function Iu(t,r){if(!(!t.options.electricChars||!t.options.smartIndent))for(var l=t.doc.sel,a=l.ranges.length-1;a>=0;a--){var u=l.ranges[a];if(!(u.head.ch>100||a&&l.ranges[a-1].head.line==u.head.line)){var d=t.getModeAt(u.head),m=!1;if(d.electricChars){for(var y=0;y<d.electricChars.length;y++)if(r.indexOf(d.electricChars.charAt(y))>-1){m=Qr(t,u.head.line,"smart");break}}else d.electricInput&&d.electricInput.test(Ce(t.doc,u.head.line).text.slice(0,u.head.ch))&&(m=Qr(t,u.head.line,"smart"));m&&kt(t,"electricInput",t,u.head.line)}}}function Eu(t){for(var r=[],l=[],a=0;a<t.doc.sel.ranges.length;a++){var u=t.doc.sel.ranges[a].head.line,d={anchor:le(u,0),head:le(u+1,0)};l.push(d),r.push(t.getRange(d.anchor,d.head))}return{text:r,ranges:l}}function Ru(t,r,l,a){t.setAttribute("autocorrect",l?"":"off"),t.setAttribute("autocapitalize",a?"":"off"),t.setAttribute("spellcheck",!!r)}function Fu(){var t=F("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),r=F("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return b?t.style.width="1000px":t.setAttribute("wrap","off"),E&&(t.style.border="1px solid black"),Ru(t),r}function Eg(t){var r=t.optionHandlers,l=t.helpers={};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(a,u){var d=this.options,m=d[a];d[a]==u&&a!="mode"||(d[a]=u,r.hasOwnProperty(a)&&St(this,r[a])(this,u,m),Me(this,"optionChange",this,a))},getOption:function(a){return this.options[a]},getDoc:function(){return this.doc},addKeyMap:function(a,u){this.state.keyMaps[u?"push":"unshift"](ro(a))},removeKeyMap:function(a){for(var u=this.state.keyMaps,d=0;d<u.length;++d)if(u[d]==a||u[d].name==a)return u.splice(d,1),!0},addOverlay:zt(function(a,u){var d=a.token?a:t.getMode(this.options,a);if(d.startState)throw new Error("Overlays may not be stateful.");Ae(this.state.overlays,{mode:d,modeSpec:a,opaque:u&&u.opaque,priority:u&&u.priority||0},function(m){return m.priority}),this.state.modeGen++,Vt(this)}),removeOverlay:zt(function(a){for(var u=this.state.overlays,d=0;d<u.length;++d){var m=u[d].modeSpec;if(m==a||typeof a=="string"&&m.name==a){u.splice(d,1),this.state.modeGen++,Vt(this);return}}}),indentLine:zt(function(a,u,d){typeof u!="string"&&typeof u!="number"&&(u==null?u=this.options.smartIndent?"smart":"prev":u=u?"add":"subtract"),vi(this.doc,a)&&Qr(this,a,u,d)}),indentSelection:zt(function(a){for(var u=this.doc.sel.ranges,d=-1,m=0;m<u.length;m++){var y=u[m];if(y.empty())y.head.line>d&&(Qr(this,y.head.line,a,!0),d=y.head.line,m==this.doc.sel.primIndex&&Yi(this));else{var x=y.from(),w=y.to(),M=Math.max(d,x.line);d=Math.min(this.lastLine(),w.line-(w.ch?0:1))+1;for(var O=M;O<d;++O)Qr(this,O,a);var W=this.doc.sel.ranges;x.ch==0&&u.length==W.length&&W[m].from().ch>0&&Da(this.doc,m,new Qe(x,W[m].to()),Ie)}}}),getTokenAt:function(a,u){return Kl(this,a,u)},getLineTokens:function(a,u){return Kl(this,le(a),u,!0)},getTokenTypeAt:function(a){a=ye(this.doc,a);var u=$l(this,Ce(this.doc,a.line)),d=0,m=(u.length-1)/2,y=a.ch,x;if(y==0)x=u[2];else for(;;){var w=d+m>>1;if((w?u[w*2-1]:0)>=y)m=w;else if(u[w*2+1]<y)d=w+1;else{x=u[w*2+2];break}}var M=x?x.indexOf("overlay "):-1;return M<0?x:M==0?null:x.slice(0,M-1)},getModeAt:function(a){var u=this.doc.mode;return u.innerMode?t.innerMode(u,this.getTokenAt(a).state).mode:u},getHelper:function(a,u){return this.getHelpers(a,u)[0]},getHelpers:function(a,u){var d=[];if(!l.hasOwnProperty(u))return d;var m=l[u],y=this.getModeAt(a);if(typeof y[u]=="string")m[y[u]]&&d.push(m[y[u]]);else if(y[u])for(var x=0;x<y[u].length;x++){var w=m[y[u][x]];w&&d.push(w)}else y.helperType&&m[y.helperType]?d.push(m[y.helperType]):m[y.name]&&d.push(m[y.name]);for(var M=0;M<m._global.length;M++){var O=m._global[M];O.pred(y,this)&&Z(d,O.val)==-1&&d.push(O.val)}return d},getStateAfter:function(a,u){var d=this.doc;return a=qe(d,a??d.first+d.size-1),Lr(this,a+1,u).state},cursorCoords:function(a,u){var d,m=this.doc.sel.primary();return a==null?d=m.head:typeof a=="object"?d=ye(this.doc,a):d=a?m.from():m.to(),_n(this,d,u||"page")},charCoords:function(a,u){return $s(this,ye(this.doc,a),u||"page")},coordsChar:function(a,u){return a=_c(this,a,u||"page"),ca(this,a.left,a.top)},lineAtHeight:function(a,u){return a=_c(this,{top:a,left:0},u||"page").top,Ln(this.doc,a+this.display.viewOffset)},heightAtLine:function(a,u,d){var m=!1,y;if(typeof a=="number"){var x=this.doc.first+this.doc.size-1;a<this.doc.first?a=this.doc.first:a>x&&(a=x,m=!0),y=Ce(this.doc,a)}else y=a;return Us(this,y,{top:0,left:0},u||"page",d||m).top+(m?this.doc.height-Wn(y):0)},defaultTextHeight:function(){return Xi(this.display)},defaultCharWidth:function(){return Gi(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(a,u,d,m,y){var x=this.display;a=_n(this,ye(this.doc,a));var w=a.bottom,M=a.left;if(u.style.position="absolute",u.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(u),x.sizer.appendChild(u),m=="over")w=a.top;else if(m=="above"||m=="near"){var O=Math.max(x.wrapper.clientHeight,this.doc.height),W=Math.max(x.sizer.clientWidth,x.lineSpace.clientWidth);(m=="above"||a.bottom+u.offsetHeight>O)&&a.top>u.offsetHeight?w=a.top-u.offsetHeight:a.bottom+u.offsetHeight<=O&&(w=a.bottom),M+u.offsetWidth>W&&(M=W-u.offsetWidth)}u.style.top=w+"px",u.style.left=u.style.right="",y=="right"?(M=x.sizer.clientWidth-u.offsetWidth,u.style.right="0px"):(y=="left"?M=0:y=="middle"&&(M=(x.sizer.clientWidth-u.offsetWidth)/2),u.style.left=M+"px"),d&&Op(this,{left:M,top:w,right:M+u.offsetWidth,bottom:w+u.offsetHeight})},triggerOnKeyDown:zt(Su),triggerOnKeyPress:zt(Tu),triggerOnKeyUp:Cu,triggerOnMouseDown:zt(Lu),execCommand:function(a){if(qr.hasOwnProperty(a))return qr[a].call(null,this)},triggerElectric:zt(function(a){Iu(this,a)}),findPosH:function(a,u,d,m){var y=1;u<0&&(y=-1,u=-u);for(var x=ye(this.doc,a),w=0;w<u&&(x=za(this.doc,x,y,d,m),!x.hitSide);++w);return x},moveH:zt(function(a,u){var d=this;this.extendSelectionsBy(function(m){return d.display.shift||d.doc.extend||m.empty()?za(d.doc,m.head,a,u,d.options.rtlMoveVisually):a<0?m.from():m.to()},He)}),deleteH:zt(function(a,u){var d=this.doc.sel,m=this.doc;d.somethingSelected()?m.replaceSelection("",null,"+delete"):rr(this,function(y){var x=za(m,y.head,a,u,!1);return a<0?{from:x,to:y.head}:{from:y.head,to:x}})}),findPosV:function(a,u,d,m){var y=1,x=m;u<0&&(y=-1,u=-u);for(var w=ye(this.doc,a),M=0;M<u;++M){var O=_n(this,w,"div");if(x==null?x=O.left:O.left=x,w=Hu(this,O,y,d),w.hitSide)break}return w},moveV:zt(function(a,u){var d=this,m=this.doc,y=[],x=!this.display.shift&&!m.extend&&m.sel.somethingSelected();if(m.extendSelectionsBy(function(M){if(x)return a<0?M.from():M.to();var O=_n(d,M.head,"div");M.goalColumn!=null&&(O.left=M.goalColumn),y.push(O.left);var W=Hu(d,O,a,u);return u=="page"&&M==m.sel.primary()&&ba(d,$s(d,W,"div").top-O.top),W},He),y.length)for(var w=0;w<m.sel.ranges.length;w++)m.sel.ranges[w].goalColumn=y[w]}),findWordAt:function(a){var u=this.doc,d=Ce(u,a.line).text,m=a.ch,y=a.ch;if(d){var x=this.getHelper(a,"wordChars");(a.sticky=="before"||y==d.length)&&m?--m:++y;for(var w=d.charAt(m),M=ze(w,x)?function(O){return ze(O,x)}:/\s/.test(w)?function(O){return/\s/.test(O)}:function(O){return!/\s/.test(O)&&!ze(O)};m>0&&M(d.charAt(m-1));)--m;for(;y<d.length&&M(d.charAt(y));)++y}return new Qe(le(a.line,m),le(a.line,y))},toggleOverwrite:function(a){a!=null&&a==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Ye(this.display.cursorDiv,"CodeMirror-overwrite"):oe(this.display.cursorDiv,"CodeMirror-overwrite"),Me(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==je()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:zt(function(a,u){Ir(this,a,u)}),getScrollInfo:function(){var a=this.display.scroller;return{left:a.scrollLeft,top:a.scrollTop,height:a.scrollHeight-Mn(this)-this.display.barHeight,width:a.scrollWidth-Mn(this)-this.display.barWidth,clientHeight:sa(this),clientWidth:yi(this)}},scrollIntoView:zt(function(a,u){a==null?(a={from:this.doc.sel.primary().head,to:null},u==null&&(u=this.options.cursorScrollMargin)):typeof a=="number"?a={from:le(a,0),to:null}:a.from==null&&(a={from:a,to:null}),a.to||(a.to=a.from),a.margin=u||0,a.from.line!=null?Ap(this,a):Dc(this,a.from,a.to,a.margin)}),setSize:zt(function(a,u){var d=this,m=function(x){return typeof x=="number"||/^\d+$/.test(String(x))?x+"px":x};a!=null&&(this.display.wrapper.style.width=m(a)),u!=null&&(this.display.wrapper.style.height=m(u)),this.options.lineWrapping&&yc(this);var y=this.display.viewFrom;this.doc.iter(y,this.display.viewTo,function(x){if(x.widgets){for(var w=0;w<x.widgets.length;w++)if(x.widgets[w].noHScroll){ni(d,y,"widget");break}}++y}),this.curOp.forceUpdate=!0,Me(this,"refresh",this)}),operation:function(a){return Jt(this,a)},startOperation:function(){return Si(this)},endOperation:function(){return Ci(this)},refresh:zt(function(){var a=this.display.cachedTextHeight;Vt(this),this.curOp.forceUpdate=!0,Or(this),Ir(this,this.doc.scrollLeft,this.doc.scrollTop),wa(this.display),(a==null||Math.abs(a-Xi(this.display))>.5||this.options.lineWrapping)&&da(this),Me(this,"refresh",this)}),swapDoc:zt(function(a){var u=this.doc;return u.cm=null,this.state.selectingText&&this.state.selectingText(),jc(this,a),Or(this),this.display.input.reset(),Ir(this,a.scrollLeft,a.scrollTop),this.curOp.forceScroll=!0,kt(this,"swapDoc",this,u),u}),phrase:function(a){var u=this.options.phrases;return u&&Object.prototype.hasOwnProperty.call(u,a)?u[a]:a},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},rn(t),t.registerHelper=function(a,u,d){l.hasOwnProperty(a)||(l[a]=t[a]={_global:[]}),l[a][u]=d},t.registerGlobalHelper=function(a,u,d,m){t.registerHelper(a,u,m),l[a]._global.push({pred:d,val:m})}}function za(t,r,l,a,u){var d=r,m=l,y=Ce(t,r.line),x=u&&t.direction=="rtl"?-l:l;function w(){var ve=r.line+x;return ve<t.first||ve>=t.first+t.size?!1:(r=new le(ve,r.ch,r.sticky),y=Ce(t,ve))}function M(ve){var pe;if(a=="codepoint"){var we=y.text.charCodeAt(r.ch+(l>0?0:-1));if(isNaN(we))pe=null;else{var Pe=l>0?we>=55296&&we<56320:we>=56320&&we<57343;pe=new le(r.line,Math.max(0,Math.min(y.text.length,r.ch+l*(Pe?2:1))),-l)}}else u?pe=mg(t.cm,y,r,l):pe=Oa(y,r,l);if(pe==null)if(!ve&&w())r=Aa(u,t.cm,y,r.line,x);else return!1;else r=pe;return!0}if(a=="char"||a=="codepoint")M();else if(a=="column")M(!0);else if(a=="word"||a=="group")for(var O=null,W=a=="group",H=t.cm&&t.cm.getHelper(r,"wordChars"),q=!0;!(l<0&&!M(!q));q=!1){var re=y.text.charAt(r.ch)||`
`,ue=ze(re,H)?"w":W&&re==`
`?"n":!W||/\s/.test(re)?null:"p";if(W&&!q&&!ue&&(ue="s"),O&&O!=ue){l<0&&(l=1,M(),r.sticky="after");break}if(ue&&(O=ue),l>0&&!M(!q))break}var de=to(t,r,d,m,!0);return A(d,de)&&(de.hitSide=!0),de}function Hu(t,r,l,a){var u=t.doc,d=r.left,m;if(a=="page"){var y=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),x=Math.max(y-.5*Xi(t.display),3);m=(l>0?r.bottom:r.top)+l*x}else a=="line"&&(m=l>0?r.bottom+3:r.top-3);for(var w;w=ca(t,d,m),!!w.outside;){if(l<0?m<=0:m>=u.height){w.hitSide=!0;break}m+=l*5}return w}var it=function(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new U,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};it.prototype.init=function(t){var r=this,l=this,a=l.cm,u=l.div=t.lineDiv;u.contentEditable=!0,Ru(u,a.options.spellcheck,a.options.autocorrect,a.options.autocapitalize);function d(y){for(var x=y.target;x;x=x.parentNode){if(x==u)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(x.className))break}return!1}ne(u,"paste",function(y){!d(y)||ot(a,y)||Au(y,a)||g<=11&&setTimeout(St(a,function(){return r.updateFromDOM()}),20)}),ne(u,"compositionstart",function(y){r.composing={data:y.data,done:!1}}),ne(u,"compositionupdate",function(y){r.composing||(r.composing={data:y.data,done:!1})}),ne(u,"compositionend",function(y){r.composing&&(y.data!=r.composing.data&&r.readFromDOMSoon(),r.composing.done=!0)}),ne(u,"touchstart",function(){return l.forceCompositionEnd()}),ne(u,"input",function(){r.composing||r.readFromDOMSoon()});function m(y){if(!(!d(y)||ot(a,y))){if(a.somethingSelected())ao({lineWise:!1,text:a.getSelections()}),y.type=="cut"&&a.replaceSelection("",null,"cut");else if(a.options.lineWiseCopyCut){var x=Eu(a);ao({lineWise:!0,text:x.text}),y.type=="cut"&&a.operation(function(){a.setSelections(x.ranges,0,Ie),a.replaceSelection("",null,"cut")})}else return;if(y.clipboardData){y.clipboardData.clearData();var w=kn.text.join(`
`);if(y.clipboardData.setData("Text",w),y.clipboardData.getData("Text")==w){y.preventDefault();return}}var M=Fu(),O=M.firstChild;a.display.lineSpace.insertBefore(M,a.display.lineSpace.firstChild),O.value=kn.text.join(`
`);var W=je();Se(O),setTimeout(function(){a.display.lineSpace.removeChild(M),W.focus(),W==u&&l.showPrimarySelection()},50)}}ne(u,"copy",m),ne(u,"cut",m)},it.prototype.screenReaderLabelChanged=function(t){t?this.div.setAttribute("aria-label",t):this.div.removeAttribute("aria-label")},it.prototype.prepareSelection=function(){var t=Lc(this.cm,!1);return t.focus=je()==this.div,t},it.prototype.showSelection=function(t,r){!t||!this.cm.display.view.length||((t.focus||r)&&this.showPrimarySelection(),this.showMultipleSelections(t))},it.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},it.prototype.showPrimarySelection=function(){var t=this.getSelection(),r=this.cm,l=r.doc.sel.primary(),a=l.from(),u=l.to();if(r.display.viewTo==r.display.viewFrom||a.line>=r.display.viewTo||u.line<r.display.viewFrom){t.removeAllRanges();return}var d=lo(r,t.anchorNode,t.anchorOffset),m=lo(r,t.focusNode,t.focusOffset);if(!(d&&!d.bad&&m&&!m.bad&&k(Re(d,m),a)==0&&k(ce(d,m),u)==0)){var y=r.display.view,x=a.line>=r.display.viewFrom&&zu(r,a)||{node:y[0].measure.map[2],offset:0},w=u.line<r.display.viewTo&&zu(r,u);if(!w){var M=y[y.length-1].measure,O=M.maps?M.maps[M.maps.length-1]:M.map;w={node:O[O.length-1],offset:O[O.length-2]-O[O.length-3]}}if(!x||!w){t.removeAllRanges();return}var W=t.rangeCount&&t.getRangeAt(0),H;try{H=ge(x.node,x.offset,w.offset,w.node)}catch{}H&&(!o&&r.state.focused?(t.collapse(x.node,x.offset),H.collapsed||(t.removeAllRanges(),t.addRange(H))):(t.removeAllRanges(),t.addRange(H)),W&&t.anchorNode==null?t.addRange(W):o&&this.startGracePeriod()),this.rememberSelection()}},it.prototype.startGracePeriod=function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation(function(){return t.cm.curOp.selectionChanged=!0})},20)},it.prototype.showMultipleSelections=function(t){R(this.cm.display.cursorDiv,t.cursors),R(this.cm.display.selectionDiv,t.selection)},it.prototype.rememberSelection=function(){var t=this.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},it.prototype.selectionInEditor=function(){var t=this.getSelection();if(!t.rangeCount)return!1;var r=t.getRangeAt(0).commonAncestorContainer;return Le(this.div,r)},it.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||je()!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},it.prototype.blur=function(){this.div.blur()},it.prototype.getField=function(){return this.div},it.prototype.supportsTouch=function(){return!0},it.prototype.receivedFocus=function(){var t=this,r=this;this.selectionInEditor()?setTimeout(function(){return t.pollSelection()},20):Jt(this.cm,function(){return r.cm.curOp.selectionChanged=!0});function l(){r.cm.state.focused&&(r.pollSelection(),r.polling.set(r.cm.options.pollInterval,l))}this.polling.set(this.cm.options.pollInterval,l)},it.prototype.selectionChanged=function(){var t=this.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},it.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var t=this.getSelection(),r=this.cm;if(I&&T&&this.cm.display.gutterSpecs.length&&Rg(t.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var l=lo(r,t.anchorNode,t.anchorOffset),a=lo(r,t.focusNode,t.focusOffset);l&&a&&Jt(r,function(){Et(r.doc,ri(l,a),Ie),(l.bad||a.bad)&&(r.curOp.selectionChanged=!0)})}}},it.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var t=this.cm,r=t.display,l=t.doc.sel.primary(),a=l.from(),u=l.to();if(a.ch==0&&a.line>t.firstLine()&&(a=le(a.line-1,Ce(t.doc,a.line-1).length)),u.ch==Ce(t.doc,u.line).text.length&&u.line<t.lastLine()&&(u=le(u.line+1,0)),a.line<r.viewFrom||u.line>r.viewTo-1)return!1;var d,m,y;a.line==r.viewFrom||(d=_i(t,a.line))==0?(m=Je(r.view[0].line),y=r.view[0].node):(m=Je(r.view[d].line),y=r.view[d-1].node.nextSibling);var x=_i(t,u.line),w,M;if(x==r.view.length-1?(w=r.viewTo-1,M=r.lineDiv.lastChild):(w=Je(r.view[x+1].line)-1,M=r.view[x+1].node.previousSibling),!y)return!1;for(var O=t.doc.splitLines(Fg(t,y,M,m,w)),W=Tn(t.doc,le(m,0),le(w,Ce(t.doc,w).text.length));O.length>1&&W.length>1;)if(V(O)==V(W))O.pop(),W.pop(),w--;else if(O[0]==W[0])O.shift(),W.shift(),m++;else break;for(var H=0,q=0,re=O[0],ue=W[0],de=Math.min(re.length,ue.length);H<de&&re.charCodeAt(H)==ue.charCodeAt(H);)++H;for(var ve=V(O),pe=V(W),we=Math.min(ve.length-(O.length==1?H:0),pe.length-(W.length==1?H:0));q<we&&ve.charCodeAt(ve.length-q-1)==pe.charCodeAt(pe.length-q-1);)++q;if(O.length==1&&W.length==1&&m==a.line)for(;H&&H>a.ch&&ve.charCodeAt(ve.length-q-1)==pe.charCodeAt(pe.length-q-1);)H--,q++;O[O.length-1]=ve.slice(0,ve.length-q).replace(/^\u200b+/,""),O[0]=O[0].slice(H).replace(/\u200b+$/,"");var Pe=le(m,H),De=le(w,W.length?V(W).length-q:0);if(O.length>1||O[0]||k(Pe,De))return tr(t.doc,O,Pe,De,"+input"),!0},it.prototype.ensurePolled=function(){this.forceCompositionEnd()},it.prototype.reset=function(){this.forceCompositionEnd()},it.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},it.prototype.readFromDOMSoon=function(){var t=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(t.readDOMTimeout=null,t.composing)if(t.composing.done)t.composing=null;else return;t.updateFromDOM()},80))},it.prototype.updateFromDOM=function(){var t=this;(this.cm.isReadOnly()||!this.pollContent())&&Jt(this.cm,function(){return Vt(t.cm)})},it.prototype.setUneditable=function(t){t.contentEditable="false"},it.prototype.onKeyPress=function(t){t.charCode==0||this.composing||(t.preventDefault(),this.cm.isReadOnly()||St(this.cm,Ha)(this.cm,String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),0))},it.prototype.readOnlyChanged=function(t){this.div.contentEditable=String(t!="nocursor")},it.prototype.onContextMenu=function(){},it.prototype.resetPosition=function(){},it.prototype.needsContentAttribute=!0;function zu(t,r){var l=oa(t,r.line);if(!l||l.hidden)return null;var a=Ce(t.doc,r.line),u=dc(l,a,r.line),d=J(a,t.doc.direction),m="left";if(d){var y=te(d,r.ch);m=y%2?"right":"left"}var x=mc(u.map,r.ch,m);return x.offset=x.collapse=="right"?x.end:x.start,x}function Rg(t){for(var r=t;r;r=r.parentNode)if(/CodeMirror-gutter-wrapper/.test(r.className))return!0;return!1}function or(t,r){return r&&(t.bad=!0),t}function Fg(t,r,l,a,u){var d="",m=!1,y=t.doc.lineSeparator(),x=!1;function w(H){return function(q){return q.id==H}}function M(){m&&(d+=y,x&&(d+=y),m=x=!1)}function O(H){H&&(M(),d+=H)}function W(H){if(H.nodeType==1){var q=H.getAttribute("cm-text");if(q){O(q);return}var re=H.getAttribute("cm-marker"),ue;if(re){var de=t.findMarks(le(a,0),le(u+1,0),w(+re));de.length&&(ue=de[0].find(0))&&O(Tn(t.doc,ue.from,ue.to).join(y));return}if(H.getAttribute("contenteditable")=="false")return;var ve=/^(pre|div|p|li|table|br)$/i.test(H.nodeName);if(!/^br$/i.test(H.nodeName)&&H.textContent.length==0)return;ve&&M();for(var pe=0;pe<H.childNodes.length;pe++)W(H.childNodes[pe]);/^(pre|p)$/i.test(H.nodeName)&&(x=!0),ve&&(m=!0)}else H.nodeType==3&&O(H.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;W(r),r!=l;)r=r.nextSibling,x=!1;return d}function lo(t,r,l){var a;if(r==t.display.lineDiv){if(a=t.display.lineDiv.childNodes[l],!a)return or(t.clipPos(le(t.display.viewTo-1)),!0);r=null,l=0}else for(a=r;;a=a.parentNode){if(!a||a==t.display.lineDiv)return null;if(a.parentNode&&a.parentNode==t.display.lineDiv)break}for(var u=0;u<t.display.view.length;u++){var d=t.display.view[u];if(d.node==a)return Hg(d,r,l)}}function Hg(t,r,l){var a=t.text.firstChild,u=!1;if(!r||!Le(a,r))return or(le(Je(t.line),0),!0);if(r==a&&(u=!0,r=a.childNodes[l],l=0,!r)){var d=t.rest?V(t.rest):t.line;return or(le(Je(d),d.text.length),u)}var m=r.nodeType==3?r:null,y=r;for(!m&&r.childNodes.length==1&&r.firstChild.nodeType==3&&(m=r.firstChild,l&&(l=m.nodeValue.length));y.parentNode!=a;)y=y.parentNode;var x=t.measure,w=x.maps;function M(ue,de,ve){for(var pe=-1;pe<(w?w.length:0);pe++)for(var we=pe<0?x.map:w[pe],Pe=0;Pe<we.length;Pe+=3){var De=we[Pe+2];if(De==ue||De==de){var Be=Je(pe<0?t.line:t.rest[pe]),st=we[Pe]+ve;return(ve<0||De!=ue)&&(st=we[Pe+(ve?1:0)]),le(Be,st)}}}var O=M(m,y,l);if(O)return or(O,u);for(var W=y.nextSibling,H=m?m.nodeValue.length-l:0;W;W=W.nextSibling){if(O=M(W,W.firstChild,0),O)return or(le(O.line,O.ch-H),u);H+=W.textContent.length}for(var q=y.previousSibling,re=l;q;q=q.previousSibling){if(O=M(q,q.firstChild,-1),O)return or(le(O.line,O.ch+re),u);re+=q.textContent.length}}var mt=function(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new U,this.hasSelection=!1,this.composing=null};mt.prototype.init=function(t){var r=this,l=this,a=this.cm;this.createField(t);var u=this.textarea;t.wrapper.insertBefore(this.wrapper,t.wrapper.firstChild),E&&(u.style.width="0px"),ne(u,"input",function(){p&&g>=9&&r.hasSelection&&(r.hasSelection=null),l.poll()}),ne(u,"paste",function(m){ot(a,m)||Au(m,a)||(a.state.pasteIncoming=+new Date,l.fastPoll())});function d(m){if(!ot(a,m)){if(a.somethingSelected())ao({lineWise:!1,text:a.getSelections()});else if(a.options.lineWiseCopyCut){var y=Eu(a);ao({lineWise:!0,text:y.text}),m.type=="cut"?a.setSelections(y.ranges,null,Ie):(l.prevInput="",u.value=y.text.join(`
`),Se(u))}else return;m.type=="cut"&&(a.state.cutIncoming=+new Date)}}ne(u,"cut",d),ne(u,"copy",d),ne(t.scroller,"paste",function(m){if(!(Bn(t,m)||ot(a,m))){if(!u.dispatchEvent){a.state.pasteIncoming=+new Date,l.focus();return}var y=new Event("paste");y.clipboardData=m.clipboardData,u.dispatchEvent(y)}}),ne(t.lineSpace,"selectstart",function(m){Bn(t,m)||At(m)}),ne(u,"compositionstart",function(){var m=a.getCursor("from");l.composing&&l.composing.range.clear(),l.composing={start:m,range:a.markText(m,a.getCursor("to"),{className:"CodeMirror-composing"})}}),ne(u,"compositionend",function(){l.composing&&(l.poll(),l.composing.range.clear(),l.composing=null)})},mt.prototype.createField=function(t){this.wrapper=Fu(),this.textarea=this.wrapper.firstChild},mt.prototype.screenReaderLabelChanged=function(t){t?this.textarea.setAttribute("aria-label",t):this.textarea.removeAttribute("aria-label")},mt.prototype.prepareSelection=function(){var t=this.cm,r=t.display,l=t.doc,a=Lc(t);if(t.options.moveInputWithCursor){var u=_n(t,l.sel.primary().head,"div"),d=r.wrapper.getBoundingClientRect(),m=r.lineDiv.getBoundingClientRect();a.teTop=Math.max(0,Math.min(r.wrapper.clientHeight-10,u.top+m.top-d.top)),a.teLeft=Math.max(0,Math.min(r.wrapper.clientWidth-10,u.left+m.left-d.left))}return a},mt.prototype.showSelection=function(t){var r=this.cm,l=r.display;R(l.cursorDiv,t.cursors),R(l.selectionDiv,t.selection),t.teTop!=null&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},mt.prototype.reset=function(t){if(!(this.contextMenuPending||this.composing)){var r=this.cm;if(r.somethingSelected()){this.prevInput="";var l=r.getSelection();this.textarea.value=l,r.state.focused&&Se(this.textarea),p&&g>=9&&(this.hasSelection=l)}else t||(this.prevInput=this.textarea.value="",p&&g>=9&&(this.hasSelection=null))}},mt.prototype.getField=function(){return this.textarea},mt.prototype.supportsTouch=function(){return!1},mt.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!j||je()!=this.textarea))try{this.textarea.focus()}catch{}},mt.prototype.blur=function(){this.textarea.blur()},mt.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},mt.prototype.receivedFocus=function(){this.slowPoll()},mt.prototype.slowPoll=function(){var t=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){t.poll(),t.cm.state.focused&&t.slowPoll()})},mt.prototype.fastPoll=function(){var t=!1,r=this;r.pollingFast=!0;function l(){var a=r.poll();!a&&!t?(t=!0,r.polling.set(60,l)):(r.pollingFast=!1,r.slowPoll())}r.polling.set(20,l)},mt.prototype.poll=function(){var t=this,r=this.cm,l=this.textarea,a=this.prevInput;if(this.contextMenuPending||!r.state.focused||Os(l)&&!a&&!this.composing||r.isReadOnly()||r.options.disableInput||r.state.keySeq)return!1;var u=l.value;if(u==a&&!r.somethingSelected())return!1;if(p&&g>=9&&this.hasSelection===u||X&&/[\uf700-\uf7ff]/.test(u))return r.display.input.reset(),!1;if(r.doc.sel==r.display.selForContextMenu){var d=u.charCodeAt(0);if(d==8203&&!a&&(a="â€‹"),d==8666)return this.reset(),this.cm.execCommand("undo")}for(var m=0,y=Math.min(a.length,u.length);m<y&&a.charCodeAt(m)==u.charCodeAt(m);)++m;return Jt(r,function(){Ha(r,u.slice(m),a.length-m,null,t.composing?"*compose":null),u.length>1e3||u.indexOf(`
`)>-1?l.value=t.prevInput="":t.prevInput=u,t.composing&&(t.composing.range.clear(),t.composing.range=r.markText(t.composing.start,r.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},mt.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},mt.prototype.onKeyPress=function(){p&&g>=9&&(this.hasSelection=null),this.fastPoll()},mt.prototype.onContextMenu=function(t){var r=this,l=r.cm,a=l.display,u=r.textarea;r.contextMenuPending&&r.contextMenuPending();var d=xi(l,t),m=a.scroller.scrollTop;if(!d||L)return;var y=l.options.resetSelectionOnContextMenu;y&&l.doc.sel.contains(d)==-1&&St(l,Et)(l.doc,ri(d),Ie);var x=u.style.cssText,w=r.wrapper.style.cssText,M=r.wrapper.offsetParent.getBoundingClientRect();r.wrapper.style.cssText="position: static",u.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(t.clientY-M.top-5)+"px; left: "+(t.clientX-M.left-5)+`px;
      z-index: 1000; background: `+(p?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var O;b&&(O=window.scrollY),a.input.focus(),b&&window.scrollTo(null,O),a.input.reset(),l.somethingSelected()||(u.value=r.prevInput=" "),r.contextMenuPending=H,a.selForContextMenu=l.doc.sel,clearTimeout(a.detectingSelectAll);function W(){if(u.selectionStart!=null){var re=l.somethingSelected(),ue="â€‹"+(re?u.value:"");u.value="â‡š",u.value=ue,r.prevInput=re?"":"â€‹",u.selectionStart=1,u.selectionEnd=ue.length,a.selForContextMenu=l.doc.sel}}function H(){if(r.contextMenuPending==H&&(r.contextMenuPending=!1,r.wrapper.style.cssText=w,u.style.cssText=x,p&&g<9&&a.scrollbars.setScrollTop(a.scroller.scrollTop=m),u.selectionStart!=null)){(!p||p&&g<9)&&W();var re=0,ue=function(){a.selForContextMenu==l.doc.sel&&u.selectionStart==0&&u.selectionEnd>0&&r.prevInput=="â€‹"?St(l,iu)(l):re++<10?a.detectingSelectAll=setTimeout(ue,500):(a.selForContextMenu=null,a.input.reset())};a.detectingSelectAll=setTimeout(ue,200)}}if(p&&g>=9&&W(),he){mi(t);var q=function(){Ue(window,"mouseup",q),setTimeout(H,20)};ne(window,"mouseup",q)}else setTimeout(H,50)},mt.prototype.readOnlyChanged=function(t){t||this.reset(),this.textarea.disabled=t=="nocursor",this.textarea.readOnly=!!t},mt.prototype.setUneditable=function(){},mt.prototype.needsContentAttribute=!1;function zg(t,r){if(r=r?Ne(r):{},r.value=t.value,!r.tabindex&&t.tabIndex&&(r.tabindex=t.tabIndex),!r.placeholder&&t.placeholder&&(r.placeholder=t.placeholder),r.autofocus==null){var l=je();r.autofocus=l==t||t.getAttribute("autofocus")!=null&&l==document.body}function a(){t.value=y.getValue()}var u;if(t.form&&(ne(t.form,"submit",a),!r.leaveSubmitMethodAlone)){var d=t.form;u=d.submit;try{var m=d.submit=function(){a(),d.submit=u,d.submit(),d.submit=m}}catch{}}r.finishInit=function(x){x.save=a,x.getTextArea=function(){return t},x.toTextArea=function(){x.toTextArea=isNaN,a(),t.parentNode.removeChild(x.getWrapperElement()),t.style.display="",t.form&&(Ue(t.form,"submit",a),!r.leaveSubmitMethodAlone&&typeof t.form.submit=="function"&&(t.form.submit=u))}},t.style.display="none";var y=lt(function(x){return t.parentNode.insertBefore(x,t.nextSibling)},r);return y}function Wg(t){t.off=Ue,t.on=ne,t.wheelEventPixels=Xp,t.Doc=Kt,t.splitLines=_r,t.countColumn=Oe,t.findColumn=at,t.isWordChar=We,t.Pass=be,t.signal=Me,t.Line=ji,t.changeEnd=si,t.scrollbarModel=Ac,t.Pos=le,t.cmpPos=k,t.modes=fn,t.mimeModes=on,t.resolveMode=Bi,t.getMode=Ui,t.modeExtensions=yn,t.extendMode=bn,t.copyState=an,t.startState=Sr,t.innerMode=kr,t.commands=qr,t.keyMap=$n,t.keyName=bu,t.isModifierKey=vu,t.lookupKey=ir,t.normalizeKeyMap=gg,t.StringStream=ht,t.SharedTextMarker=Kr,t.TextMarker=ai,t.LineWidget=Vr,t.e_preventDefault=At,t.e_stopPropagation=Wi,t.e_stop=mi,t.addClass=Ye,t.contains=Le,t.rmClass=oe,t.keyNames=li}Pg(lt),Eg(lt);var Bg="iter insert remove copy getEditor constructor".split(" ");for(var co in Kt.prototype)Kt.prototype.hasOwnProperty(co)&&Z(Bg,co)<0&&(lt.prototype[co]=function(t){return function(){return t.apply(this.doc,arguments)}}(Kt.prototype[co]));return rn(Kt),lt.inputStyles={textarea:mt,contenteditable:it},lt.defineMode=function(t){!lt.defaults.mode&&t!="null"&&(lt.defaults.mode=t),Is.apply(this,arguments)},lt.defineMIME=Hn,lt.defineMode("null",function(){return{token:function(t){return t.skipToEnd()}}}),lt.defineMIME("text/plain","null"),lt.defineExtension=function(t,r){lt.prototype[t]=r},lt.defineDocExtension=function(t,r){Kt.prototype[t]=r},lt.fromTextArea=zg,Wg(lt),lt.version="5.65.2",lt})}(Lo)),Lo.exports}var ym=Vo();const Ls=mm(ym);var Qu={exports:{}},ef;function bm(){return ef||(ef=1,function(i,e){(function(n){n(Vo())})(function(n){n.defineMode("javascript",function(s,o){var c=s.indentUnit,f=o.statementIndent,h=o.jsonld,p=o.json||h,g=o.trackScope!==!1,b=o.typescript,_=o.wordCharacters||/[\w$\xa1-\uffff]/,T=function(){function k(It){return{type:It,style:"keyword"}}var A=k("keyword a"),ee=k("keyword b"),ce=k("keyword c"),Re=k("keyword d"),qe=k("operator"),ye={type:"atom",style:"atom"};return{if:k("if"),while:A,with:A,else:ee,do:ee,try:ee,finally:ee,return:Re,break:Re,continue:Re,new:k("new"),delete:ce,void:ce,throw:ce,debugger:k("debugger"),var:k("var"),const:k("var"),let:k("var"),function:k("function"),catch:k("catch"),for:k("for"),switch:k("switch"),case:k("case"),default:k("default"),in:qe,typeof:qe,instanceof:qe,true:ye,false:ye,null:ye,undefined:ye,NaN:ye,Infinity:ye,this:k("this"),class:k("class"),super:k("atom"),yield:ce,export:k("export"),import:k("import"),extends:ce,await:ce}}(),L=/[+\-*&%=<>!?|~^@]/,D=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function P(k){for(var A=!1,ee,ce=!1;(ee=k.next())!=null;){if(!A){if(ee=="/"&&!ce)return;ee=="["?ce=!0:ce&&ee=="]"&&(ce=!1)}A=!A&&ee=="\\"}}var N,E;function I(k,A,ee){return N=k,E=ee,A}function j(k,A){var ee=k.next();if(ee=='"'||ee=="'")return A.tokenize=X(ee),A.tokenize(k,A);if(ee=="."&&k.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return I("number","number");if(ee=="."&&k.match(".."))return I("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(ee))return I(ee);if(ee=="="&&k.eat(">"))return I("=>","operator");if(ee=="0"&&k.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return I("number","number");if(/\d/.test(ee))return k.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),I("number","number");if(ee=="/")return k.eat("*")?(A.tokenize=G,G(k,A)):k.eat("/")?(k.skipToEnd(),I("comment","comment")):le(k,A,1)?(P(k),k.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),I("regexp","string-2")):(k.eat("="),I("operator","operator",k.current()));if(ee=="`")return A.tokenize=K,K(k,A);if(ee=="#"&&k.peek()=="!")return k.skipToEnd(),I("meta","meta");if(ee=="#"&&k.eatWhile(_))return I("variable","property");if(ee=="<"&&k.match("!--")||ee=="-"&&k.match("->")&&!/\S/.test(k.string.slice(0,k.start)))return k.skipToEnd(),I("comment","comment");if(L.test(ee))return(ee!=">"||!A.lexical||A.lexical.type!=">")&&(k.eat("=")?(ee=="!"||ee=="=")&&k.eat("="):/[<>*+\-|&?]/.test(ee)&&(k.eat(ee),ee==">"&&k.eat(ee))),ee=="?"&&k.eat(".")?I("."):I("operator","operator",k.current());if(_.test(ee)){k.eatWhile(_);var ce=k.current();if(A.lastType!="."){if(T.propertyIsEnumerable(ce)){var Re=T[ce];return I(Re.type,Re.style,ce)}if(ce=="async"&&k.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return I("async","keyword",ce)}return I("variable","variable",ce)}}function X(k){return function(A,ee){var ce=!1,Re;if(h&&A.peek()=="@"&&A.match(D))return ee.tokenize=j,I("jsonld-keyword","meta");for(;(Re=A.next())!=null&&!(Re==k&&!ce);)ce=!ce&&Re=="\\";return ce||(ee.tokenize=j),I("string","string")}}function G(k,A){for(var ee=!1,ce;ce=k.next();){if(ce=="/"&&ee){A.tokenize=j;break}ee=ce=="*"}return I("comment","comment")}function K(k,A){for(var ee=!1,ce;(ce=k.next())!=null;){if(!ee&&(ce=="`"||ce=="$"&&k.eat("{"))){A.tokenize=j;break}ee=!ee&&ce=="\\"}return I("quasi","string-2",k.current())}var Y="([{}])";function Q(k,A){A.fatArrowAt&&(A.fatArrowAt=null);var ee=k.string.indexOf("=>",k.start);if(!(ee<0)){if(b){var ce=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(k.string.slice(k.start,ee));ce&&(ee=ce.index)}for(var Re=0,qe=!1,ye=ee-1;ye>=0;--ye){var It=k.string.charAt(ye),ln=Y.indexOf(It);if(ln>=0&&ln<3){if(!Re){++ye;break}if(--Re==0){It=="("&&(qe=!0);break}}else if(ln>=3&&ln<6)++Re;else if(_.test(It))qe=!0;else if(/["'\/`]/.test(It))for(;;--ye){if(ye==0)return;var $i=k.string.charAt(ye-1);if($i==It&&k.string.charAt(ye-2)!="\\"){ye--;break}}else if(qe&&!Re){++ye;break}}qe&&!Re&&(A.fatArrowAt=ye)}}var he={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function fe(k,A,ee,ce,Re,qe){this.indented=k,this.column=A,this.type=ee,this.prev=Re,this.info=qe,ce!=null&&(this.align=ce)}function oe(k,A){if(!g)return!1;for(var ee=k.localVars;ee;ee=ee.next)if(ee.name==A)return!0;for(var ce=k.context;ce;ce=ce.prev)for(var ee=ce.vars;ee;ee=ee.next)if(ee.name==A)return!0}function se(k,A,ee,ce,Re){var qe=k.cc;for(R.state=k,R.stream=Re,R.marked=null,R.cc=qe,R.style=A,k.lexical.hasOwnProperty("align")||(k.lexical.align=!0);;){var ye=qe.length?qe.pop():p?He:Ie;if(ye(ee,ce)){for(;qe.length&&qe[qe.length-1].lex;)qe.pop()();return R.marked?R.marked:ee=="variable"&&oe(k,ce)?"variable-2":A}}}var R={state:null,column:null,marked:null,cc:null};function F(){for(var k=arguments.length-1;k>=0;k--)R.cc.push(arguments[k])}function S(){return F.apply(null,arguments),!0}function ge(k,A){for(var ee=A;ee;ee=ee.next)if(ee.name==k)return!0;return!1}function Le(k){var A=R.state;if(R.marked="def",!!g){if(A.context){if(A.lexical.info=="var"&&A.context&&A.context.block){var ee=je(k,A.context);if(ee!=null){A.context=ee;return}}else if(!ge(k,A.localVars)){A.localVars=new Se(k,A.localVars);return}}o.globalVars&&!ge(k,A.globalVars)&&(A.globalVars=new Se(k,A.globalVars))}}function je(k,A){if(A)if(A.block){var ee=je(k,A.prev);return ee?ee==A.prev?A:new Ke(ee,A.vars,!0):null}else return ge(k,A.vars)?A:new Ke(A.prev,new Se(k,A.vars),!1);else return null}function Ye(k){return k=="public"||k=="private"||k=="protected"||k=="abstract"||k=="readonly"}function Ke(k,A,ee){this.prev=k,this.vars=A,this.block=ee}function Se(k,A){this.name=k,this.next=A}var _e=new Se("this",new Se("arguments",null));function Ne(){R.state.context=new Ke(R.state.context,R.state.localVars,!1),R.state.localVars=_e}function Oe(){R.state.context=new Ke(R.state.context,R.state.localVars,!0),R.state.localVars=null}Ne.lex=Oe.lex=!0;function U(){R.state.localVars=R.state.context.vars,R.state.context=R.state.context.prev}U.lex=!0;function Z(k,A){var ee=function(){var ce=R.state,Re=ce.indented;if(ce.lexical.type=="stat")Re=ce.lexical.indented;else for(var qe=ce.lexical;qe&&qe.type==")"&&qe.align;qe=qe.prev)Re=qe.indented;ce.lexical=new fe(Re,R.stream.column(),k,null,ce.lexical,A)};return ee.lex=!0,ee}function ie(){var k=R.state;k.lexical.prev&&(k.lexical.type==")"&&(k.indented=k.lexical.indented),k.lexical=k.lexical.prev)}ie.lex=!0;function be(k){function A(ee){return ee==k?S():k==";"||ee=="}"||ee==")"||ee=="]"?F():S(A)}return A}function Ie(k,A){return k=="var"?S(Z("vardef",A),br,be(";"),ie):k=="keyword a"?S(Z("form"),Ft,Ie,ie):k=="keyword b"?S(Z("form"),Ie,ie):k=="keyword d"?R.stream.match(/^\s*$/,!1)?S():S(Z("stat"),V,be(";"),ie):k=="debugger"?S(be(";")):k=="{"?S(Z("}"),Oe,J,ie,U):k==";"?S():k=="if"?(R.state.lexical.info=="else"&&R.state.cc[R.state.cc.length-1]==ie&&R.state.cc.pop()(),S(Z("form"),Ft,Ie,ie,Os)):k=="function"?S(fn):k=="for"?S(Z("form"),Oe,As,Ie,U,ie):k=="class"||b&&A=="interface"?(R.marked="keyword",S(Z("form",k=="class"?k:A),Ui,ie)):k=="variable"?b&&A=="declare"?(R.marked="keyword",S(Ie)):b&&(A=="module"||A=="enum"||A=="type")&&R.stream.match(/^\s*\w/,!1)?(R.marked="keyword",A=="enum"?S(Ln):A=="type"?S(Is,be("operator"),Me,be(";")):S(Z("form"),jt,be("{"),Z("}"),J,ie,ie)):b&&A=="namespace"?(R.marked="keyword",S(Z("form"),He,Ie,ie)):b&&A=="abstract"?(R.marked="keyword",S(Ie)):S(Z("stat"),vn):k=="switch"?S(Z("form"),Ft,be("{"),Z("}","switch"),Oe,J,ie,ie,U):k=="case"?S(He,be(":")):k=="default"?S(be(":")):k=="catch"?S(Z("form"),Ne,Ot,Ie,ie,U):k=="export"?S(Z("stat"),kr,ie):k=="import"?S(Z("stat"),ht,ie):k=="async"?S(Ie):A=="@"?S(He,Ie):F(Z("stat"),He,be(";"),ie)}function Ot(k){if(k=="(")return S(Hn,be(")"))}function He(k,A){return $t(k,A,!1)}function at(k,A){return $t(k,A,!0)}function Ft(k){return k!="("?F():S(Z(")"),V,be(")"),ie)}function $t(k,A,ee){if(R.state.fatArrowAt==R.stream.start){var ce=ee?We:Fe;if(k=="(")return S(Ne,Z(")"),te(Hn,")"),ie,be("=>"),ce,U);if(k=="variable")return F(Ne,jt,be("=>"),ce,U)}var Re=ee?Ae:me;return he.hasOwnProperty(k)?S(Re):k=="function"?S(fn,Re):k=="class"||b&&A=="interface"?(R.marked="keyword",S(Z("form"),Bi,ie)):k=="keyword c"||k=="async"?S(ee?at:He):k=="("?S(Z(")"),V,be(")"),ie,Re):k=="operator"||k=="spread"?S(ee?at:He):k=="["?S(Z("]"),Je,ie,Re):k=="{"?B(C,"}",null,Re):k=="quasi"?F(Ee,Re):k=="new"?S(ze(ee)):S()}function V(k){return k.match(/[;\}\)\],]/)?F():F(He)}function me(k,A){return k==","?S(V):Ae(k,A,!1)}function Ae(k,A,ee){var ce=ee==!1?me:Ae,Re=ee==!1?He:at;if(k=="=>")return S(Ne,ee?We:Fe,U);if(k=="operator")return/\+\+|--/.test(A)||b&&A=="!"?S(ce):b&&A=="<"&&R.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?S(Z(">"),te(Me,">"),ie,ce):A=="?"?S(He,be(":"),Re):S(Re);if(k=="quasi")return F(Ee,ce);if(k!=";"){if(k=="(")return B(at,")","call",ce);if(k==".")return S(un,ce);if(k=="[")return S(Z("]"),V,be("]"),ie,ce);if(b&&A=="as")return R.marked="keyword",S(Me,ce);if(k=="regexp")return R.state.lastType=R.marked="operator",R.stream.backUp(R.stream.pos-R.stream.start-1),S(Re)}}function Ee(k,A){return k!="quasi"?F():A.slice(A.length-2)!="${"?S(Ee):S(V,Ge)}function Ge(k){if(k=="}")return R.marked="string-2",R.state.tokenize=K,S(Ee)}function Fe(k){return Q(R.stream,R.state),F(k=="{"?Ie:He)}function We(k){return Q(R.stream,R.state),F(k=="{"?Ie:at)}function ze(k){return function(A){return A=="."?S(k?Fn:Ht):A=="variable"&&b?S(mi,k?Ae:me):F(k?at:He)}}function Ht(k,A){if(A=="target")return R.marked="keyword",S(me)}function Fn(k,A){if(A=="target")return R.marked="keyword",S(Ae)}function vn(k){return k==":"?S(ie,Ie):F(me,be(";"),ie)}function un(k){if(k=="variable")return R.marked="property",S()}function C(k,A){if(k=="async")return R.marked="property",S(C);if(k=="variable"||R.style=="keyword"){if(R.marked="property",A=="get"||A=="set")return S(z);var ee;return b&&R.state.fatArrowAt==R.stream.start&&(ee=R.stream.match(/^\s*:\s*/,!1))&&(R.state.fatArrowAt=R.stream.pos+ee[0].length),S($)}else{if(k=="number"||k=="string")return R.marked=h?"property":R.style+" property",S($);if(k=="jsonld-keyword")return S($);if(b&&Ye(A))return R.marked="keyword",S(C);if(k=="[")return S(He,xe,be("]"),$);if(k=="spread")return S(at,$);if(A=="*")return R.marked="keyword",S(C);if(k==":")return F($)}}function z(k){return k!="variable"?F($):(R.marked="property",S(fn))}function $(k){if(k==":")return S(at);if(k=="(")return F(fn)}function te(k,A,ee){function ce(Re,qe){if(ee?ee.indexOf(Re)>-1:Re==","){var ye=R.state.lexical;return ye.info=="call"&&(ye.pos=(ye.pos||0)+1),S(function(It,ln){return It==A||ln==A?F():F(k)},ce)}return Re==A||qe==A?S():ee&&ee.indexOf(";")>-1?F(k):S(be(A))}return function(Re,qe){return Re==A||qe==A?S():F(k,ce)}}function B(k,A,ee){for(var ce=3;ce<arguments.length;ce++)R.cc.push(arguments[ce]);return S(Z(A,ee),te(k,A),ie)}function J(k){return k=="}"?S():F(Ie,J)}function xe(k,A){if(b){if(k==":")return S(Me);if(A=="?")return S(xe)}}function ne(k,A){if(b&&(k==":"||A=="in"))return S(Me)}function Xe(k){if(b&&k==":")return R.stream.match(/^\s*\w+\s+is\b/,!1)?S(He,Ue,Me):S(Me)}function Ue(k,A){if(A=="is")return R.marked="keyword",S()}function Me(k,A){if(A=="keyof"||A=="typeof"||A=="infer"||A=="readonly")return R.marked="keyword",S(A=="typeof"?at:Me);if(k=="variable"||A=="void")return R.marked="type",S(sn);if(A=="|"||A=="&")return S(Me);if(k=="string"||k=="number"||k=="atom")return S(sn);if(k=="[")return S(Z("]"),te(Me,"]",","),ie,sn);if(k=="{")return S(Z("}"),Yt,ie,sn);if(k=="(")return S(te(Wi,")"),ot,sn);if(k=="<")return S(te(Me,">"),Me);if(k=="quasi")return F(rn,sn)}function ot(k){if(k=="=>")return S(Me)}function Yt(k){return k.match(/[\}\)\]]/)?S():k==","||k==";"?S(Yt):F(tt,Yt)}function tt(k,A){if(k=="variable"||R.style=="keyword")return R.marked="property",S(tt);if(A=="?"||k=="number"||k=="string")return S(tt);if(k==":")return S(Me);if(k=="[")return S(be("variable"),ne,be("]"),tt);if(k=="(")return F(on,tt);if(!k.match(/[;\}\)\],]/))return S()}function rn(k,A){return k!="quasi"?F():A.slice(A.length-2)!="${"?S(rn):S(Me,At)}function At(k){if(k=="}")return R.marked="string-2",R.state.tokenize=K,S(rn)}function Wi(k,A){return k=="variable"&&R.stream.match(/^\s*[?:]/,!1)||A=="?"?S(Wi):k==":"?S(Me):k=="spread"?S(Wi):F(Me)}function sn(k,A){if(A=="<")return S(Z(">"),te(Me,">"),ie,sn);if(A=="|"||k=="."||A=="&")return S(Me);if(k=="[")return S(Me,be("]"),sn);if(A=="extends"||A=="implements")return R.marked="keyword",S(Me);if(A=="?")return S(Me,be(":"),Me)}function mi(k,A){if(A=="<")return S(Z(">"),te(Me,">"),ie,sn)}function Qn(){return F(Me,Ds)}function Ds(k,A){if(A=="=")return S(Me)}function br(k,A){return A=="enum"?(R.marked="keyword",S(Ln)):F(jt,xe,Cn,_r)}function jt(k,A){if(b&&Ye(A))return R.marked="keyword",S(jt);if(k=="variable")return Le(A),S();if(k=="spread")return S(jt);if(k=="[")return B(xr,"]");if(k=="{")return B(Ps,"}")}function Ps(k,A){return k=="variable"&&!R.stream.match(/^\s*:/,!1)?(Le(A),S(Cn)):(k=="variable"&&(R.marked="property"),k=="spread"?S(jt):k=="}"?F():k=="["?S(He,be("]"),be(":"),Ps):S(be(":"),jt,Cn))}function xr(){return F(jt,Cn)}function Cn(k,A){if(A=="=")return S(at)}function _r(k){if(k==",")return S(br)}function Os(k,A){if(k=="keyword b"&&A=="else")return S(Z("form","else"),Ie,ie)}function As(k,A){if(A=="await")return S(As);if(k=="(")return S(Z(")"),wr,ie)}function wr(k){return k=="var"?S(br,ei):k=="variable"?S(ei):F(ei)}function ei(k,A){return k==")"?S():k==";"?S(ei):A=="in"||A=="of"?(R.marked="keyword",S(He,ei)):F(He,ei)}function fn(k,A){if(A=="*")return R.marked="keyword",S(fn);if(k=="variable")return Le(A),S(fn);if(k=="(")return S(Ne,Z(")"),te(Hn,")"),ie,Xe,Ie,U);if(b&&A=="<")return S(Z(">"),te(Qn,">"),ie,fn)}function on(k,A){if(A=="*")return R.marked="keyword",S(on);if(k=="variable")return Le(A),S(on);if(k=="(")return S(Ne,Z(")"),te(Hn,")"),ie,Xe,U);if(b&&A=="<")return S(Z(">"),te(Qn,">"),ie,on)}function Is(k,A){if(k=="keyword"||k=="variable")return R.marked="type",S(Is);if(A=="<")return S(Z(">"),te(Qn,">"),ie)}function Hn(k,A){return A=="@"&&S(He,Hn),k=="spread"?S(Hn):b&&Ye(A)?(R.marked="keyword",S(Hn)):b&&k=="this"?S(xe,Cn):F(jt,xe,Cn)}function Bi(k,A){return k=="variable"?Ui(k,A):yn(k,A)}function Ui(k,A){if(k=="variable")return Le(A),S(yn)}function yn(k,A){if(A=="<")return S(Z(">"),te(Qn,">"),ie,yn);if(A=="extends"||A=="implements"||b&&k==",")return A=="implements"&&(R.marked="keyword"),S(b?Me:He,yn);if(k=="{")return S(Z("}"),bn,ie)}function bn(k,A){if(k=="async"||k=="variable"&&(A=="static"||A=="get"||A=="set"||b&&Ye(A))&&R.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return R.marked="keyword",S(bn);if(k=="variable"||R.style=="keyword")return R.marked="property",S(an,bn);if(k=="number"||k=="string")return S(an,bn);if(k=="[")return S(He,xe,be("]"),an,bn);if(A=="*")return R.marked="keyword",S(bn);if(b&&k=="(")return F(on,bn);if(k==";"||k==",")return S(bn);if(k=="}")return S();if(A=="@")return S(He,bn)}function an(k,A){if(A=="!"||A=="?")return S(an);if(k==":")return S(Me,Cn);if(A=="=")return S(at);var ee=R.state.lexical.prev,ce=ee&&ee.info=="interface";return F(ce?on:fn)}function kr(k,A){return A=="*"?(R.marked="keyword",S(Zt,be(";"))):A=="default"?(R.marked="keyword",S(He,be(";"))):k=="{"?S(te(Sr,"}"),Zt,be(";")):F(Ie)}function Sr(k,A){if(A=="as")return R.marked="keyword",S(be("variable"));if(k=="variable")return F(at,Sr)}function ht(k){return k=="string"?S():k=="("?F(He):k=="."?F(me):F(Ce,Tn,Zt)}function Ce(k,A){return k=="{"?B(Ce,"}"):(k=="variable"&&Le(A),A=="*"&&(R.marked="keyword"),S(Cr))}function Tn(k){if(k==",")return S(Ce,Tn)}function Cr(k,A){if(A=="as")return R.marked="keyword",S(Ce)}function Zt(k,A){if(A=="from")return R.marked="keyword",S(He)}function Je(k){return k=="]"?S():F(te(at,"]"))}function Ln(){return F(Z("form"),jt,be("{"),Z("}"),te(vi,"}"),ie,ie)}function vi(){return F(jt,Cn)}function Tr(k,A){return k.lastType=="operator"||k.lastType==","||L.test(A.charAt(0))||/[,.]/.test(A.charAt(0))}function le(k,A,ee){return A.tokenize==j&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(A.lastType)||A.lastType=="quasi"&&/\{\s*$/.test(k.string.slice(0,k.pos-(ee||0)))}return{startState:function(k){var A={tokenize:j,lastType:"sof",cc:[],lexical:new fe((k||0)-c,0,"block",!1),localVars:o.localVars,context:o.localVars&&new Ke(null,null,!1),indented:k||0};return o.globalVars&&typeof o.globalVars=="object"&&(A.globalVars=o.globalVars),A},token:function(k,A){if(k.sol()&&(A.lexical.hasOwnProperty("align")||(A.lexical.align=!1),A.indented=k.indentation(),Q(k,A)),A.tokenize!=G&&k.eatSpace())return null;var ee=A.tokenize(k,A);return N=="comment"?ee:(A.lastType=N=="operator"&&(E=="++"||E=="--")?"incdec":N,se(A,ee,N,E,k))},indent:function(k,A){if(k.tokenize==G||k.tokenize==K)return n.Pass;if(k.tokenize!=j)return 0;var ee=A&&A.charAt(0),ce=k.lexical,Re;if(!/^\s*else\b/.test(A))for(var qe=k.cc.length-1;qe>=0;--qe){var ye=k.cc[qe];if(ye==ie)ce=ce.prev;else if(ye!=Os&&ye!=U)break}for(;(ce.type=="stat"||ce.type=="form")&&(ee=="}"||(Re=k.cc[k.cc.length-1])&&(Re==me||Re==Ae)&&!/^[,\.=+\-*:?[\(]/.test(A));)ce=ce.prev;f&&ce.type==")"&&ce.prev.type=="stat"&&(ce=ce.prev);var It=ce.type,ln=ee==It;return It=="vardef"?ce.indented+(k.lastType=="operator"||k.lastType==","?ce.info.length+1:0):It=="form"&&ee=="{"?ce.indented:It=="form"?ce.indented+c:It=="stat"?ce.indented+(Tr(k,A)?f||c:0):ce.info=="switch"&&!ln&&o.doubleIndentSwitch!=!1?ce.indented+(/^(?:case|default)\b/.test(A)?c:2*c):ce.align?ce.column+(ln?0:1):ce.indented+(ln?0:c)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:p?null:"/*",blockCommentEnd:p?null:"*/",blockCommentContinue:p?null:" * ",lineComment:p?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:p?"json":"javascript",jsonldMode:h,jsonMode:p,expressionAllowed:le,skipExpression:function(k){se(k,"atom","atom","true",new n.StringStream("",2,null))}}}),n.registerHelper("wordChars","javascript",/[\w$]/),n.defineMIME("text/javascript","javascript"),n.defineMIME("text/ecmascript","javascript"),n.defineMIME("application/javascript","javascript"),n.defineMIME("application/x-javascript","javascript"),n.defineMIME("application/ecmascript","javascript"),n.defineMIME("application/json",{name:"javascript",json:!0}),n.defineMIME("application/x-json",{name:"javascript",json:!0}),n.defineMIME("application/manifest+json",{name:"javascript",json:!0}),n.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),n.defineMIME("text/typescript",{name:"javascript",typescript:!0}),n.defineMIME("application/typescript",{name:"javascript",typescript:!0})})}()),Qu.exports}bm();var tf={exports:{}},nf;function xm(){return nf||(nf=1,function(i,e){(function(n){n(Vo())})(function(n){n.defineMode("lua",function(s,o){var c=s.indentUnit;function f(I){return new RegExp("^(?:"+I.join("|")+")","i")}function h(I){return new RegExp("^(?:"+I.join("|")+")$","i")}var p=h(o.specials||[]),g=h(["_G","_VERSION","assert","collectgarbage","dofile","error","getfenv","getmetatable","ipairs","load","loadfile","loadstring","module","next","pairs","pcall","print","rawequal","rawget","rawset","require","select","setfenv","setmetatable","tonumber","tostring","type","unpack","xpcall","coroutine.create","coroutine.resume","coroutine.running","coroutine.status","coroutine.wrap","coroutine.yield","debug.debug","debug.getfenv","debug.gethook","debug.getinfo","debug.getlocal","debug.getmetatable","debug.getregistry","debug.getupvalue","debug.setfenv","debug.sethook","debug.setlocal","debug.setmetatable","debug.setupvalue","debug.traceback","close","flush","lines","read","seek","setvbuf","write","io.close","io.flush","io.input","io.lines","io.open","io.output","io.popen","io.read","io.stderr","io.stdin","io.stdout","io.tmpfile","io.type","io.write","math.abs","math.acos","math.asin","math.atan","math.atan2","math.ceil","math.cos","math.cosh","math.deg","math.exp","math.floor","math.fmod","math.frexp","math.huge","math.ldexp","math.log","math.log10","math.max","math.min","math.modf","math.pi","math.pow","math.rad","math.random","math.randomseed","math.sin","math.sinh","math.sqrt","math.tan","math.tanh","os.clock","os.date","os.difftime","os.execute","os.exit","os.getenv","os.remove","os.rename","os.setlocale","os.time","os.tmpname","package.cpath","package.loaded","package.loaders","package.loadlib","package.path","package.preload","package.seeall","string.byte","string.char","string.dump","string.find","string.format","string.gmatch","string.gsub","string.len","string.lower","string.match","string.rep","string.reverse","string.sub","string.upper","table.concat","table.insert","table.maxn","table.remove","table.sort"]),b=h(["and","break","elseif","false","nil","not","or","return","true","function","end","if","then","else","do","while","repeat","until","for","in","local"]),_=h(["function","if","repeat","do","\\(","{"]),T=h(["end","until","\\)","}"]),L=f(["end","until","\\)","}","else","elseif"]);function D(I){for(var j=0;I.eat("=");)++j;return I.eat("["),j}function P(I,j){var X=I.next();return X=="-"&&I.eat("-")?I.eat("[")&&I.eat("[")?(j.cur=N(D(I),"comment"))(I,j):(I.skipToEnd(),"comment"):X=='"'||X=="'"?(j.cur=E(X))(I,j):X=="["&&/[\[=]/.test(I.peek())?(j.cur=N(D(I),"string"))(I,j):/\d/.test(X)?(I.eatWhile(/[\w.%]/),"number"):/[\w_]/.test(X)?(I.eatWhile(/[\w\\\-_.]/),"variable"):null}function N(I,j){return function(X,G){for(var K=null,Y;(Y=X.next())!=null;)if(K==null)Y=="]"&&(K=0);else if(Y=="=")++K;else if(Y=="]"&&K==I){G.cur=P;break}else K=null;return j}}function E(I){return function(j,X){for(var G=!1,K;(K=j.next())!=null&&!(K==I&&!G);)G=!G&&K=="\\";return G||(X.cur=P),"string"}}return{startState:function(I){return{basecol:I||0,indentDepth:0,cur:P}},token:function(I,j){if(I.eatSpace())return null;var X=j.cur(I,j),G=I.current();return X=="variable"&&(b.test(G)?X="keyword":g.test(G)?X="builtin":p.test(G)&&(X="variable-2")),X!="comment"&&X!="string"&&(_.test(G)?++j.indentDepth:T.test(G)&&--j.indentDepth),X},indent:function(I,j){var X=L.test(j);return I.basecol+c*(I.indentDepth-(X?1:0))},electricInput:/^\s*(?:end|until|else|\)|\})$/,lineComment:"--",blockCommentStart:"--[[",blockCommentEnd:"]]"}}),n.defineMIME("text/x-lua","lua")})}()),tf.exports}xm();var rf={exports:{}},sf;function _m(){return sf||(sf=1,function(i,e){(function(n){n(Vo())})(function(n){n.defineMode("haxe",function(s,o){var c=s.indentUnit;function f(C){return{type:C,style:"keyword"}}var h=f("keyword a"),p=f("keyword b"),g=f("keyword c"),b=f("operator"),_={type:"atom",style:"atom"},T={type:"attribute",style:"attribute"},E=f("typedef"),L={if:h,while:h,else:p,do:p,try:p,return:g,break:g,continue:g,new:g,throw:g,var:f("var"),inline:T,static:T,using:f("import"),public:T,private:T,cast:f("cast"),import:f("import"),macro:f("macro"),function:f("function"),catch:f("catch"),untyped:f("untyped"),callback:f("cb"),for:f("for"),switch:f("switch"),case:f("case"),default:f("default"),in:b,never:f("property_access"),trace:f("trace"),class:E,abstract:E,enum:E,interface:E,typedef:E,extends:E,implements:E,dynamic:E,true:_,false:_,null:_},D=/[+\-*&%=<>!?|]/;function P(C,z,$){return z.tokenize=$,$(C,z)}function N(C,z){for(var $=!1,te;(te=C.next())!=null;){if(te==z&&!$)return!0;$=!$&&te=="\\"}}var E,I;function j(C,z,$){return E=C,I=$,z}function X(C,z){var $=C.next();if($=='"'||$=="'")return P(C,z,G($));if(/[\[\]{}\(\),;\:\.]/.test($))return j($);if($=="0"&&C.eat(/x/i))return C.eatWhile(/[\da-f]/i),j("number","number");if(/\d/.test($)||$=="-"&&C.eat(/\d/))return C.match(/^\d*(?:\.\d*(?!\.))?(?:[eE][+\-]?\d+)?/),j("number","number");if(z.reAllowed&&$=="~"&&C.eat(/\//))return N(C,"/"),C.eatWhile(/[gimsu]/),j("regexp","string-2");if($=="/")return C.eat("*")?P(C,z,K):C.eat("/")?(C.skipToEnd(),j("comment","comment")):(C.eatWhile(D),j("operator",null,C.current()));if($=="#")return C.skipToEnd(),j("conditional","meta");if($=="@")return C.eat(/:/),C.eatWhile(/[\w_]/),j("metadata","meta");if(D.test($))return C.eatWhile(D),j("operator",null,C.current());var te;if(/[A-Z]/.test($))return C.eatWhile(/[\w_<>]/),te=C.current(),j("type","variable-3",te);C.eatWhile(/[\w_]/);var te=C.current(),B=L.propertyIsEnumerable(te)&&L[te];return B&&z.kwAllowed?j(B.type,B.style,te):j("variable","variable",te)}function G(C){return function(z,$){return N(z,C)&&($.tokenize=X),j("string","string")}}function K(C,z){for(var $=!1,te;te=C.next();){if(te=="/"&&$){z.tokenize=X;break}$=te=="*"}return j("comment","comment")}var Y={atom:!0,number:!0,variable:!0,string:!0,regexp:!0};function Q(C,z,$,te,B,J){this.indented=C,this.column=z,this.type=$,this.prev=B,this.info=J,te!=null&&(this.align=te)}function he(C,z){for(var $=C.localVars;$;$=$.next)if($.name==z)return!0}function fe(C,z,$,te,B){var J=C.cc;for(R.state=C,R.stream=B,R.marked=null,R.cc=J,C.lexical.hasOwnProperty("align")||(C.lexical.align=!0);;){var xe=J.length?J.pop():Oe;if(xe($,te)){for(;J.length&&J[J.length-1].lex;)J.pop()();return R.marked?R.marked:$=="variable"&&he(C,te)?"variable-2":$=="variable"&&oe(C,te)?"variable-3":z}}}function oe(C,z){if(/[a-z]/.test(z.charAt(0)))return!1;for(var $=C.importedtypes.length,te=0;te<$;te++)if(C.importedtypes[te]==z)return!0}function se(C){for(var z=R.state,$=z.importedtypes;$;$=$.next)if($.name==C)return;z.importedtypes={name:C,next:z.importedtypes}}var R={state:null,column:null,marked:null,cc:null};function F(){for(var C=arguments.length-1;C>=0;C--)R.cc.push(arguments[C])}function S(){return F.apply(null,arguments),!0}function ge(C,z){for(var $=z;$;$=$.next)if($.name==C)return!0;return!1}function Le(C){var z=R.state;if(z.context){if(R.marked="def",ge(C,z.localVars))return;z.localVars={name:C,next:z.localVars}}else if(z.globalVars){if(ge(C,z.globalVars))return;z.globalVars={name:C,next:z.globalVars}}}var je={name:"this",next:null};function Ye(){R.state.context||(R.state.localVars=je),R.state.context={prev:R.state.context,vars:R.state.localVars}}function Ke(){R.state.localVars=R.state.context.vars,R.state.context=R.state.context.prev}Ke.lex=!0;function Se(C,z){var $=function(){var te=R.state;te.lexical=new Q(te.indented,R.stream.column(),C,null,te.lexical,z)};return $.lex=!0,$}function _e(){var C=R.state;C.lexical.prev&&(C.lexical.type==")"&&(C.indented=C.lexical.indented),C.lexical=C.lexical.prev)}_e.lex=!0;function Ne(C){function z($){return $==C?S():C==";"?F():S(z)}return z}function Oe(C){return C=="@"?S(Ie):C=="var"?S(Se("vardef"),Ee,Ne(";"),_e):C=="keyword a"?S(Se("form"),U,Oe,_e):C=="keyword b"?S(Se("form"),Oe,_e):C=="{"?S(Se("}"),Ye,Ae,_e,Ke):C==";"?S():C=="attribute"?S(be):C=="function"?S(ze):C=="for"?S(Se("form"),Ne("("),Se(")"),Fe,Ne(")"),_e,Oe,_e):C=="variable"?S(Se("stat"),Ft):C=="switch"?S(Se("form"),U,Se("}","switch"),Ne("{"),Ae,_e,_e):C=="case"?S(U,Ne(":")):C=="default"?S(Ne(":")):C=="catch"?S(Se("form"),Ye,Ne("("),un,Ne(")"),Oe,_e,Ke):C=="import"?S(He,Ne(";")):C=="typedef"?S(at):F(Se("stat"),U,Ne(";"),_e)}function U(C){return Y.hasOwnProperty(C)||C=="type"?S(ie):C=="function"?S(ze):C=="keyword c"?S(Z):C=="("?S(Se(")"),Z,Ne(")"),_e,ie):C=="operator"?S(U):C=="["?S(Se("]"),me(Z,"]"),_e,ie):C=="{"?S(Se("}"),me(V,"}"),_e,ie):S()}function Z(C){return C.match(/[;\}\)\],]/)?F():F(U)}function ie(C,z){if(C=="operator"&&/\+\+|--/.test(z))return S(ie);if(C=="operator"||C==":")return S(U);if(C!=";"){if(C=="(")return S(Se(")"),me(U,")"),_e,ie);if(C==".")return S($t,ie);if(C=="[")return S(Se("]"),U,Ne("]"),_e,ie)}}function be(C){if(C=="attribute")return S(be);if(C=="function")return S(ze);if(C=="var")return S(Ee)}function Ie(C){if(C==":"||C=="variable")return S(Ie);if(C=="(")return S(Se(")"),me(Ot,")"),_e,Oe)}function Ot(C){if(C=="variable")return S()}function He(C,z){if(C=="variable"&&/[A-Z]/.test(z.charAt(0)))return se(z),S();if(C=="variable"||C=="property"||C=="."||z=="*")return S(He)}function at(C,z){if(C=="variable"&&/[A-Z]/.test(z.charAt(0)))return se(z),S();if(C=="type"&&/[A-Z]/.test(z.charAt(0)))return S()}function Ft(C){return C==":"?S(_e,Oe):F(ie,Ne(";"),_e)}function $t(C){if(C=="variable")return R.marked="property",S()}function V(C){if(C=="variable"&&(R.marked="property"),Y.hasOwnProperty(C))return S(Ne(":"),U)}function me(C,z){function $(te){return te==","?S(C,$):te==z?S():S(Ne(z))}return function(te){return te==z?S():F(C,$)}}function Ae(C){return C=="}"?S():F(Oe,Ae)}function Ee(C,z){return C=="variable"?(Le(z),S(Ht,Ge)):S()}function Ge(C,z){if(z=="=")return S(U,Ge);if(C==",")return S(Ee)}function Fe(C,z){return C=="variable"?(Le(z),S(We,U)):F()}function We(C,z){if(z=="in")return S()}function ze(C,z){if(C=="variable"||C=="type")return Le(z),S(ze);if(z=="new")return S(ze);if(C=="(")return S(Se(")"),Ye,me(un,")"),_e,Ht,Oe,Ke)}function Ht(C){if(C==":")return S(Fn)}function Fn(C){if(C=="type"||C=="variable")return S();if(C=="{")return S(Se("}"),me(vn,"}"),_e)}function vn(C){if(C=="variable")return S(Ht)}function un(C,z){if(C=="variable")return Le(z),S(Ht)}return{startState:function(C){var z=["Int","Float","String","Void","Std","Bool","Dynamic","Array"],$={tokenize:X,reAllowed:!0,kwAllowed:!0,cc:[],lexical:new Q((C||0)-c,0,"block",!1),localVars:o.localVars,importedtypes:z,context:o.localVars&&{vars:o.localVars},indented:0};return o.globalVars&&typeof o.globalVars=="object"&&($.globalVars=o.globalVars),$},token:function(C,z){if(C.sol()&&(z.lexical.hasOwnProperty("align")||(z.lexical.align=!1),z.indented=C.indentation()),C.eatSpace())return null;var $=z.tokenize(C,z);return E=="comment"?$:(z.reAllowed=!!(E=="operator"||E=="keyword c"||E.match(/^[\[{}\(,;:]$/)),z.kwAllowed=E!=".",fe(z,$,E,I,C))},indent:function(C,z){if(C.tokenize!=X)return 0;var $=z&&z.charAt(0),te=C.lexical;te.type=="stat"&&$=="}"&&(te=te.prev);var B=te.type,J=$==B;return B=="vardef"?te.indented+4:B=="form"&&$=="{"?te.indented:B=="stat"||B=="form"?te.indented+c:te.info=="switch"&&!J?te.indented+(/^(?:case|default)\b/.test(z)?c:2*c):te.align?te.column+(J?0:1):te.indented+(J?0:c)},electricChars:"{}",blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//"}}),n.defineMIME("text/x-haxe","haxe"),n.defineMode("hxml",function(){return{startState:function(){return{define:!1,inString:!1}},token:function(s,o){var h=s.peek(),c=s.sol();if(h=="#")return s.skipToEnd(),"comment";if(c&&h=="-"){var f="variable-2";return s.eat(/-/),s.peek()=="-"&&(s.eat(/-/),f="keyword a"),s.peek()=="D"&&(s.eat(/[D]/),f="keyword c",o.define=!0),s.eatWhile(/[A-Z]/i),f}var h=s.peek();return o.inString==!1&&h=="'"&&(o.inString=!0,s.next()),o.inString==!0?(s.skipTo("'")||s.skipToEnd(),s.peek()=="'"&&(s.next(),o.inString=!1),"string"):(s.next(),null)},lineComment:"#"}}),n.defineMIME("text/x-hxml","hxml")})}()),rf.exports}_m();const wm=[{label:"1 Minute",value:60},{label:"5 Minutes",value:300},{label:"15 Minutes",value:900},{label:"30 Minutes",value:1800},{label:"1 Hour",value:3600},{label:"3 Hours",value:10800},{label:"6 Hours",value:21600},{label:"12 Hours",value:43200},{label:"1 Day",value:86400},{label:"1 Week",value:604800}],of={en:{currentMode:"Current mode:",switchToRuleScript:"Switch to RuleScript",switchToLua:"Switch to Lua",placeholder:{rulescript:"// Write your HScript code here",lua:"-- Write your Lua code here"}}},km=({isDarkMode:i,language:e="en"})=>{const[n,s]=ae([]),[o,c]=ae(null),[f,h]=ae(!0),[p,g]=ae(null),b=gt(null),_=gt(null),[T,L]=ae(!1),[D,P]=ae(""),[N,E]=ae(""),[I,j]=ae(!1),[X,G]=ae(null),[K,Y]=ae("rulescript"),Q=of[e]||of.en,he=U=>{U!==K&&(Y(U),_.current&&(U==="rulescript"?_.current.setOption("mode","haxe"):_.current.setOption("mode",U),_.current.setOption("placeholder",Q.placeholder[U])),o&&fe(U,N))},fe=async(U,Z)=>{if(o)try{await Te.updateTask(o.id,{type:U}),s(n.map(ie=>ie.id===o.id?{...ie,script:Z,type:U}:ie))}catch(ie){console.error("Script type update failed:",ie),c(be=>be?{...be,output:`Error updating script type: ${ie.message}`}:null)}},oe=async()=>{try{const U=await Te.getTaskList();s(U),g(null)}catch(U){console.error("Tasks yÃ¼klenemedi:",U),g("Failed to load tasks")}finally{h(!1)}},se=async U=>{try{if(o&&N!==o.script&&!window.confirm("You have unsaved changes. Do you want to discard them?"))return;const Z=await Te.getTaskDetail(U);c(Z),E(Z.script||""),Y(Z.type||"rulescript"),P(""),L(!1),j(!1)}catch(Z){console.error("Task detayÄ± alÄ±namadÄ±:",Z)}},R=async(U,Z)=>{try{await Te.updateTask(U,{enabled:Z}),c(ie=>ie?{...ie,enabled:Z,script:N}:null),s(n.map(ie=>ie.id===U?{...ie,enabled:Z}:ie))}catch(ie){console.error("Task enable/disable edilemedi:",ie),c(be=>be?{...be,enabled:!Z,script:N}:null)}},F=async(U,Z)=>{try{const ie=parseInt(Z);await Te.updateTask(U,{frequency:ie}),c(be=>be?{...be,frequency:ie,script:N}:null),s(n.map(be=>be.id===U?{...be,frequency:ie}:be))}catch(ie){console.error("Frequency gÃ¼ncellenemedi:",ie)}},S=async(U,Z)=>{try{await Te.updateTask(U,{logs:Z}),c(ie=>ie?{...ie,logs:Z,script:N}:null),s(n.map(ie=>ie.id===U?{...ie,logs:Z}:ie))}catch(ie){console.error("Log ayarÄ± gÃ¼ncellenemedi:",ie),c(be=>be?{...be,logs:!Z,script:N}:null)}};Ve(()=>{(async()=>{await Promise.all([oe(),Oe()])})();const Z=setInterval(Oe,3e3);return()=>clearInterval(Z)},[]),Ve(()=>{if(o&&b.current){_.current&&_.current.toTextArea(),_.current=Ls.fromTextArea(b.current,{mode:K==="rulescript"?"haxe":K,theme:i?"monokai":"default",lineNumbers:!0,matchBrackets:!0,indentUnit:4,indentWithTabs:!0,readOnly:!1,autofocus:!0,placeholder:Q.placeholder[K]}),E(o.script||""),_.current.setValue(o.script||"");const U=Z=>{const ie=Z.getValue();E(ie)};return _.current.on("change",U),()=>{_.current&&(_.current.off("change",U),_.current.toTextArea(),_.current=null)}}},[o,i,K]);const ge=U=>U?new Date(U).toLocaleString():"Never",Le=async()=>{if(o)try{const U=N;c(Z=>Z?{...Z,output:""}:null),await Te.executeScriptStream(U,Z=>{c(ie=>ie?{...ie,output:ie.output?ie.output+Z:Z,script:N}:null)},K)}catch(U){console.error("Script Ã§alÄ±ÅŸtÄ±rÄ±lamadÄ±:",U),c(Z=>Z?{...Z,output:`Error: ${U.message}`,script:N}:null)}},je=async()=>{if(o)try{await Te.updateTask(o.id,{script:N,type:K}),c(U=>U?{...U,script:N,type:K,output:"Task saved successfully!"}:null),s(n.map(U=>U.id===o.id?{...U,script:N,type:K}:U))}catch(U){console.error("Script kaydedilemedi:",U);let Z=U.message;Z.includes("rulescript:")&&(Z=Z.split(`
`)[0].replace("rulescript:","Line ").replace("Unexpected token:","Syntax error:")),c(ie=>ie?{...ie,output:`Error saving task: ${Z}`}:null)}},Ye=()=>{o&&(P(o.name),L(!0))},Ke=async()=>{if(o)try{await Te.updateTask(o.id,{name:D}),c(U=>U?{...U,name:D,script:N}:null),s(n.map(U=>U.id===o.id?{...U,name:D}:U)),L(!1)}catch(U){console.error("Ä°sim gÃ¼ncellenemedi:",U)}},Se=async()=>{try{const U=await Te.createTask("New Task");U.type||(U.type="rulescript"),s([...n,U]),c(U),Y(U.type),E("")}catch(U){console.error("Task oluÅŸturulamadÄ±:",U)}},_e=async(U,Z)=>{if(Z.stopPropagation(),!!window.confirm("Are you sure you want to delete this task?"))try{(await Te.deleteTask(U)).success&&(s(be=>be.filter(Ie=>Ie.id!==U)),(o==null?void 0:o.id)===U&&(c(null),E(""),_.current&&_.current.setValue("")))}catch(ie){console.error("Task silinemedi:",ie),alert("Failed to delete task: "+ie.message)}},Ne=async()=>{if(o)try{j(!0),c(U=>U?{...U,logContent:"",output:U.output}:null),await Te.streamTaskLog(o.id,U=>{c(Z=>Z?{...Z,logContent:(Z.logContent||"")+U}:null)})}catch(U){console.error("Loglar alÄ±namadÄ±:",U),c(Z=>Z?{...Z,logContent:`Error loading logs: ${U.message}`}:null)}},Oe=async()=>{try{const U=await Te.getTaskStatus();Array.isArray(U)||console.warn("getTaskStatus returned non-array:",U);const Z=Array.isArray(U)?U:[],ie=Z.find(be=>be.status===1);if(G(ie||null),s(be=>be.map(Ie=>{const Ot=Z.find(He=>He.id===Ie.id);return Ot?{...Ie,lastRun:Ot.lastRun,status:Ot.status}:Ie})),o){const be=Z.find(Ie=>Ie.id===o.id);be&&c(Ie=>Ie?{...Ie,lastRun:be.lastRun,status:be.status,script:N}:null)}}catch(U){console.error("Task status alÄ±namadÄ±:",U),G(null)}};return v("div",{className:`scheduler ${i?"dark":""}`,children:[v("div",{className:"task-list",children:[v("div",{className:"task-list-header",children:[v("h2",{children:"Tasks"}),v("div",{className:"task-list-actions",children:[v("button",{className:"create-task icon",onClick:Se,title:"Create New Task",children:"+"}),v("button",{onClick:oe,className:"refresh-button icon",title:"Refresh Tasks",children:"ğŸ”„"})]})]}),f?v("div",{className:"loading",children:"Loading tasks..."}):p?v("div",{className:"error",children:p}):v("div",{className:"task-items",children:n.map(U=>v("div",{className:`task-item ${(o==null?void 0:o.id)===U.id?"selected":""} ${(X==null?void 0:X.id)===U.id?"running":""}`,onClick:()=>se(U.id),children:[v("div",{className:"task-item-header",children:[v("span",{className:"task-name",children:U.name}),v("div",{className:"task-item-actions",children:[v("label",{className:"task-enabled-toggle",onClick:Z=>Z.stopPropagation(),children:[v("input",{type:"checkbox",checked:U.enabled,onChange:Z=>{Z.stopPropagation(),R(U.id,!U.enabled)}}),v("span",{className:"checkmark"})]}),v("button",{className:"delete-task",onClick:Z=>_e(U.id,Z),title:"Delete Task",children:"Ã—"})]})]}),v("div",{className:"task-item-footer",children:v("span",{className:"task-last-run",children:["Last Run: ",ge(U.lastRun)]})})]},U.id))})]}),v("div",{className:"task-detail",children:o?v(Dt,{children:[v("div",{className:"task-header",children:T?v("div",{className:"name-edit",children:[v("input",{type:"text",value:D,onChange:U=>P(U.target.value),onKeyDown:U=>{U.key==="Enter"&&Ke(),U.key==="Escape"&&L(!1)},autoFocus:!0}),v("button",{className:"name-save",onClick:Ke,children:"âœ“"}),v("button",{className:"name-cancel",onClick:()=>L(!1),children:"âœ•"})]}):v("h2",{onClick:Ye,children:o.name})}),v("div",{className:"script-section",children:[v("div",{className:"script-header",children:[v("h3",{children:"Script"}),v("div",{className:"language-selector",children:[v("span",{children:[Q.currentMode," "]}),v("div",{className:"language-buttons",children:[v("button",{className:`language-btn ${K==="rulescript"?"active":""}`,onClick:()=>he("rulescript"),children:"RuleScript"}),v("button",{className:`language-btn ${K==="lua"?"active":""}`,onClick:()=>he("lua"),children:"Lua"})]})]}),v("div",{className:"script-actions",children:[v("button",{className:"script-button try",onClick:Le,children:"Try"}),v("button",{className:"script-button save",onClick:je,children:"Save"}),v("button",{className:"script-button logs",onClick:Ne,children:"Logs"})]})]}),v("div",{className:"editor-container",children:v("textarea",{ref:b})}),o.output&&v("div",{className:"script-output",children:[v("div",{className:"output-header",children:[v("h3",{children:"Output"}),v("button",{className:"close-output",onClick:()=>c(U=>U?{...U,output:void 0}:null),children:"Ã—"})]}),v("pre",{className:"output-content",children:o.output})]}),I&&o.logContent&&v("div",{className:"script-output logs",children:[v("div",{className:"output-header",children:[v("h3",{children:"Logs"}),v("button",{className:"close-output",onClick:()=>{j(!1),c(U=>U?{...U,logContent:void 0}:null)},children:"Ã—"})]}),v("pre",{className:"output-content",children:o.logContent})]})]}),v("div",{className:"detail-section",children:[v("div",{className:"detail-row",children:[v("span",{children:"Status:"}),v("span",{className:`status-${o.status}`,children:o.enabled?"Enabled":"Disabled"})]}),v("div",{className:"detail-row",children:[v("span",{children:"Created:"}),v("span",{children:ge(o.createdAt)})]}),v("div",{className:"detail-row",children:[v("span",{children:"Last Run:"}),v("span",{children:ge(o.lastRun)})]}),v("div",{className:"detail-row",children:[v("span",{children:"Frequency:"}),v("select",{className:"frequency-select",value:o.frequency,onChange:U=>F(o.id,U.target.value),children:wm.map(U=>v("option",{value:U.value,children:U.label},U.value))})]}),v("div",{className:"detail-row",children:[v("span",{children:"Success/Failed:"}),v("span",{children:[o.success,"/",o.failed]})]}),v("div",{className:"detail-row",children:[v("span",{children:"Save Logs:"}),v("label",{className:"task-logs-toggle",children:[v("input",{type:"checkbox",checked:o.logs,onChange:()=>S(o.id,!o.logs)}),v("span",{className:"checkmark"})]})]})]})]}):v("div",{className:"no-selection",children:"Select a task to view details"})})]})},af={en:{run:"â–¶ Run",placeholder:{rulescript:"// Write your HScript code here",lua:"-- Write your Lua code here"},executedCode:"Executed code:",result:"Result:",switchToRuleScript:"Switch to RuleScript",switchToLua:"Switch to Lua",currentMode:"Current mode:"}},Sm=({isDarkMode:i,language:e="en"})=>{const[n,s]=ae('sceKernelSendNotificationRequest("Hello World");'),[o,c]=ae(""),[f,h]=ae("rulescript"),p=gt(null),g=gt(null),b=af[e]||af.en,_={rulescript:'sceKernelSendNotificationRequest("Hello World");',lua:`function main()
	sceKernelSendNotificationRequest("Hello World")
end`},T=D=>{D!==f&&(n.trim()!==""&&n!==_[f]&&!confirm("Switching language will reset your current code. Continue?")||(h(D),s(_[D]),g.current&&(D==="rulescript"?g.current.setOption("mode","haxe"):g.current.setOption("mode",D),g.current.setValue(_[D]),g.current.setOption("placeholder",b.placeholder[D]))))};Ve(()=>{if(!g.current&&p.current){const D=document.createElement("textarea");p.current.appendChild(D),g.current=Ls.fromTextArea(D,{value:n,mode:f==="rulescript"?"haxe":f,theme:i?"monokai":"default",lineNumbers:!0,matchBrackets:!0,indentUnit:4,indentWithTabs:!0,placeholder:b.placeholder[f]}),g.current.on("change",P=>{s(P.getValue())}),g.current.setValue(n)}return()=>{g.current&&(g.current.toTextArea(),g.current=null)}},[]),Ve(()=>{g.current&&g.current.setOption("theme",i?"monokai":"default")},[i]);const L=async()=>{c("");try{await Te.executeScriptStream(n,D=>{c(P=>P+D)},f)}catch(D){c("Error: "+D.message)}};return v("div",{className:`script-editor ${i?"dark":""}`,children:v("div",{className:"script-content",children:[v("div",{className:"language-selector",children:[v("span",{children:[b.currentMode," "]}),v("div",{className:"language-buttons",children:[v("button",{className:`language-btn ${f==="rulescript"?"active":""}`,onClick:()=>T("rulescript"),children:"RuleScript"}),v("button",{className:`language-btn ${f==="lua"?"active":""}`,onClick:()=>T("lua"),children:"Lua"})]})]}),v("div",{className:"editor-container",ref:p}),v("div",{className:"script-output",children:[v("div",{className:"output-toolbar",children:v("button",{className:"run-btn",onClick:L,children:b.run})}),v("div",{className:"output-content",children:v("pre",{children:typeof o=="string"?o:JSON.stringify(o,null,2)})})]})]})})},Cm=({isDarkMode:i,onOpenWindow:e})=>{const[n,s]=ae([]),[o,c]=ae(!0),[f,h]=ae(null),[p,g]=ae(""),[b,_]=ae(!1),T=async(N="")=>{try{c(!0);const E=N?await Te.searchRemoteScripts(N):await Te.getRemoteScripts();s(E),h(null)}catch(E){console.error("Failed to fetch scripts:",E),h("Failed to load scripts. Please try again later.")}finally{c(!1),_(!1)}};Ve(()=>{T()},[]);const L=N=>{N.preventDefault(),_(!0),T(p)},D=N=>{e({app:"scriptDetail",title:N.name,props:{scriptKey:N.key,scriptName:N.name,authorName:N.authorName,authorSrc:N.authorSrc}})},P=N=>{N.currentTarget instanceof HTMLImageElement&&(N.currentTarget.onerror=null,N.currentTarget.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23f0f0f0'/%3E%3Ctext x='50' y='50' font-family='Arial' font-size='20' text-anchor='middle' alignment-baseline='middle' fill='%23999'%3ENo Image%3C/text%3E%3C/svg%3E")};return o?v("div",{className:`script-store ${i?"dark":""}`,children:v("div",{className:"script-store-loading",children:[v("div",{className:"loading-spinner"}),v("p",{children:"Loading scripts..."})]})}):f?v("div",{className:`script-store ${i?"dark":""}`,children:v("div",{className:"script-store-error",children:[v("p",{children:f}),v("button",{className:"retry-button",onClick:()=>{h(null),T()},children:"Retry"})]})}):v("div",{className:`script-store ${i?"dark":""}`,children:[v("div",{className:"script-store-header",children:[v("div",{className:"header-left",children:[v("h2",{children:"Script Store"}),v("p",{children:"Browse and run community scripts"})]}),v("div",{className:"header-right",children:v("form",{onSubmit:L,className:"search-form",children:[v("input",{type:"text",placeholder:"Search scripts...",value:p,onChange:N=>g(N.currentTarget.value),className:"search-input"}),v("button",{type:"submit",className:"search-button",disabled:b,children:b?"Searching...":"Search"})]})})]}),v("div",{className:"script-grid",children:n.length===0?v("div",{className:"no-scripts-message",children:p?`No scripts found for "${p}"`:"No scripts available at the moment."}):n.map(N=>v("div",{className:"script-card",onClick:()=>D(N),children:[v("div",{className:"script-image",children:v("img",{src:Te.getScriptImageUrl(N.key),alt:N.name,onError:P})}),v("div",{className:"script-info",children:[v("h3",{children:N.name}),v("a",{href:N.authorSrc,className:"script-author",onClick:E=>{E.preventDefault(),E.stopPropagation(),window.open(N.authorSrc,"_blank","noopener,noreferrer")},children:N.authorName})]})]},N.key))})]})},Tm=({isDarkMode:i,scriptKey:e,scriptName:n,authorName:s,authorSrc:o})=>{const[c,f]=ae(!1),[h,p]=ae(""),[g,b]=ae(null),[_,T]=ae(null),[L,D]=ae(!0),[P,N]=ae(!1),E=gt(null),I=gt(null);Ve(()=>{(async()=>{try{D(!0);const he=(await Te.getRemoteScripts()).find(fe=>fe.key===e);T(he?{key:e,name:n||he.name,authorName:s||he.authorName,authorSrc:o||he.authorSrc,description:he.description||"",type:he.type||"rulescript"}:{key:e,name:n,authorName:s,authorSrc:o,description:"",type:"rulescript"}),b(null)}catch(Q){console.error("Failed to fetch script details:",Q),b("Failed to load script details. Please try again later."),T({key:e,name:n,authorName:s,authorSrc:o,description:"",type:"rulescript"})}finally{D(!1)}})()},[e,n,s,o]),Ve(()=>()=>{I.current&&clearInterval(I.current)},[]);const j=async()=>{try{f(!0),p(""),b(null),I.current=window.setInterval(async()=>{try{await Te.sendHeartbeat()}catch(Y){console.error("Heartbeat error:",Y),I.current&&(clearInterval(I.current),I.current=null)}},1e3),await Te.executeRemoteScriptStream(e,Y=>{p(Q=>Q+Y),E.current&&(E.current.scrollTop=E.current.scrollHeight)}),I.current&&(clearInterval(I.current),I.current=null)}catch(Y){console.error("Script execution failed:",Y),b(Y.message||"Script execution failed"),I.current&&(clearInterval(I.current),I.current=null)}finally{f(!1)}},X=()=>{const Y=(_==null?void 0:_.type)==="lua"?".lua":".hx";window.open(`https://github.com/barisyild/airpsx.com/blob/master/scripts/${e}/${e}${Y}`,"_blank")},G=Y=>Y?Y.split(`
`).length>3:!1,K=()=>{if(!(_!=null&&_.description))return null;const Y=_.description;if(!P&&G(Y)){const he=Y.split(`
`).slice(0,3).join(`
`);return v("div",{className:"script-description-container",children:[v("div",{className:"script-description",dangerouslySetInnerHTML:{__html:he}}),v("button",{className:"show-more-button",onClick:()=>N(!0),children:"Show More"})]})}return v("div",{className:"script-description-container",children:[v("div",{className:"script-description",dangerouslySetInnerHTML:{__html:Y}}),P&&G(Y)&&v("button",{className:"show-less-button",onClick:()=>N(!1),children:"Show Less"})]})};return L?v("div",{className:`script-detail ${i?"dark":""}`,children:v("div",{className:"script-detail-loading",children:[v("div",{className:"loading-spinner"}),v("p",{children:"Loading script details..."})]})}):g&&!_?v("div",{className:`script-detail ${i?"dark":""}`,children:v("div",{className:"script-detail-error",children:[v("p",{children:g}),v("button",{className:"retry-button",onClick:()=>window.location.reload(),children:"Retry"})]})}):v("div",{className:`script-detail ${i?"dark":""}`,children:[v("div",{className:"script-detail-header",children:[v("div",{className:"script-detail-info",children:[v("div",{className:"script-detail-image",children:v("img",{src:Te.getScriptImageUrl(e),alt:n,onError:Y=>{Y.currentTarget instanceof HTMLImageElement&&(Y.currentTarget.onerror=null,Y.currentTarget.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23f0f0f0'/%3E%3Ctext x='50' y='50' font-family='Arial' font-size='20' text-anchor='middle' alignment-baseline='middle' fill='%23999'%3ENo Image%3C/text%3E%3C/svg%3E")}})}),v("div",{className:"script-detail-text",children:[v("h2",{children:n}),v("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"author-link",children:s}),v("div",{className:"source-code-link",onClick:X,children:[v("span",{className:"code-icon",children:"</>"})," View source on GitHub"]}),K()]})]}),v("div",{className:"script-detail-actions",children:v("button",{className:`execute-button ${c?"executing":""}`,onClick:j,disabled:c,children:c?"Executing...":"Execute Script"})})]}),v("div",{className:"script-detail-output-container",children:[v("div",{className:"output-header",children:[v("h3",{children:"Output"}),h&&v("button",{className:"clear-button",onClick:()=>p(""),disabled:c,children:"Clear"})]}),v("div",{className:"script-output",ref:E,children:[g&&v("div",{className:"script-error",children:g}),h?v("pre",{children:h}):v("div",{className:"no-output",children:g?"Execution failed. Try again?":"Execute the script to see output here."})]})]})]})};function Xh(i,e){for(var n in e)i[n]=e[n];return i}function sl(i,e){for(var n in i)if(n!=="__source"&&!(n in e))return!0;for(var s in e)if(s!=="__source"&&i[s]!==e[s])return!0;return!1}function Gh(i,e){var n=e(),s=ae({t:{__:n,u:e}}),o=s[0].t,c=s[1];return Ts(function(){o.__=n,o.u=e,ja(o)&&c({t:o})},[i,n,e]),Ve(function(){return ja(o)&&c({t:o}),i(function(){ja(o)&&c({t:o})})},[i]),n}function ja(i){var e,n,s=i.u,o=i.__;try{var c=s();return!((e=o)===(n=c)&&(e!==0||1/e==1/n)||e!=e&&n!=n)}catch{return!0}}function qh(i){i()}function Yh(i){return i}function Zh(){return[!1,qh]}var Jh=Ts;function ol(i,e){this.props=i,this.context=e}function Lm(i,e){function n(o){var c=this.props.ref,f=c==o.ref;return!f&&c&&(c.call?c(null):c.current=null),e?!e(this.props,o)||!f:sl(this.props,o)}function s(o){return this.shouldComponentUpdate=n,Zn(i,o)}return s.displayName="Memo("+(i.displayName||i.name)+")",s.prototype.isReactComponent=!0,s.__f=!0,s}(ol.prototype=new En).isPureReactComponent=!0,ol.prototype.shouldComponentUpdate=function(i,e){return sl(this.props,i)||sl(this.state,e)};var lf=$e.__b;$e.__b=function(i){i.type&&i.type.__f&&i.ref&&(i.props.ref=i.ref,i.ref=null),lf&&lf(i)};var Nm=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Cl(i){function e(n){var s=Xh({},n);return delete s.ref,i(s,n.ref||null)}return e.$$typeof=Nm,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(i.displayName||i.name)+")",e}var cf=function(i,e){return i==null?null:Yn(Yn(i).map(e))},Mm={map:cf,forEach:cf,count:function(i){return i?Yn(i).length:0},only:function(i){var e=Yn(i);if(e.length!==1)throw"Children.only";return e[0]},toArray:Yn},Dm=$e.__e;$e.__e=function(i,e,n,s){if(i.then){for(var o,c=e;c=c.__;)if((o=c.__c)&&o.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),o.__c(i,e)}Dm(i,e,n,s)};var uf=$e.unmount;function Qh(i,e,n){return i&&(i.__c&&i.__c.__H&&(i.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),i.__c.__H=null),(i=Xh({},i)).__c!=null&&(i.__c.__P===n&&(i.__c.__P=e),i.__c=null),i.__k=i.__k&&i.__k.map(function(s){return Qh(s,e,n)})),i}function ed(i,e,n){return i&&n&&(i.__v=null,i.__k=i.__k&&i.__k.map(function(s){return ed(s,e,n)}),i.__c&&i.__c.__P===e&&(i.__e&&n.appendChild(i.__e),i.__c.__e=!0,i.__c.__P=n)),i}function No(){this.__u=0,this.o=null,this.__b=null}function td(i){var e=i.__.__c;return e&&e.__a&&e.__a(i)}function Pm(i){var e,n,s;function o(c){if(e||(e=i()).then(function(f){n=f.default||f},function(f){s=f}),s)throw s;if(!n)throw e;return Zn(n,c)}return o.displayName="Lazy",o.__f=!0,o}function ss(){this.i=null,this.l=null}$e.unmount=function(i){var e=i.__c;e&&e.__R&&e.__R(),e&&32&i.__u&&(i.type=null),uf&&uf(i)},(No.prototype=new En).__c=function(i,e){var n=e.__c,s=this;s.o==null&&(s.o=[]),s.o.push(n);var o=td(s.__v),c=!1,f=function(){c||(c=!0,n.__R=null,o?o(h):h())};n.__R=f;var h=function(){if(!--s.__u){if(s.state.__a){var p=s.state.__a;s.__v.__k[0]=ed(p,p.__c.__P,p.__c.__O)}var g;for(s.setState({__a:s.__b=null});g=s.o.pop();)g.forceUpdate()}};s.__u++||32&e.__u||s.setState({__a:s.__b=s.__v.__k[0]}),i.then(f,f)},No.prototype.componentWillUnmount=function(){this.o=[]},No.prototype.render=function(i,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=Qh(this.__b,n,s.__O=s.__P)}this.__b=null}var o=e.__a&&Zn(Dt,null,i.fallback);return o&&(o.__u&=-33),[Zn(Dt,null,e.__a?null:i.children),o]};var ff=function(i,e,n){if(++n[1]===n[0]&&i.l.delete(e),i.props.revealOrder&&(i.props.revealOrder[0]!=="t"||!i.l.size))for(n=i.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;i.i=n=n[2]}};function Om(i){return this.getChildContext=function(){return i.context},i.children}function Am(i){var e=this,n=i.h;e.componentWillUnmount=function(){Fi(null,e.v),e.v=null,e.h=null},e.h&&e.h!==n&&e.componentWillUnmount(),e.v||(e.h=n,e.v={nodeType:1,parentNode:n,childNodes:[],contains:function(){return!0},appendChild:function(s){this.childNodes.push(s),e.h.appendChild(s)},insertBefore:function(s,o){this.childNodes.push(s),e.h.insertBefore(s,o)},removeChild:function(s){this.childNodes.splice(this.childNodes.indexOf(s)>>>1,1),e.h.removeChild(s)}}),Fi(Zn(Om,{context:e.context},i.__v),e.v)}function Im(i,e){var n=Zn(Am,{__v:i,h:e});return n.containerInfo=e,n}(ss.prototype=new En).__a=function(i){var e=this,n=td(e.__v),s=e.l.get(i);return s[0]++,function(o){var c=function(){e.props.revealOrder?(s.push(o),ff(e,i,s)):o()};n?n(c):c()}},ss.prototype.render=function(i){this.i=null,this.l=new Map;var e=Yn(i.children);i.revealOrder&&i.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.l.set(e[n],this.i=[1,0,this.i]);return i.children},ss.prototype.componentDidUpdate=ss.prototype.componentDidMount=function(){var i=this;this.l.forEach(function(e,n){ff(i,n,e)})};var nd=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Em=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Rm=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Fm=/[A-Z0-9]/g,Hm=typeof document<"u",zm=function(i){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(i)};function Wm(i,e,n){return e.__k==null&&(e.textContent=""),Fi(i,e),typeof n=="function"&&n(),i?i.__c:null}function Bm(i,e,n){return Fh(i,e),typeof n=="function"&&n(),i?i.__c:null}En.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(i){Object.defineProperty(En.prototype,i,{configurable:!0,get:function(){return this["UNSAFE_"+i]},set:function(e){Object.defineProperty(this,i,{configurable:!0,writable:!0,value:e})}})});var hf=$e.event;function Um(){}function $m(){return this.cancelBubble}function jm(){return this.defaultPrevented}$e.event=function(i){return hf&&(i=hf(i)),i.persist=Um,i.isPropagationStopped=$m,i.isDefaultPrevented=jm,i.nativeEvent=i};var Tl,Vm={enumerable:!1,configurable:!0,get:function(){return this.class}},df=$e.vnode;$e.vnode=function(i){typeof i.type=="string"&&function(e){var n=e.props,s=e.type,o={},c=s.indexOf("-")===-1;for(var f in n){var h=n[f];if(!(f==="value"&&"defaultValue"in n&&h==null||Hm&&f==="children"&&s==="noscript"||f==="class"||f==="className")){var p=f.toLowerCase();f==="defaultValue"&&"value"in n&&n.value==null?f="value":f==="download"&&h===!0?h="":p==="translate"&&h==="no"?h=!1:p[0]==="o"&&p[1]==="n"?p==="ondoubleclick"?f="ondblclick":p!=="onchange"||s!=="input"&&s!=="textarea"||zm(n.type)?p==="onfocus"?f="onfocusin":p==="onblur"?f="onfocusout":Rm.test(f)&&(f=p):p=f="oninput":c&&Em.test(f)?f=f.replace(Fm,"-$&").toLowerCase():h===null&&(h=void 0),p==="oninput"&&o[f=p]&&(f="oninputCapture"),o[f]=h}}s=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=Yn(n.children).forEach(function(g){g.props.selected=o.value.indexOf(g.props.value)!=-1})),s=="select"&&o.defaultValue!=null&&(o.value=Yn(n.children).forEach(function(g){g.props.selected=o.multiple?o.defaultValue.indexOf(g.props.value)!=-1:o.defaultValue==g.props.value})),n.class&&!n.className?(o.class=n.class,Object.defineProperty(o,"className",Vm)):(n.className&&!n.class||n.class&&n.className)&&(o.class=o.className=n.className),e.props=o}(i),i.$$typeof=nd,df&&df(i)};var pf=$e.__r;$e.__r=function(i){pf&&pf(i),Tl=i.__c};var gf=$e.diffed;$e.diffed=function(i){gf&&gf(i);var e=i.props,n=i.__e;n!=null&&i.type==="textarea"&&"value"in e&&e.value!==n.value&&(n.value=e.value==null?"":e.value),Tl=null};var Km={ReactCurrentDispatcher:{current:{readContext:function(i){return Tl.__n[i.__c].props.value},useCallback:Wh,useContext:Bh,useDebugValue:Uh,useDeferredValue:Yh,useEffect:Ve,useId:$h,useImperativeHandle:zh,useInsertionEffect:Jh,useLayoutEffect:Ts,useMemo:jo,useReducer:kl,useRef:gt,useState:ae,useSyncExternalStore:Gh,useTransition:Zh}}};function Xm(i){return Zn.bind(null,i)}function Ko(i){return!!i&&i.$$typeof===nd}function Gm(i){return Ko(i)&&i.type===Dt}function qm(i){return!!i&&!!i.displayName&&(typeof i.displayName=="string"||i.displayName instanceof String)&&i.displayName.startsWith("Memo(")}function Ym(i){return Ko(i)?Yg.apply(null,arguments):i}function Zm(i){return!!i.__k&&(Fi(null,i),!0)}function Jm(i){return i&&(i.base||i.nodeType===1&&i)||null}var Qm=function(i,e){return i(e)},ev=function(i,e){return i(e)},tv=Dt,nv=Ko,id={useState:ae,useId:$h,useReducer:kl,useEffect:Ve,useLayoutEffect:Ts,useInsertionEffect:Jh,useTransition:Zh,useDeferredValue:Yh,useSyncExternalStore:Gh,startTransition:qh,useRef:gt,useImperativeHandle:zh,useMemo:jo,useCallback:Wh,useContext:Bh,useDebugValue:Uh,version:"18.3.1",Children:Mm,render:Wm,hydrate:Bm,unmountComponentAtNode:Zm,createPortal:Im,createElement:Zn,createContext:Zg,createFactory:Xm,cloneElement:Ym,createRef:Vg,Fragment:Dt,isValidElement:Ko,isElement:nv,isFragment:Gm,isMemo:qm,findDOMNode:Jm,Component:En,PureComponent:ol,memo:Lm,forwardRef:Cl,flushSync:ev,unstable_batchedUpdates:Qm,StrictMode:tv,Suspense:No,SuspenseList:ss,lazy:Pm,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Km};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Ns(i){return i+.5|0}const hi=(i,e,n)=>Math.max(Math.min(i,n),e);function os(i){return hi(Ns(i*2.55),0,255)}function di(i){return hi(Ns(i*255),0,255)}function Gn(i){return hi(Ns(i/2.55)/100,0,1)}function mf(i){return hi(Ns(i*100),0,100)}const hn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},al=[..."0123456789ABCDEF"],iv=i=>al[i&15],rv=i=>al[(i&240)>>4]+al[i&15],fo=i=>(i&240)>>4===(i&15),sv=i=>fo(i.r)&&fo(i.g)&&fo(i.b)&&fo(i.a);function ov(i){var e=i.length,n;return i[0]==="#"&&(e===4||e===5?n={r:255&hn[i[1]]*17,g:255&hn[i[2]]*17,b:255&hn[i[3]]*17,a:e===5?hn[i[4]]*17:255}:(e===7||e===9)&&(n={r:hn[i[1]]<<4|hn[i[2]],g:hn[i[3]]<<4|hn[i[4]],b:hn[i[5]]<<4|hn[i[6]],a:e===9?hn[i[7]]<<4|hn[i[8]]:255})),n}const av=(i,e)=>i<255?e(i):"";function lv(i){var e=sv(i)?iv:rv;return i?"#"+e(i.r)+e(i.g)+e(i.b)+av(i.a,e):void 0}const cv=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function rd(i,e,n){const s=e*Math.min(n,1-n),o=(c,f=(c+i/30)%12)=>n-s*Math.max(Math.min(f-3,9-f,1),-1);return[o(0),o(8),o(4)]}function uv(i,e,n){const s=(o,c=(o+i/60)%6)=>n-n*e*Math.max(Math.min(c,4-c,1),0);return[s(5),s(3),s(1)]}function fv(i,e,n){const s=rd(i,1,.5);let o;for(e+n>1&&(o=1/(e+n),e*=o,n*=o),o=0;o<3;o++)s[o]*=1-e-n,s[o]+=e;return s}function hv(i,e,n,s,o){return i===o?(e-n)/s+(e<n?6:0):e===o?(n-i)/s+2:(i-e)/s+4}function Ll(i){const n=i.r/255,s=i.g/255,o=i.b/255,c=Math.max(n,s,o),f=Math.min(n,s,o),h=(c+f)/2;let p,g,b;return c!==f&&(b=c-f,g=h>.5?b/(2-c-f):b/(c+f),p=hv(n,s,o,b,c),p=p*60+.5),[p|0,g||0,h]}function Nl(i,e,n,s){return(Array.isArray(e)?i(e[0],e[1],e[2]):i(e,n,s)).map(di)}function Ml(i,e,n){return Nl(rd,i,e,n)}function dv(i,e,n){return Nl(fv,i,e,n)}function pv(i,e,n){return Nl(uv,i,e,n)}function sd(i){return(i%360+360)%360}function gv(i){const e=cv.exec(i);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?os(+e[5]):di(+e[5]));const o=sd(+e[2]),c=+e[3]/100,f=+e[4]/100;return e[1]==="hwb"?s=dv(o,c,f):e[1]==="hsv"?s=pv(o,c,f):s=Ml(o,c,f),{r:s[0],g:s[1],b:s[2],a:n}}function mv(i,e){var n=Ll(i);n[0]=sd(n[0]+e),n=Ml(n),i.r=n[0],i.g=n[1],i.b=n[2]}function vv(i){if(!i)return;const e=Ll(i),n=e[0],s=mf(e[1]),o=mf(e[2]);return i.a<255?`hsla(${n}, ${s}%, ${o}%, ${Gn(i.a)})`:`hsl(${n}, ${s}%, ${o}%)`}const vf={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},yf={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function yv(){const i={},e=Object.keys(yf),n=Object.keys(vf);let s,o,c,f,h;for(s=0;s<e.length;s++){for(f=h=e[s],o=0;o<n.length;o++)c=n[o],h=h.replace(c,vf[c]);c=parseInt(yf[f],16),i[h]=[c>>16&255,c>>8&255,c&255]}return i}let ho;function bv(i){ho||(ho=yv(),ho.transparent=[0,0,0,0]);const e=ho[i.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const xv=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function _v(i){const e=xv.exec(i);let n=255,s,o,c;if(e){if(e[7]!==s){const f=+e[7];n=e[8]?os(f):hi(f*255,0,255)}return s=+e[1],o=+e[3],c=+e[5],s=255&(e[2]?os(s):hi(s,0,255)),o=255&(e[4]?os(o):hi(o,0,255)),c=255&(e[6]?os(c):hi(c,0,255)),{r:s,g:o,b:c,a:n}}}function wv(i){return i&&(i.a<255?`rgba(${i.r}, ${i.g}, ${i.b}, ${Gn(i.a)})`:`rgb(${i.r}, ${i.g}, ${i.b})`)}const Va=i=>i<=.0031308?i*12.92:Math.pow(i,1/2.4)*1.055-.055,ur=i=>i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4);function kv(i,e,n){const s=ur(Gn(i.r)),o=ur(Gn(i.g)),c=ur(Gn(i.b));return{r:di(Va(s+n*(ur(Gn(e.r))-s))),g:di(Va(o+n*(ur(Gn(e.g))-o))),b:di(Va(c+n*(ur(Gn(e.b))-c))),a:i.a+n*(e.a-i.a)}}function po(i,e,n){if(i){let s=Ll(i);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=Ml(s),i.r=s[0],i.g=s[1],i.b=s[2]}}function od(i,e){return i&&Object.assign(e||{},i)}function bf(i){var e={r:0,g:0,b:0,a:255};return Array.isArray(i)?i.length>=3&&(e={r:i[0],g:i[1],b:i[2],a:255},i.length>3&&(e.a=di(i[3]))):(e=od(i,{r:0,g:0,b:0,a:1}),e.a=di(e.a)),e}function Sv(i){return i.charAt(0)==="r"?_v(i):gv(i)}class bs{constructor(e){if(e instanceof bs)return e;const n=typeof e;let s;n==="object"?s=bf(e):n==="string"&&(s=ov(e)||bv(e)||Sv(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=od(this._rgb);return e&&(e.a=Gn(e.a)),e}set rgb(e){this._rgb=bf(e)}rgbString(){return this._valid?wv(this._rgb):void 0}hexString(){return this._valid?lv(this._rgb):void 0}hslString(){return this._valid?vv(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,o=e.rgb;let c;const f=n===c?.5:n,h=2*f-1,p=s.a-o.a,g=((h*p===-1?h:(h+p)/(1+h*p))+1)/2;c=1-g,s.r=255&g*s.r+c*o.r+.5,s.g=255&g*s.g+c*o.g+.5,s.b=255&g*s.b+c*o.b+.5,s.a=f*s.a+(1-f)*o.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=kv(this._rgb,e._rgb,n)),this}clone(){return new bs(this.rgb)}alpha(e){return this._rgb.a=di(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=Ns(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return po(this._rgb,2,e),this}darken(e){return po(this._rgb,2,-e),this}saturate(e){return po(this._rgb,1,e),this}desaturate(e){return po(this._rgb,1,-e),this}rotate(e){return mv(this._rgb,e),this}}/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function Vn(){}const Cv=(()=>{let i=0;return()=>i++})();function yt(i){return i==null}function Mt(i){if(Array.isArray&&Array.isArray(i))return!0;const e=Object.prototype.toString.call(i);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function nt(i){return i!==null&&Object.prototype.toString.call(i)==="[object Object]"}function gn(i){return(typeof i=="number"||i instanceof Number)&&isFinite(+i)}function On(i,e){return gn(i)?i:e}function Ze(i,e){return typeof i>"u"?e:i}const Tv=(i,e)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100*e:+i;function ct(i,e,n){if(i&&typeof i.call=="function")return i.apply(n,e)}function rt(i,e,n,s){let o,c,f;if(Mt(i))for(c=i.length,o=0;o<c;o++)e.call(n,i[o],o);else if(nt(i))for(f=Object.keys(i),c=f.length,o=0;o<c;o++)e.call(n,i[f[o]],f[o])}function Eo(i,e){let n,s,o,c;if(!i||!e||i.length!==e.length)return!1;for(n=0,s=i.length;n<s;++n)if(o=i[n],c=e[n],o.datasetIndex!==c.datasetIndex||o.index!==c.index)return!1;return!0}function Ro(i){if(Mt(i))return i.map(Ro);if(nt(i)){const e=Object.create(null),n=Object.keys(i),s=n.length;let o=0;for(;o<s;++o)e[n[o]]=Ro(i[n[o]]);return e}return i}function ad(i){return["__proto__","prototype","constructor"].indexOf(i)===-1}function Lv(i,e,n,s){if(!ad(i))return;const o=e[i],c=n[i];nt(o)&&nt(c)?xs(o,c,s):e[i]=Ro(c)}function xs(i,e,n){const s=Mt(e)?e:[e],o=s.length;if(!nt(i))return i;n=n||{};const c=n.merger||Lv;let f;for(let h=0;h<o;++h){if(f=s[h],!nt(f))continue;const p=Object.keys(f);for(let g=0,b=p.length;g<b;++g)c(p[g],i,f,n)}return i}function hs(i,e){return xs(i,e,{merger:Nv})}function Nv(i,e,n){if(!ad(i))return;const s=e[i],o=n[i];nt(s)&&nt(o)?hs(s,o):Object.prototype.hasOwnProperty.call(e,i)||(e[i]=Ro(o))}const xf={"":i=>i,x:i=>i.x,y:i=>i.y};function Mv(i){const e=i.split("."),n=[];let s="";for(const o of e)s+=o,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function Dv(i){const e=Mv(i);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function Fo(i,e){return(xf[e]||(xf[e]=Dv(e)))(i)}function Dl(i){return i.charAt(0).toUpperCase()+i.slice(1)}const Ho=i=>typeof i<"u",gi=i=>typeof i=="function",_f=(i,e)=>{if(i.size!==e.size)return!1;for(const n of i)if(!e.has(n))return!1;return!0};function Pv(i){return i.type==="mouseup"||i.type==="click"||i.type==="contextmenu"}const Pt=Math.PI,Rn=2*Pt,Ov=Rn+Pt,zo=Number.POSITIVE_INFINITY,Av=Pt/180,Sn=Pt/2,Ni=Pt/4,wf=Pt*2/3,ll=Math.log10,pr=Math.sign;function ds(i,e,n){return Math.abs(i-e)<n}function kf(i){const e=Math.round(i);i=ds(i,e,i/1e3)?e:i;const n=Math.pow(10,Math.floor(ll(i))),s=i/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function Iv(i){const e=[],n=Math.sqrt(i);let s;for(s=1;s<n;s++)i%s===0&&(e.push(s),e.push(i/s));return n===(n|0)&&e.push(n),e.sort((o,c)=>o-c).pop(),e}function _s(i){return!isNaN(parseFloat(i))&&isFinite(i)}function Ev(i,e){const n=Math.round(i);return n-e<=i&&n+e>=i}function Rv(i,e,n){let s,o,c;for(s=0,o=i.length;s<o;s++)c=i[s][n],isNaN(c)||(e.min=Math.min(e.min,c),e.max=Math.max(e.max,c))}function Ii(i){return i*(Pt/180)}function Fv(i){return i*(180/Pt)}function Sf(i){if(!gn(i))return;let e=1,n=0;for(;Math.round(i*e)/e!==i;)e*=10,n++;return n}function Hv(i,e){const n=e.x-i.x,s=e.y-i.y,o=Math.sqrt(n*n+s*s);let c=Math.atan2(s,n);return c<-.5*Pt&&(c+=Rn),{angle:c,distance:o}}function cl(i,e){return Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2))}function zv(i,e){return(i-e+Ov)%Rn-Pt}function fi(i){return(i%Rn+Rn)%Rn}function ld(i,e,n,s){const o=fi(i),c=fi(e),f=fi(n),h=fi(c-o),p=fi(f-o),g=fi(o-c),b=fi(o-f);return o===c||o===f||s&&c===f||h>p&&g<b}function dn(i,e,n){return Math.max(e,Math.min(n,i))}function Wv(i){return dn(i,-32768,32767)}function as(i,e,n,s=1e-6){return i>=Math.min(e,n)-s&&i<=Math.max(e,n)+s}function Pl(i,e,n){n=n||(f=>i[f]<e);let s=i.length-1,o=0,c;for(;s-o>1;)c=o+s>>1,n(c)?o=c:s=c;return{lo:o,hi:s}}const Ei=(i,e,n,s)=>Pl(i,n,s?o=>{const c=i[o][e];return c<n||c===n&&i[o+1][e]===n}:o=>i[o][e]<n),Bv=(i,e,n)=>Pl(i,n,s=>i[s][e]>=n);function Uv(i,e,n){let s=0,o=i.length;for(;s<o&&i[s]<e;)s++;for(;o>s&&i[o-1]>n;)o--;return s>0||o<i.length?i.slice(s,o):i}const cd=["push","pop","shift","splice","unshift"];function $v(i,e){if(i._chartjs){i._chartjs.listeners.push(e);return}Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),cd.forEach(n=>{const s="_onData"+Dl(n),o=i[n];Object.defineProperty(i,n,{configurable:!0,enumerable:!1,value(...c){const f=o.apply(this,c);return i._chartjs.listeners.forEach(h=>{typeof h[s]=="function"&&h[s](...c)}),f}})})}function Cf(i,e){const n=i._chartjs;if(!n)return;const s=n.listeners,o=s.indexOf(e);o!==-1&&s.splice(o,1),!(s.length>0)&&(cd.forEach(c=>{delete i[c]}),delete i._chartjs)}function jv(i){const e=new Set(i);return e.size===i.length?i:Array.from(e)}const ud=function(){return typeof window>"u"?function(i){return i()}:window.requestAnimationFrame}();function fd(i,e){let n=[],s=!1;return function(...o){n=o,s||(s=!0,ud.call(window,()=>{s=!1,i.apply(e,n)}))}}function Vv(i,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(i,e,s)):i.apply(this,s),e}}const Ol=i=>i==="start"?"left":i==="end"?"right":"center",Bt=(i,e,n)=>i==="start"?e:i==="end"?n:(e+n)/2,Kv=(i,e,n,s)=>i===(s?"left":"right")?n:i==="center"?(e+n)/2:e;function Xv(i,e,n){const s=e.length;let o=0,c=s;if(i._sorted){const{iScale:f,_parsed:h}=i,p=f.axis,{min:g,max:b,minDefined:_,maxDefined:T}=f.getUserBounds();_&&(o=dn(Math.min(Ei(h,p,g).lo,n?s:Ei(e,p,f.getPixelForValue(g)).lo),0,s-1)),T?c=dn(Math.max(Ei(h,f.axis,b,!0).hi+1,n?0:Ei(e,p,f.getPixelForValue(b),!0).hi+1),o,s)-o:c=s-o}return{start:o,count:c}}function Gv(i){const{xScale:e,yScale:n,_scaleRanges:s}=i,o={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!s)return i._scaleRanges=o,!0;const c=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,o),c}const go=i=>i===0||i===1,Tf=(i,e,n)=>-(Math.pow(2,10*(i-=1))*Math.sin((i-e)*Rn/n)),Lf=(i,e,n)=>Math.pow(2,-10*i)*Math.sin((i-e)*Rn/n)+1,ps={linear:i=>i,easeInQuad:i=>i*i,easeOutQuad:i=>-i*(i-2),easeInOutQuad:i=>(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1),easeInCubic:i=>i*i*i,easeOutCubic:i=>(i-=1)*i*i+1,easeInOutCubic:i=>(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2),easeInQuart:i=>i*i*i*i,easeOutQuart:i=>-((i-=1)*i*i*i-1),easeInOutQuart:i=>(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2),easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>(i-=1)*i*i*i*i+1,easeInOutQuint:i=>(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2),easeInSine:i=>-Math.cos(i*Sn)+1,easeOutSine:i=>Math.sin(i*Sn),easeInOutSine:i=>-.5*(Math.cos(Pt*i)-1),easeInExpo:i=>i===0?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>i===1?1:-Math.pow(2,-10*i)+1,easeInOutExpo:i=>go(i)?i:i<.5?.5*Math.pow(2,10*(i*2-1)):.5*(-Math.pow(2,-10*(i*2-1))+2),easeInCirc:i=>i>=1?i:-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-(i-=1)*i),easeInOutCirc:i=>(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1),easeInElastic:i=>go(i)?i:Tf(i,.075,.3),easeOutElastic:i=>go(i)?i:Lf(i,.075,.3),easeInOutElastic(i){return go(i)?i:i<.5?.5*Tf(i*2,.1125,.45):.5+.5*Lf(i*2-1,.1125,.45)},easeInBack(i){return i*i*((1.70158+1)*i-1.70158)},easeOutBack(i){return(i-=1)*i*((1.70158+1)*i+1.70158)+1},easeInOutBack(i){let e=1.70158;return(i/=.5)<1?.5*(i*i*(((e*=1.525)+1)*i-e)):.5*((i-=2)*i*(((e*=1.525)+1)*i+e)+2)},easeInBounce:i=>1-ps.easeOutBounce(1-i),easeOutBounce(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},easeInOutBounce:i=>i<.5?ps.easeInBounce(i*2)*.5:ps.easeOutBounce(i*2-1)*.5+.5};function Al(i){if(i&&typeof i=="object"){const e=i.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Nf(i){return Al(i)?i:new bs(i)}function Ka(i){return Al(i)?i:new bs(i).saturate(.5).darken(.1).hexString()}const qv=["x","y","borderWidth","radius","tension"],Yv=["color","borderColor","backgroundColor"];function Zv(i){i.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),i.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),i.set("animations",{colors:{type:"color",properties:Yv},numbers:{type:"number",properties:qv}}),i.describe("animations",{_fallback:"animation"}),i.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Jv(i){i.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Mf=new Map;function Qv(i,e){e=e||{};const n=i+JSON.stringify(e);let s=Mf.get(n);return s||(s=new Intl.NumberFormat(i,e),Mf.set(n,s)),s}function hd(i,e,n){return Qv(e,n).format(i)}const dd={values(i){return Mt(i)?i:""+i},numeric(i,e,n){if(i===0)return"0";const s=this.chart.options.locale;let o,c=i;if(n.length>1){const g=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(g<1e-4||g>1e15)&&(o="scientific"),c=ey(i,n)}const f=ll(Math.abs(c)),h=isNaN(f)?1:Math.max(Math.min(-1*Math.floor(f),20),0),p={notation:o,minimumFractionDigits:h,maximumFractionDigits:h};return Object.assign(p,this.options.ticks.format),hd(i,s,p)},logarithmic(i,e,n){if(i===0)return"0";const s=n[e].significand||i/Math.pow(10,Math.floor(ll(i)));return[1,2,3,5,10,15].includes(s)||e>.8*n.length?dd.numeric.call(this,i,e,n):""}};function ey(i,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&i!==Math.floor(i)&&(n=i-Math.floor(i)),n}var pd={formatters:dd};function ty(i){i.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:pd.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.route("scale.ticks","color","","color"),i.route("scale.grid","color","","borderColor"),i.route("scale.border","color","","borderColor"),i.route("scale.title","color","","color"),i.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),i.describe("scales",{_fallback:"scale"}),i.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Hi=Object.create(null),ul=Object.create(null);function gs(i,e){if(!e)return i;const n=e.split(".");for(let s=0,o=n.length;s<o;++s){const c=n[s];i=i[c]||(i[c]=Object.create(null))}return i}function Xa(i,e,n){return typeof e=="string"?xs(gs(i,e),n):xs(gs(i,""),e)}class ny{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,o)=>Ka(o.backgroundColor),this.hoverBorderColor=(s,o)=>Ka(o.borderColor),this.hoverColor=(s,o)=>Ka(o.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Xa(this,e,n)}get(e){return gs(this,e)}describe(e,n){return Xa(ul,e,n)}override(e,n){return Xa(Hi,e,n)}route(e,n,s,o){const c=gs(this,e),f=gs(this,s),h="_"+n;Object.defineProperties(c,{[h]:{value:c[n],writable:!0},[n]:{enumerable:!0,get(){const p=this[h],g=f[o];return nt(p)?Object.assign({},g,p):Ze(p,g)},set(p){this[h]=p}}})}apply(e){e.forEach(n=>n(this))}}var _t=new ny({_scriptable:i=>!i.startsWith("on"),_indexable:i=>i!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Zv,Jv,ty]);function iy(i){return!i||yt(i.size)||yt(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family}function Df(i,e,n,s,o){let c=e[o];return c||(c=e[o]=i.measureText(o).width,n.push(o)),c>s&&(s=c),s}function Mi(i,e,n){const s=i.currentDevicePixelRatio,o=n!==0?Math.max(n/2,.5):0;return Math.round((e-o)*s)/s+o}function Pf(i,e){!e&&!i||(e=e||i.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,i.width,i.height),e.restore())}function fl(i,e,n,s){gd(i,e,n,s,null)}function gd(i,e,n,s,o){let c,f,h,p,g,b,_,T;const L=e.pointStyle,D=e.rotation,P=e.radius;let N=(D||0)*Av;if(L&&typeof L=="object"&&(c=L.toString(),c==="[object HTMLImageElement]"||c==="[object HTMLCanvasElement]")){i.save(),i.translate(n,s),i.rotate(N),i.drawImage(L,-L.width/2,-L.height/2,L.width,L.height),i.restore();return}if(!(isNaN(P)||P<=0)){switch(i.beginPath(),L){default:o?i.ellipse(n,s,o/2,P,0,0,Rn):i.arc(n,s,P,0,Rn),i.closePath();break;case"triangle":b=o?o/2:P,i.moveTo(n+Math.sin(N)*b,s-Math.cos(N)*P),N+=wf,i.lineTo(n+Math.sin(N)*b,s-Math.cos(N)*P),N+=wf,i.lineTo(n+Math.sin(N)*b,s-Math.cos(N)*P),i.closePath();break;case"rectRounded":g=P*.516,p=P-g,f=Math.cos(N+Ni)*p,_=Math.cos(N+Ni)*(o?o/2-g:p),h=Math.sin(N+Ni)*p,T=Math.sin(N+Ni)*(o?o/2-g:p),i.arc(n-_,s-h,g,N-Pt,N-Sn),i.arc(n+T,s-f,g,N-Sn,N),i.arc(n+_,s+h,g,N,N+Sn),i.arc(n-T,s+f,g,N+Sn,N+Pt),i.closePath();break;case"rect":if(!D){p=Math.SQRT1_2*P,b=o?o/2:p,i.rect(n-b,s-p,2*b,2*p);break}N+=Ni;case"rectRot":_=Math.cos(N)*(o?o/2:P),f=Math.cos(N)*P,h=Math.sin(N)*P,T=Math.sin(N)*(o?o/2:P),i.moveTo(n-_,s-h),i.lineTo(n+T,s-f),i.lineTo(n+_,s+h),i.lineTo(n-T,s+f),i.closePath();break;case"crossRot":N+=Ni;case"cross":_=Math.cos(N)*(o?o/2:P),f=Math.cos(N)*P,h=Math.sin(N)*P,T=Math.sin(N)*(o?o/2:P),i.moveTo(n-_,s-h),i.lineTo(n+_,s+h),i.moveTo(n+T,s-f),i.lineTo(n-T,s+f);break;case"star":_=Math.cos(N)*(o?o/2:P),f=Math.cos(N)*P,h=Math.sin(N)*P,T=Math.sin(N)*(o?o/2:P),i.moveTo(n-_,s-h),i.lineTo(n+_,s+h),i.moveTo(n+T,s-f),i.lineTo(n-T,s+f),N+=Ni,_=Math.cos(N)*(o?o/2:P),f=Math.cos(N)*P,h=Math.sin(N)*P,T=Math.sin(N)*(o?o/2:P),i.moveTo(n-_,s-h),i.lineTo(n+_,s+h),i.moveTo(n+T,s-f),i.lineTo(n-T,s+f);break;case"line":f=o?o/2:Math.cos(N)*P,h=Math.sin(N)*P,i.moveTo(n-f,s-h),i.lineTo(n+f,s+h);break;case"dash":i.moveTo(n,s),i.lineTo(n+Math.cos(N)*(o?o/2:P),s+Math.sin(N)*P);break;case!1:i.closePath();break}i.fill(),e.borderWidth>0&&i.stroke()}}function ws(i,e,n){return n=n||.5,!e||i&&i.x>e.left-n&&i.x<e.right+n&&i.y>e.top-n&&i.y<e.bottom+n}function Il(i,e){i.save(),i.beginPath(),i.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),i.clip()}function El(i){i.restore()}function ry(i,e,n,s,o){if(!e)return i.lineTo(n.x,n.y);if(o==="middle"){const c=(e.x+n.x)/2;i.lineTo(c,e.y),i.lineTo(c,n.y)}else o==="after"!=!!s?i.lineTo(e.x,n.y):i.lineTo(n.x,e.y);i.lineTo(n.x,n.y)}function sy(i,e,n,s){if(!e)return i.lineTo(n.x,n.y);i.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function oy(i,e){e.translation&&i.translate(e.translation[0],e.translation[1]),yt(e.rotation)||i.rotate(e.rotation),e.color&&(i.fillStyle=e.color),e.textAlign&&(i.textAlign=e.textAlign),e.textBaseline&&(i.textBaseline=e.textBaseline)}function ay(i,e,n,s,o){if(o.strikethrough||o.underline){const c=i.measureText(s),f=e-c.actualBoundingBoxLeft,h=e+c.actualBoundingBoxRight,p=n-c.actualBoundingBoxAscent,g=n+c.actualBoundingBoxDescent,b=o.strikethrough?(p+g)/2:g;i.strokeStyle=i.fillStyle,i.beginPath(),i.lineWidth=o.decorationWidth||2,i.moveTo(f,b),i.lineTo(h,b),i.stroke()}}function ly(i,e){const n=i.fillStyle;i.fillStyle=e.color,i.fillRect(e.left,e.top,e.width,e.height),i.fillStyle=n}function ks(i,e,n,s,o,c={}){const f=Mt(e)?e:[e],h=c.strokeWidth>0&&c.strokeColor!=="";let p,g;for(i.save(),i.font=o.string,oy(i,c),p=0;p<f.length;++p)g=f[p],c.backdrop&&ly(i,c.backdrop),h&&(c.strokeColor&&(i.strokeStyle=c.strokeColor),yt(c.strokeWidth)||(i.lineWidth=c.strokeWidth),i.strokeText(g,n,s,c.maxWidth)),i.fillText(g,n,s,c.maxWidth),ay(i,n,s,g,c),s+=Number(o.lineHeight);i.restore()}function hl(i,e){const{x:n,y:s,w:o,h:c,radius:f}=e;i.arc(n+f.topLeft,s+f.topLeft,f.topLeft,1.5*Pt,Pt,!0),i.lineTo(n,s+c-f.bottomLeft),i.arc(n+f.bottomLeft,s+c-f.bottomLeft,f.bottomLeft,Pt,Sn,!0),i.lineTo(n+o-f.bottomRight,s+c),i.arc(n+o-f.bottomRight,s+c-f.bottomRight,f.bottomRight,Sn,0,!0),i.lineTo(n+o,s+f.topRight),i.arc(n+o-f.topRight,s+f.topRight,f.topRight,0,-Sn,!0),i.lineTo(n+f.topLeft,s)}const cy=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,uy=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function fy(i,e){const n=(""+i).match(cy);if(!n||n[1]==="normal")return e*1.2;switch(i=+n[2],n[3]){case"px":return i;case"%":i/=100;break}return e*i}const hy=i=>+i||0;function md(i,e){const n={},s=nt(e),o=s?Object.keys(e):e,c=nt(i)?s?f=>Ze(i[f],i[e[f]]):f=>i[f]:()=>i;for(const f of o)n[f]=hy(c(f));return n}function dy(i){return md(i,{top:"y",right:"x",bottom:"y",left:"x"})}function ms(i){return md(i,["topLeft","topRight","bottomLeft","bottomRight"])}function mn(i){const e=dy(i);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ut(i,e){i=i||{},e=e||_t.font;let n=Ze(i.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=Ze(i.style,e.style);s&&!(""+s).match(uy)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const o={family:Ze(i.family,e.family),lineHeight:fy(Ze(i.lineHeight,e.lineHeight),n),size:n,style:s,weight:Ze(i.weight,e.weight),string:""};return o.string=iy(o),o}function mo(i,e,n,s){let o,c,f;for(o=0,c=i.length;o<c;++o)if(f=i[o],f!==void 0&&f!==void 0)return f}function py(i,e,n){const{min:s,max:o}=i,c=Tv(e,(o-s)/2),f=(h,p)=>n&&h===0?0:h+p;return{min:f(s,-Math.abs(c)),max:f(o,c)}}function zi(i,e){return Object.assign(Object.create(i),e)}function Rl(i,e=[""],n,s,o=()=>i[0]){const c=n||i;typeof s>"u"&&(s=xd("_fallback",i));const f={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:c,_fallback:s,_getTarget:o,override:h=>Rl([h,...i],e,c,s)};return new Proxy(f,{deleteProperty(h,p){return delete h[p],delete h._keys,delete i[0][p],!0},get(h,p){return yd(h,p,()=>wy(p,e,i,h))},getOwnPropertyDescriptor(h,p){return Reflect.getOwnPropertyDescriptor(h._scopes[0],p)},getPrototypeOf(){return Reflect.getPrototypeOf(i[0])},has(h,p){return Af(h).includes(p)},ownKeys(h){return Af(h)},set(h,p,g){const b=h._storage||(h._storage=o());return h[p]=b[p]=g,delete h._keys,!0}})}function gr(i,e,n,s){const o={_cacheable:!1,_proxy:i,_context:e,_subProxy:n,_stack:new Set,_descriptors:vd(i,s),setContext:c=>gr(i,c,n,s),override:c=>gr(i.override(c),e,n,s)};return new Proxy(o,{deleteProperty(c,f){return delete c[f],delete i[f],!0},get(c,f,h){return yd(c,f,()=>my(c,f,h))},getOwnPropertyDescriptor(c,f){return c._descriptors.allKeys?Reflect.has(i,f)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(i,f)},getPrototypeOf(){return Reflect.getPrototypeOf(i)},has(c,f){return Reflect.has(i,f)},ownKeys(){return Reflect.ownKeys(i)},set(c,f,h){return i[f]=h,delete c[f],!0}})}function vd(i,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:o=e.allKeys}=i;return{allKeys:o,scriptable:n,indexable:s,isScriptable:gi(n)?n:()=>n,isIndexable:gi(s)?s:()=>s}}const gy=(i,e)=>i?i+Dl(e):e,Fl=(i,e)=>nt(e)&&i!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function yd(i,e,n){if(Object.prototype.hasOwnProperty.call(i,e)||e==="constructor")return i[e];const s=n();return i[e]=s,s}function my(i,e,n){const{_proxy:s,_context:o,_subProxy:c,_descriptors:f}=i;let h=s[e];return gi(h)&&f.isScriptable(e)&&(h=vy(e,h,i,n)),Mt(h)&&h.length&&(h=yy(e,h,i,f.isIndexable)),Fl(e,h)&&(h=gr(h,o,c&&c[e],f)),h}function vy(i,e,n,s){const{_proxy:o,_context:c,_subProxy:f,_stack:h}=n;if(h.has(i))throw new Error("Recursion detected: "+Array.from(h).join("->")+"->"+i);h.add(i);let p=e(c,f||s);return h.delete(i),Fl(i,p)&&(p=Hl(o._scopes,o,i,p)),p}function yy(i,e,n,s){const{_proxy:o,_context:c,_subProxy:f,_descriptors:h}=n;if(typeof c.index<"u"&&s(i))return e[c.index%e.length];if(nt(e[0])){const p=e,g=o._scopes.filter(b=>b!==p);e=[];for(const b of p){const _=Hl(g,o,i,b);e.push(gr(_,c,f&&f[i],h))}}return e}function bd(i,e,n){return gi(i)?i(e,n):i}const by=(i,e)=>i===!0?e:typeof i=="string"?Fo(e,i):void 0;function xy(i,e,n,s,o){for(const c of e){const f=by(n,c);if(f){i.add(f);const h=bd(f._fallback,n,o);if(typeof h<"u"&&h!==n&&h!==s)return h}else if(f===!1&&typeof s<"u"&&n!==s)return null}return!1}function Hl(i,e,n,s){const o=e._rootScopes,c=bd(e._fallback,n,s),f=[...i,...o],h=new Set;h.add(s);let p=Of(h,f,n,c||n,s);return p===null||typeof c<"u"&&c!==n&&(p=Of(h,f,c,p,s),p===null)?!1:Rl(Array.from(h),[""],o,c,()=>_y(e,n,s))}function Of(i,e,n,s,o){for(;n;)n=xy(i,e,n,s,o);return n}function _y(i,e,n){const s=i._getTarget();e in s||(s[e]={});const o=s[e];return Mt(o)&&nt(n)?n:o||{}}function wy(i,e,n,s){let o;for(const c of e)if(o=xd(gy(c,i),n),typeof o<"u")return Fl(i,o)?Hl(n,s,i,o):o}function xd(i,e){for(const n of e){if(!n)continue;const s=n[i];if(typeof s<"u")return s}}function Af(i){let e=i._keys;return e||(e=i._keys=ky(i._scopes)),e}function ky(i){const e=new Set;for(const n of i)for(const s of Object.keys(n).filter(o=>!o.startsWith("_")))e.add(s);return Array.from(e)}const Sy=Number.EPSILON||1e-14,mr=(i,e)=>e<i.length&&!i[e].skip&&i[e],_d=i=>i==="x"?"y":"x";function Cy(i,e,n,s){const o=i.skip?e:i,c=e,f=n.skip?e:n,h=cl(c,o),p=cl(f,c);let g=h/(h+p),b=p/(h+p);g=isNaN(g)?0:g,b=isNaN(b)?0:b;const _=s*g,T=s*b;return{previous:{x:c.x-_*(f.x-o.x),y:c.y-_*(f.y-o.y)},next:{x:c.x+T*(f.x-o.x),y:c.y+T*(f.y-o.y)}}}function Ty(i,e,n){const s=i.length;let o,c,f,h,p,g=mr(i,0);for(let b=0;b<s-1;++b)if(p=g,g=mr(i,b+1),!(!p||!g)){if(ds(e[b],0,Sy)){n[b]=n[b+1]=0;continue}o=n[b]/e[b],c=n[b+1]/e[b],h=Math.pow(o,2)+Math.pow(c,2),!(h<=9)&&(f=3/Math.sqrt(h),n[b]=o*f*e[b],n[b+1]=c*f*e[b])}}function Ly(i,e,n="x"){const s=_d(n),o=i.length;let c,f,h,p=mr(i,0);for(let g=0;g<o;++g){if(f=h,h=p,p=mr(i,g+1),!h)continue;const b=h[n],_=h[s];f&&(c=(b-f[n])/3,h[`cp1${n}`]=b-c,h[`cp1${s}`]=_-c*e[g]),p&&(c=(p[n]-b)/3,h[`cp2${n}`]=b+c,h[`cp2${s}`]=_+c*e[g])}}function Ny(i,e="x"){const n=_d(e),s=i.length,o=Array(s).fill(0),c=Array(s);let f,h,p,g=mr(i,0);for(f=0;f<s;++f)if(h=p,p=g,g=mr(i,f+1),!!p){if(g){const b=g[e]-p[e];o[f]=b!==0?(g[n]-p[n])/b:0}c[f]=h?g?pr(o[f-1])!==pr(o[f])?0:(o[f-1]+o[f])/2:o[f-1]:o[f]}Ty(i,o,c),Ly(i,c,e)}function vo(i,e,n){return Math.max(Math.min(i,n),e)}function My(i,e){let n,s,o,c,f,h=ws(i[0],e);for(n=0,s=i.length;n<s;++n)f=c,c=h,h=n<s-1&&ws(i[n+1],e),c&&(o=i[n],f&&(o.cp1x=vo(o.cp1x,e.left,e.right),o.cp1y=vo(o.cp1y,e.top,e.bottom)),h&&(o.cp2x=vo(o.cp2x,e.left,e.right),o.cp2y=vo(o.cp2y,e.top,e.bottom)))}function Dy(i,e,n,s,o){let c,f,h,p;if(e.spanGaps&&(i=i.filter(g=>!g.skip)),e.cubicInterpolationMode==="monotone")Ny(i,o);else{let g=s?i[i.length-1]:i[0];for(c=0,f=i.length;c<f;++c)h=i[c],p=Cy(g,h,i[Math.min(c+1,f-(s?0:1))%f],e.tension),h.cp1x=p.previous.x,h.cp1y=p.previous.y,h.cp2x=p.next.x,h.cp2y=p.next.y,g=h}e.capBezierPoints&&My(i,n)}function zl(){return typeof window<"u"&&typeof document<"u"}function Wl(i){let e=i.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Wo(i,e,n){let s;return typeof i=="string"?(s=parseInt(i,10),i.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=i,s}const Xo=i=>i.ownerDocument.defaultView.getComputedStyle(i,null);function Py(i,e){return Xo(i).getPropertyValue(e)}const Oy=["top","right","bottom","left"];function Ri(i,e,n){const s={};n=n?"-"+n:"";for(let o=0;o<4;o++){const c=Oy[o];s[c]=parseFloat(i[e+"-"+c+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const Ay=(i,e,n)=>(i>0||e>0)&&(!n||!n.shadowRoot);function Iy(i,e){const n=i.touches,s=n&&n.length?n[0]:i,{offsetX:o,offsetY:c}=s;let f=!1,h,p;if(Ay(o,c,i.target))h=o,p=c;else{const g=e.getBoundingClientRect();h=s.clientX-g.left,p=s.clientY-g.top,f=!0}return{x:h,y:p,box:f}}function Pi(i,e){if("native"in i)return i;const{canvas:n,currentDevicePixelRatio:s}=e,o=Xo(n),c=o.boxSizing==="border-box",f=Ri(o,"padding"),h=Ri(o,"border","width"),{x:p,y:g,box:b}=Iy(i,n),_=f.left+(b&&h.left),T=f.top+(b&&h.top);let{width:L,height:D}=e;return c&&(L-=f.width+h.width,D-=f.height+h.height),{x:Math.round((p-_)/L*n.width/s),y:Math.round((g-T)/D*n.height/s)}}function Ey(i,e,n){let s,o;if(e===void 0||n===void 0){const c=i&&Wl(i);if(!c)e=i.clientWidth,n=i.clientHeight;else{const f=c.getBoundingClientRect(),h=Xo(c),p=Ri(h,"border","width"),g=Ri(h,"padding");e=f.width-g.width-p.width,n=f.height-g.height-p.height,s=Wo(h.maxWidth,c,"clientWidth"),o=Wo(h.maxHeight,c,"clientHeight")}}return{width:e,height:n,maxWidth:s||zo,maxHeight:o||zo}}const yo=i=>Math.round(i*10)/10;function Ry(i,e,n,s){const o=Xo(i),c=Ri(o,"margin"),f=Wo(o.maxWidth,i,"clientWidth")||zo,h=Wo(o.maxHeight,i,"clientHeight")||zo,p=Ey(i,e,n);let{width:g,height:b}=p;if(o.boxSizing==="content-box"){const T=Ri(o,"border","width"),L=Ri(o,"padding");g-=L.width+T.width,b-=L.height+T.height}return g=Math.max(0,g-c.width),b=Math.max(0,s?g/s:b-c.height),g=yo(Math.min(g,f,p.maxWidth)),b=yo(Math.min(b,h,p.maxHeight)),g&&!b&&(b=yo(g/2)),(e!==void 0||n!==void 0)&&s&&p.height&&b>p.height&&(b=p.height,g=yo(Math.floor(b*s))),{width:g,height:b}}function If(i,e,n){const s=e||1,o=Math.floor(i.height*s),c=Math.floor(i.width*s);i.height=Math.floor(i.height),i.width=Math.floor(i.width);const f=i.canvas;return f.style&&(n||!f.style.height&&!f.style.width)&&(f.style.height=`${i.height}px`,f.style.width=`${i.width}px`),i.currentDevicePixelRatio!==s||f.height!==o||f.width!==c?(i.currentDevicePixelRatio=s,f.height=o,f.width=c,i.ctx.setTransform(s,0,0,s,0,0),!0):!1}const Fy=function(){let i=!1;try{const e={get passive(){return i=!0,!1}};zl()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return i}();function Ef(i,e){const n=Py(i,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Oi(i,e,n,s){return{x:i.x+n*(e.x-i.x),y:i.y+n*(e.y-i.y)}}function Hy(i,e,n,s){return{x:i.x+n*(e.x-i.x),y:s==="middle"?n<.5?i.y:e.y:s==="after"?n<1?i.y:e.y:n>0?e.y:i.y}}function zy(i,e,n,s){const o={x:i.cp2x,y:i.cp2y},c={x:e.cp1x,y:e.cp1y},f=Oi(i,o,n),h=Oi(o,c,n),p=Oi(c,e,n),g=Oi(f,h,n),b=Oi(h,p,n);return Oi(g,b,n)}const Wy=function(i,e){return{x(n){return i+i+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},By=function(){return{x(i){return i},setWidth(i){},textAlign(i){return i},xPlus(i,e){return i+e},leftForLtr(i,e){return i}}};function fr(i,e,n){return i?Wy(e,n):By()}function wd(i,e){let n,s;(e==="ltr"||e==="rtl")&&(n=i.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),i.prevTextDirection=s)}function kd(i,e){e!==void 0&&(delete i.prevTextDirection,i.canvas.style.setProperty("direction",e[0],e[1]))}function Sd(i){return i==="angle"?{between:ld,compare:zv,normalize:fi}:{between:as,compare:(e,n)=>e-n,normalize:e=>e}}function Rf({start:i,end:e,count:n,loop:s,style:o}){return{start:i%n,end:e%n,loop:s&&(e-i+1)%n===0,style:o}}function Uy(i,e,n){const{property:s,start:o,end:c}=n,{between:f,normalize:h}=Sd(s),p=e.length;let{start:g,end:b,loop:_}=i,T,L;if(_){for(g+=p,b+=p,T=0,L=p;T<L&&f(h(e[g%p][s]),o,c);++T)g--,b--;g%=p,b%=p}return b<g&&(b+=p),{start:g,end:b,loop:_,style:i.style}}function $y(i,e,n){if(!n)return[i];const{property:s,start:o,end:c}=n,f=e.length,{compare:h,between:p,normalize:g}=Sd(s),{start:b,end:_,loop:T,style:L}=Uy(i,e,n),D=[];let P=!1,N=null,E,I,j;const X=()=>p(o,j,E)&&h(o,j)!==0,G=()=>h(c,E)===0||p(c,j,E),K=()=>P||X(),Y=()=>!P||G();for(let Q=b,he=b;Q<=_;++Q)I=e[Q%f],!I.skip&&(E=g(I[s]),E!==j&&(P=p(E,o,c),N===null&&K()&&(N=h(E,o)===0?Q:he),N!==null&&Y()&&(D.push(Rf({start:N,end:Q,loop:T,count:f,style:L})),N=null),he=Q,j=E));return N!==null&&D.push(Rf({start:N,end:_,loop:T,count:f,style:L})),D}function jy(i,e){const n=[],s=i.segments;for(let o=0;o<s.length;o++){const c=$y(s[o],i.points,e);c.length&&n.push(...c)}return n}function Vy(i,e,n,s){let o=0,c=e-1;if(n&&!s)for(;o<e&&!i[o].skip;)o++;for(;o<e&&i[o].skip;)o++;for(o%=e,n&&(c+=o);c>o&&i[c%e].skip;)c--;return c%=e,{start:o,end:c}}function Ky(i,e,n,s){const o=i.length,c=[];let f=e,h=i[e],p;for(p=e+1;p<=n;++p){const g=i[p%o];g.skip||g.stop?h.skip||(s=!1,c.push({start:e%o,end:(p-1)%o,loop:s}),e=f=g.stop?p:null):(f=p,h.skip&&(e=p)),h=g}return f!==null&&c.push({start:e%o,end:f%o,loop:s}),c}function Xy(i,e){const n=i.points,s=i.options.spanGaps,o=n.length;if(!o)return[];const c=!!i._loop,{start:f,end:h}=Vy(n,o,c,s);if(s===!0)return Ff(i,[{start:f,end:h,loop:c}],n,e);const p=h<f?h+o:h,g=!!i._fullLoop&&f===0&&h===o-1;return Ff(i,Ky(n,f,p,g),n,e)}function Ff(i,e,n,s){return!s||!s.setContext||!n?e:Gy(i,e,n,s)}function Gy(i,e,n,s){const o=i._chart.getContext(),c=Hf(i.options),{_datasetIndex:f,options:{spanGaps:h}}=i,p=n.length,g=[];let b=c,_=e[0].start,T=_;function L(D,P,N,E){const I=h?-1:1;if(D!==P){for(D+=p;n[D%p].skip;)D-=I;for(;n[P%p].skip;)P+=I;D%p!==P%p&&(g.push({start:D%p,end:P%p,loop:N,style:E}),b=E,_=P%p)}}for(const D of e){_=h?_:D.start;let P=n[_%p],N;for(T=_+1;T<=D.end;T++){const E=n[T%p];N=Hf(s.setContext(zi(o,{type:"segment",p0:P,p1:E,p0DataIndex:(T-1)%p,p1DataIndex:T%p,datasetIndex:f}))),qy(N,b)&&L(_,T-1,D.loop,b),P=E,b=N}_<T-1&&L(_,T-1,D.loop,b)}return g}function Hf(i){return{backgroundColor:i.backgroundColor,borderCapStyle:i.borderCapStyle,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderJoinStyle:i.borderJoinStyle,borderWidth:i.borderWidth,borderColor:i.borderColor}}function qy(i,e){if(!e)return!1;const n=[],s=function(o,c){return Al(c)?(n.includes(c)||n.push(c),n.indexOf(c)):c};return JSON.stringify(i,s)!==JSON.stringify(e,s)}/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class Yy{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,o){const c=n.listeners[o],f=n.duration;c.forEach(h=>h({chart:e,initial:n.initial,numSteps:f,currentStep:Math.min(s-n.start,f)}))}_refresh(){this._request||(this._running=!0,this._request=ud.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,o)=>{if(!s.running||!s.items.length)return;const c=s.items;let f=c.length-1,h=!1,p;for(;f>=0;--f)p=c[f],p._active?(p._total>s.duration&&(s.duration=p._total),p.tick(e),h=!0):(c[f]=c[c.length-1],c.pop());h&&(o.draw(),this._notify(o,s,e,"progress")),c.length||(s.running=!1,this._notify(o,s,e,"complete"),s.initial=!1),n+=c.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,o)=>Math.max(s,o._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let o=s.length-1;for(;o>=0;--o)s[o].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Kn=new Yy;const zf="transparent",Zy={boolean(i,e,n){return n>.5?e:i},color(i,e,n){const s=Nf(i||zf),o=s.valid&&Nf(e||zf);return o&&o.valid?o.mix(s,n).hexString():e},number(i,e,n){return i+(e-i)*n}};class Jy{constructor(e,n,s,o){const c=n[s];o=mo([e.to,o,c,e.from]);const f=mo([e.from,c,o]);this._active=!0,this._fn=e.fn||Zy[e.type||typeof f],this._easing=ps[e.easing]||ps.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=f,this._to=o,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const o=this._target[this._prop],c=s-this._start,f=this._duration-c;this._start=s,this._duration=Math.floor(Math.max(f,e.duration)),this._total+=c,this._loop=!!e.loop,this._to=mo([e.to,n,o,e.from]),this._from=mo([e.from,o,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,o=this._prop,c=this._from,f=this._loop,h=this._to;let p;if(this._active=c!==h&&(f||n<s),!this._active){this._target[o]=h,this._notify(!0);return}if(n<0){this._target[o]=c;return}p=n/s%2,p=f&&p>1?2-p:p,p=this._easing(Math.min(1,Math.max(0,p))),this._target[o]=this._fn(c,h,p)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let o=0;o<s.length;o++)s[o][n]()}}class Cd{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!nt(e))return;const n=Object.keys(_t.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(o=>{const c=e[o];if(!nt(c))return;const f={};for(const h of n)f[h]=c[h];(Mt(c.properties)&&c.properties||[o]).forEach(h=>{(h===o||!s.has(h))&&s.set(h,f)})})}_animateOptions(e,n){const s=n.options,o=e0(e,s);if(!o)return[];const c=this._createAnimations(o,s);return s.$shared&&Qy(e.options.$animations,s).then(()=>{e.options=s},()=>{}),c}_createAnimations(e,n){const s=this._properties,o=[],c=e.$animations||(e.$animations={}),f=Object.keys(n),h=Date.now();let p;for(p=f.length-1;p>=0;--p){const g=f[p];if(g.charAt(0)==="$")continue;if(g==="options"){o.push(...this._animateOptions(e,n));continue}const b=n[g];let _=c[g];const T=s.get(g);if(_)if(T&&_.active()){_.update(T,b,h);continue}else _.cancel();if(!T||!T.duration){e[g]=b;continue}c[g]=_=new Jy(T,e,g,b),o.push(_)}return o}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Kn.add(this._chart,s),!0}}function Qy(i,e){const n=[],s=Object.keys(e);for(let o=0;o<s.length;o++){const c=i[s[o]];c&&c.active()&&n.push(c.wait())}return Promise.all(n)}function e0(i,e){if(!e)return;let n=i.options;if(!n){i.options=e;return}return n.$shared&&(i.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Wf(i,e){const n=i&&i.options||{},s=n.reverse,o=n.min===void 0?e:0,c=n.max===void 0?e:0;return{start:s?c:o,end:s?o:c}}function t0(i,e,n){if(n===!1)return!1;const s=Wf(i,n),o=Wf(e,n);return{top:o.end,right:s.end,bottom:o.start,left:s.start}}function n0(i){let e,n,s,o;return nt(i)?(e=i.top,n=i.right,s=i.bottom,o=i.left):e=n=s=o=i,{top:e,right:n,bottom:s,left:o,disabled:i===!1}}function Td(i,e){const n=[],s=i._getSortedDatasetMetas(e);let o,c;for(o=0,c=s.length;o<c;++o)n.push(s[o].index);return n}function Bf(i,e,n,s={}){const o=i.keys,c=s.mode==="single";let f,h,p,g;if(e===null)return;let b=!1;for(f=0,h=o.length;f<h;++f){if(p=+o[f],p===n){if(b=!0,s.all)continue;break}g=i.values[p],gn(g)&&(c||e===0||pr(e)===pr(g))&&(e+=g)}return!b&&!s.all?0:e}function i0(i,e){const{iScale:n,vScale:s}=e,o=n.axis==="x"?"x":"y",c=s.axis==="x"?"x":"y",f=Object.keys(i),h=new Array(f.length);let p,g,b;for(p=0,g=f.length;p<g;++p)b=f[p],h[p]={[o]:b,[c]:i[b]};return h}function Ga(i,e){const n=i&&i.options.stacked;return n||n===void 0&&e.stack!==void 0}function r0(i,e,n){return`${i.id}.${e.id}.${n.stack||n.type}`}function s0(i){const{min:e,max:n,minDefined:s,maxDefined:o}=i.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:o?n:Number.POSITIVE_INFINITY}}function o0(i,e,n){const s=i[e]||(i[e]={});return s[n]||(s[n]={})}function Uf(i,e,n,s){for(const o of e.getMatchingVisibleMetas(s).reverse()){const c=i[o.index];if(n&&c>0||!n&&c<0)return o.index}return null}function $f(i,e){const{chart:n,_cachedMeta:s}=i,o=n._stacks||(n._stacks={}),{iScale:c,vScale:f,index:h}=s,p=c.axis,g=f.axis,b=r0(c,f,s),_=e.length;let T;for(let L=0;L<_;++L){const D=e[L],{[p]:P,[g]:N}=D,E=D._stacks||(D._stacks={});T=E[g]=o0(o,b,P),T[h]=N,T._top=Uf(T,f,!0,s.type),T._bottom=Uf(T,f,!1,s.type);const I=T._visualValues||(T._visualValues={});I[h]=N}}function qa(i,e){const n=i.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function a0(i,e){return zi(i,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function l0(i,e,n){return zi(i,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function es(i,e){const n=i.controller.index,s=i.vScale&&i.vScale.axis;if(s){e=e||i._parsed;for(const o of e){const c=o._stacks;if(!c||c[s]===void 0||c[s][n]===void 0)return;delete c[s][n],c[s]._visualValues!==void 0&&c[s]._visualValues[n]!==void 0&&delete c[s]._visualValues[n]}}}const Ya=i=>i==="reset"||i==="none",jf=(i,e)=>e?i:Object.assign({},i),c0=(i,e,n)=>i&&!e.hidden&&e._stacked&&{keys:Td(n,!0),values:null};class vs{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Ga(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&es(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),o=(_,T,L,D)=>_==="x"?T:_==="r"?D:L,c=n.xAxisID=Ze(s.xAxisID,qa(e,"x")),f=n.yAxisID=Ze(s.yAxisID,qa(e,"y")),h=n.rAxisID=Ze(s.rAxisID,qa(e,"r")),p=n.indexAxis,g=n.iAxisID=o(p,c,f,h),b=n.vAxisID=o(p,f,c,h);n.xScale=this.getScaleForId(c),n.yScale=this.getScaleForId(f),n.rScale=this.getScaleForId(h),n.iScale=this.getScaleForId(g),n.vScale=this.getScaleForId(b)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Cf(this._data,this),e._stacked&&es(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(nt(n)){const o=this._cachedMeta;this._data=i0(n,o)}else if(s!==n){if(s){Cf(s,this);const o=this._cachedMeta;es(o),o._parsed=[]}n&&Object.isExtensible(n)&&$v(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let o=!1;this._dataCheck();const c=n._stacked;n._stacked=Ga(n.vScale,n),n.stack!==s.stack&&(o=!0,es(n),n.stack=s.stack),this._resyncElements(e),(o||c!==n._stacked)&&($f(this,n._parsed),n._stacked=Ga(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:o}=this,{iScale:c,_stacked:f}=s,h=c.axis;let p=e===0&&n===o.length?!0:s._sorted,g=e>0&&s._parsed[e-1],b,_,T;if(this._parsing===!1)s._parsed=o,s._sorted=!0,T=o;else{Mt(o[e])?T=this.parseArrayData(s,o,e,n):nt(o[e])?T=this.parseObjectData(s,o,e,n):T=this.parsePrimitiveData(s,o,e,n);const L=()=>_[h]===null||g&&_[h]<g[h];for(b=0;b<n;++b)s._parsed[b+e]=_=T[b],p&&(L()&&(p=!1),g=_);s._sorted=p}f&&$f(this,T)}parsePrimitiveData(e,n,s,o){const{iScale:c,vScale:f}=e,h=c.axis,p=f.axis,g=c.getLabels(),b=c===f,_=new Array(o);let T,L,D;for(T=0,L=o;T<L;++T)D=T+s,_[T]={[h]:b||c.parse(g[D],D),[p]:f.parse(n[D],D)};return _}parseArrayData(e,n,s,o){const{xScale:c,yScale:f}=e,h=new Array(o);let p,g,b,_;for(p=0,g=o;p<g;++p)b=p+s,_=n[b],h[p]={x:c.parse(_[0],b),y:f.parse(_[1],b)};return h}parseObjectData(e,n,s,o){const{xScale:c,yScale:f}=e,{xAxisKey:h="x",yAxisKey:p="y"}=this._parsing,g=new Array(o);let b,_,T,L;for(b=0,_=o;b<_;++b)T=b+s,L=n[T],g[b]={x:c.parse(Fo(L,h),T),y:f.parse(Fo(L,p),T)};return g}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const o=this.chart,c=this._cachedMeta,f=n[e.axis],h={keys:Td(o,!0),values:n._stacks[e.axis]._visualValues};return Bf(h,f,c.index,{mode:s})}updateRangeFromParsed(e,n,s,o){const c=s[n.axis];let f=c===null?NaN:c;const h=o&&s._stacks[n.axis];o&&h&&(o.values=h,f=Bf(o,c,this._cachedMeta.index)),e.min=Math.min(e.min,f),e.max=Math.max(e.max,f)}getMinMax(e,n){const s=this._cachedMeta,o=s._parsed,c=s._sorted&&e===s.iScale,f=o.length,h=this._getOtherScale(e),p=c0(n,s,this.chart),g={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:b,max:_}=s0(h);let T,L;function D(){L=o[T];const P=L[h.axis];return!gn(L[e.axis])||b>P||_<P}for(T=0;T<f&&!(!D()&&(this.updateRangeFromParsed(g,e,L,p),c));++T);if(c){for(T=f-1;T>=0;--T)if(!D()){this.updateRangeFromParsed(g,e,L,p);break}}return g}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let o,c,f;for(o=0,c=n.length;o<c;++o)f=n[o][e.axis],gn(f)&&s.push(f);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,o=n.vScale,c=this.getParsed(e);return{label:s?""+s.getLabelForValue(c[s.axis]):"",value:o?""+o.getLabelForValue(c[o.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=n0(Ze(this.options.clip,t0(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,o=s.data||[],c=n.chartArea,f=[],h=this._drawStart||0,p=this._drawCount||o.length-h,g=this.options.drawActiveElementsOnTop;let b;for(s.dataset&&s.dataset.draw(e,c,h,p),b=h;b<h+p;++b){const _=o[b];_.hidden||(_.active&&g?f.push(_):_.draw(e,c))}for(b=0;b<f.length;++b)f[b].draw(e,c)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const o=this.getDataset();let c;if(e>=0&&e<this._cachedMeta.data.length){const f=this._cachedMeta.data[e];c=f.$context||(f.$context=l0(this.getContext(),e,f)),c.parsed=this.getParsed(e),c.raw=o.data[e],c.index=c.dataIndex=e}else c=this.$context||(this.$context=a0(this.chart.getContext(),this.index)),c.dataset=o,c.index=c.datasetIndex=this.index;return c.active=!!n,c.mode=s,c}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const o=n==="active",c=this._cachedDataOpts,f=e+"-"+n,h=c[f],p=this.enableOptionSharing&&Ho(s);if(h)return jf(h,p);const g=this.chart.config,b=g.datasetElementScopeKeys(this._type,e),_=o?[`${e}Hover`,"hover",e,""]:[e,""],T=g.getOptionScopes(this.getDataset(),b),L=Object.keys(_t.elements[e]),D=()=>this.getContext(s,o,n),P=g.resolveNamedOptions(T,L,D,_);return P.$shared&&(P.$shared=p,c[f]=Object.freeze(jf(P,p))),P}_resolveAnimations(e,n,s){const o=this.chart,c=this._cachedDataOpts,f=`animation-${n}`,h=c[f];if(h)return h;let p;if(o.options.animation!==!1){const b=this.chart.config,_=b.datasetAnimationScopeKeys(this._type,n),T=b.getOptionScopes(this.getDataset(),_);p=b.createResolver(T,this.getContext(e,s,n))}const g=new Cd(o,p&&p.animations);return p&&p._cacheable&&(c[f]=Object.freeze(g)),g}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Ya(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),o=this._sharedOptions,c=this.getSharedOptions(s),f=this.includeOptions(n,c)||c!==o;return this.updateSharedOptions(c,n,s),{sharedOptions:c,includeOptions:f}}updateElement(e,n,s,o){Ya(o)?Object.assign(e,s):this._resolveAnimations(n,o).update(e,s)}updateSharedOptions(e,n,s){e&&!Ya(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,o){e.active=o;const c=this.getStyle(n,o);this._resolveAnimations(n,s,o).update(e,{options:!o&&this.getSharedOptions(c)||c})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[h,p,g]of this._syncList)this[h](p,g);this._syncList=[];const o=s.length,c=n.length,f=Math.min(c,o);f&&this.parse(0,f),c>o?this._insertElements(o,c-o,e):c<o&&this._removeElements(c,o-c)}_insertElements(e,n,s=!0){const o=this._cachedMeta,c=o.data,f=e+n;let h;const p=g=>{for(g.length+=n,h=g.length-1;h>=f;h--)g[h]=g[h-n]};for(p(c),h=e;h<f;++h)c[h]=new this.dataElementType;this._parsing&&p(o._parsed),this.parse(e,n),s&&this.updateElements(c,e,n,"reset")}updateElements(e,n,s,o){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const o=s._parsed.splice(e,n);s._stacked&&es(s,o)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,o]=e;this[n](s,o)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ke(vs,"defaults",{}),ke(vs,"datasetElementType",null),ke(vs,"dataElementType",null);class Mo extends vs{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:s,data:o=[],_dataset:c}=n,f=this.chart._animationsDisabled;let{start:h,count:p}=Xv(n,o,f);this._drawStart=h,this._drawCount=p,Gv(n)&&(h=0,p=o.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!c._decimated,s.points=o;const g=this.resolveDatasetElementOptions(e);this.options.showLine||(g.borderWidth=0),g.segment=this.options.segment,this.updateElement(s,void 0,{animated:!f,options:g},e),this.updateElements(o,h,p,e)}updateElements(e,n,s,o){const c=o==="reset",{iScale:f,vScale:h,_stacked:p,_dataset:g}=this._cachedMeta,{sharedOptions:b,includeOptions:_}=this._getSharedOptions(n,o),T=f.axis,L=h.axis,{spanGaps:D,segment:P}=this.options,N=_s(D)?D:Number.POSITIVE_INFINITY,E=this.chart._animationsDisabled||c||o==="none",I=n+s,j=e.length;let X=n>0&&this.getParsed(n-1);for(let G=0;G<j;++G){const K=e[G],Y=E?K:{};if(G<n||G>=I){Y.skip=!0;continue}const Q=this.getParsed(G),he=yt(Q[L]),fe=Y[T]=f.getPixelForValue(Q[T],G),oe=Y[L]=c||he?h.getBasePixel():h.getPixelForValue(p?this.applyStack(h,Q,p):Q[L],G);Y.skip=isNaN(fe)||isNaN(oe)||he,Y.stop=G>0&&Math.abs(Q[T]-X[T])>N,P&&(Y.parsed=Q,Y.raw=g.data[G]),_&&(Y.options=b||this.resolveDataElementOptions(G,K.active?"active":o)),E||this.updateElement(K,G,Y,o),X=Q}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,s=n.options&&n.options.borderWidth||0,o=e.data||[];if(!o.length)return s;const c=o[0].size(this.resolveDataElementOptions(0)),f=o[o.length-1].size(this.resolveDataElementOptions(o.length-1));return Math.max(s,c,f)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}ke(Mo,"id","line"),ke(Mo,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),ke(Mo,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function Di(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Bl{constructor(e){ke(this,"options");this.options=e||{}}static override(e){Object.assign(Bl.prototype,e)}init(){}formats(){return Di()}parse(){return Di()}format(){return Di()}add(){return Di()}diff(){return Di()}startOf(){return Di()}endOf(){return Di()}}var u0={_date:Bl};function f0(i,e,n,s){const{controller:o,data:c,_sorted:f}=i,h=o._cachedMeta.iScale;if(h&&e===h.axis&&e!=="r"&&f&&c.length){const p=h._reversePixels?Bv:Ei;if(s){if(o._sharedOptions){const g=c[0],b=typeof g.getRange=="function"&&g.getRange(e);if(b){const _=p(c,e,n-b),T=p(c,e,n+b);return{lo:_.lo,hi:T.hi}}}}else return p(c,e,n)}return{lo:0,hi:c.length-1}}function Ms(i,e,n,s,o){const c=i.getSortedVisibleDatasetMetas(),f=n[e];for(let h=0,p=c.length;h<p;++h){const{index:g,data:b}=c[h],{lo:_,hi:T}=f0(c[h],e,f,o);for(let L=_;L<=T;++L){const D=b[L];D.skip||s(D,g,L)}}}function h0(i){const e=i.indexOf("x")!==-1,n=i.indexOf("y")!==-1;return function(s,o){const c=e?Math.abs(s.x-o.x):0,f=n?Math.abs(s.y-o.y):0;return Math.sqrt(Math.pow(c,2)+Math.pow(f,2))}}function Za(i,e,n,s,o){const c=[];return!o&&!i.isPointInArea(e)||Ms(i,n,e,function(h,p,g){!o&&!ws(h,i.chartArea,0)||h.inRange(e.x,e.y,s)&&c.push({element:h,datasetIndex:p,index:g})},!0),c}function d0(i,e,n,s){let o=[];function c(f,h,p){const{startAngle:g,endAngle:b}=f.getProps(["startAngle","endAngle"],s),{angle:_}=Hv(f,{x:e.x,y:e.y});ld(_,g,b)&&o.push({element:f,datasetIndex:h,index:p})}return Ms(i,n,e,c),o}function p0(i,e,n,s,o,c){let f=[];const h=h0(n);let p=Number.POSITIVE_INFINITY;function g(b,_,T){const L=b.inRange(e.x,e.y,o);if(s&&!L)return;const D=b.getCenterPoint(o);if(!(!!c||i.isPointInArea(D))&&!L)return;const N=h(e,D);N<p?(f=[{element:b,datasetIndex:_,index:T}],p=N):N===p&&f.push({element:b,datasetIndex:_,index:T})}return Ms(i,n,e,g),f}function Ja(i,e,n,s,o,c){return!c&&!i.isPointInArea(e)?[]:n==="r"&&!s?d0(i,e,n,o):p0(i,e,n,s,o,c)}function Vf(i,e,n,s,o){const c=[],f=n==="x"?"inXRange":"inYRange";let h=!1;return Ms(i,n,e,(p,g,b)=>{p[f]&&p[f](e[n],o)&&(c.push({element:p,datasetIndex:g,index:b}),h=h||p.inRange(e.x,e.y,o))}),s&&!h?[]:c}var g0={evaluateInteractionItems:Ms,modes:{index(i,e,n,s){const o=Pi(e,i),c=n.axis||"x",f=n.includeInvisible||!1,h=n.intersect?Za(i,o,c,s,f):Ja(i,o,c,!1,s,f),p=[];return h.length?(i.getSortedVisibleDatasetMetas().forEach(g=>{const b=h[0].index,_=g.data[b];_&&!_.skip&&p.push({element:_,datasetIndex:g.index,index:b})}),p):[]},dataset(i,e,n,s){const o=Pi(e,i),c=n.axis||"xy",f=n.includeInvisible||!1;let h=n.intersect?Za(i,o,c,s,f):Ja(i,o,c,!1,s,f);if(h.length>0){const p=h[0].datasetIndex,g=i.getDatasetMeta(p).data;h=[];for(let b=0;b<g.length;++b)h.push({element:g[b],datasetIndex:p,index:b})}return h},point(i,e,n,s){const o=Pi(e,i),c=n.axis||"xy",f=n.includeInvisible||!1;return Za(i,o,c,s,f)},nearest(i,e,n,s){const o=Pi(e,i),c=n.axis||"xy",f=n.includeInvisible||!1;return Ja(i,o,c,n.intersect,s,f)},x(i,e,n,s){const o=Pi(e,i);return Vf(i,o,"x",n.intersect,s)},y(i,e,n,s){const o=Pi(e,i);return Vf(i,o,"y",n.intersect,s)}}};const Ld=["left","top","right","bottom"];function ts(i,e){return i.filter(n=>n.pos===e)}function Kf(i,e){return i.filter(n=>Ld.indexOf(n.pos)===-1&&n.box.axis===e)}function ns(i,e){return i.sort((n,s)=>{const o=e?s:n,c=e?n:s;return o.weight===c.weight?o.index-c.index:o.weight-c.weight})}function m0(i){const e=[];let n,s,o,c,f,h;for(n=0,s=(i||[]).length;n<s;++n)o=i[n],{position:c,options:{stack:f,stackWeight:h=1}}=o,e.push({index:n,box:o,pos:c,horizontal:o.isHorizontal(),weight:o.weight,stack:f&&c+f,stackWeight:h});return e}function v0(i){const e={};for(const n of i){const{stack:s,pos:o,stackWeight:c}=n;if(!s||!Ld.includes(o))continue;const f=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});f.count++,f.weight+=c}return e}function y0(i,e){const n=v0(i),{vBoxMaxWidth:s,hBoxMaxHeight:o}=e;let c,f,h;for(c=0,f=i.length;c<f;++c){h=i[c];const{fullSize:p}=h.box,g=n[h.stack],b=g&&h.stackWeight/g.weight;h.horizontal?(h.width=b?b*s:p&&e.availableWidth,h.height=o):(h.width=s,h.height=b?b*o:p&&e.availableHeight)}return n}function b0(i){const e=m0(i),n=ns(e.filter(g=>g.box.fullSize),!0),s=ns(ts(e,"left"),!0),o=ns(ts(e,"right")),c=ns(ts(e,"top"),!0),f=ns(ts(e,"bottom")),h=Kf(e,"x"),p=Kf(e,"y");return{fullSize:n,leftAndTop:s.concat(c),rightAndBottom:o.concat(p).concat(f).concat(h),chartArea:ts(e,"chartArea"),vertical:s.concat(o).concat(p),horizontal:c.concat(f).concat(h)}}function Xf(i,e,n,s){return Math.max(i[n],e[n])+Math.max(i[s],e[s])}function Nd(i,e){i.top=Math.max(i.top,e.top),i.left=Math.max(i.left,e.left),i.bottom=Math.max(i.bottom,e.bottom),i.right=Math.max(i.right,e.right)}function x0(i,e,n,s){const{pos:o,box:c}=n,f=i.maxPadding;if(!nt(o)){n.size&&(i[o]-=n.size);const _=s[n.stack]||{size:0,count:1};_.size=Math.max(_.size,n.horizontal?c.height:c.width),n.size=_.size/_.count,i[o]+=n.size}c.getPadding&&Nd(f,c.getPadding());const h=Math.max(0,e.outerWidth-Xf(f,i,"left","right")),p=Math.max(0,e.outerHeight-Xf(f,i,"top","bottom")),g=h!==i.w,b=p!==i.h;return i.w=h,i.h=p,n.horizontal?{same:g,other:b}:{same:b,other:g}}function _0(i){const e=i.maxPadding;function n(s){const o=Math.max(e[s]-i[s],0);return i[s]+=o,o}i.y+=n("top"),i.x+=n("left"),n("right"),n("bottom")}function w0(i,e){const n=e.maxPadding;function s(o){const c={left:0,top:0,right:0,bottom:0};return o.forEach(f=>{c[f]=Math.max(e[f],n[f])}),c}return s(i?["left","right"]:["top","bottom"])}function ls(i,e,n,s){const o=[];let c,f,h,p,g,b;for(c=0,f=i.length,g=0;c<f;++c){h=i[c],p=h.box,p.update(h.width||e.w,h.height||e.h,w0(h.horizontal,e));const{same:_,other:T}=x0(e,n,h,s);g|=_&&o.length,b=b||T,p.fullSize||o.push(h)}return g&&ls(o,e,n,s)||b}function bo(i,e,n,s,o){i.top=n,i.left=e,i.right=e+s,i.bottom=n+o,i.width=s,i.height=o}function Gf(i,e,n,s){const o=n.padding;let{x:c,y:f}=e;for(const h of i){const p=h.box,g=s[h.stack]||{count:1,placed:0,weight:1},b=h.stackWeight/g.weight||1;if(h.horizontal){const _=e.w*b,T=g.size||p.height;Ho(g.start)&&(f=g.start),p.fullSize?bo(p,o.left,f,n.outerWidth-o.right-o.left,T):bo(p,e.left+g.placed,f,_,T),g.start=f,g.placed+=_,f=p.bottom}else{const _=e.h*b,T=g.size||p.width;Ho(g.start)&&(c=g.start),p.fullSize?bo(p,c,o.top,T,n.outerHeight-o.bottom-o.top):bo(p,c,e.top+g.placed,T,_),g.start=c,g.placed+=_,c=p.right}}e.x=c,e.y=f}var pn={addBox(i,e){i.boxes||(i.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},i.boxes.push(e)},removeBox(i,e){const n=i.boxes?i.boxes.indexOf(e):-1;n!==-1&&i.boxes.splice(n,1)},configure(i,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(i,e,n,s){if(!i)return;const o=mn(i.options.layout.padding),c=Math.max(e-o.width,0),f=Math.max(n-o.height,0),h=b0(i.boxes),p=h.vertical,g=h.horizontal;rt(i.boxes,P=>{typeof P.beforeLayout=="function"&&P.beforeLayout()});const b=p.reduce((P,N)=>N.box.options&&N.box.options.display===!1?P:P+1,0)||1,_=Object.freeze({outerWidth:e,outerHeight:n,padding:o,availableWidth:c,availableHeight:f,vBoxMaxWidth:c/2/b,hBoxMaxHeight:f/2}),T=Object.assign({},o);Nd(T,mn(s));const L=Object.assign({maxPadding:T,w:c,h:f,x:o.left,y:o.top},o),D=y0(p.concat(g),_);ls(h.fullSize,L,_,D),ls(p,L,_,D),ls(g,L,_,D)&&ls(p,L,_,D),_0(L),Gf(h.leftAndTop,L,_,D),L.x+=L.w,L.y+=L.h,Gf(h.rightAndBottom,L,_,D),i.chartArea={left:L.left,top:L.top,right:L.left+L.w,bottom:L.top+L.h,height:L.h,width:L.w},rt(h.chartArea,P=>{const N=P.box;Object.assign(N,i.chartArea),N.update(L.w,L.h,{left:0,top:0,right:0,bottom:0})})}};class Md{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,o){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,o?Math.floor(n/o):s)}}isAttached(e){return!0}updateConfig(e){}}class k0 extends Md{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Do="$chartjs",S0={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},qf=i=>i===null||i==="";function C0(i,e){const n=i.style,s=i.getAttribute("height"),o=i.getAttribute("width");if(i[Do]={initial:{height:s,width:o,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",qf(o)){const c=Ef(i,"width");c!==void 0&&(i.width=c)}if(qf(s))if(i.style.height==="")i.height=i.width/(e||2);else{const c=Ef(i,"height");c!==void 0&&(i.height=c)}return i}const Dd=Fy?{passive:!0}:!1;function T0(i,e,n){i&&i.addEventListener(e,n,Dd)}function L0(i,e,n){i&&i.canvas&&i.canvas.removeEventListener(e,n,Dd)}function N0(i,e){const n=S0[i.type]||i.type,{x:s,y:o}=Pi(i,e);return{type:n,chart:e,native:i,x:s!==void 0?s:null,y:o!==void 0?o:null}}function Bo(i,e){for(const n of i)if(n===e||n.contains(e))return!0}function M0(i,e,n){const s=i.canvas,o=new MutationObserver(c=>{let f=!1;for(const h of c)f=f||Bo(h.addedNodes,s),f=f&&!Bo(h.removedNodes,s);f&&n()});return o.observe(document,{childList:!0,subtree:!0}),o}function D0(i,e,n){const s=i.canvas,o=new MutationObserver(c=>{let f=!1;for(const h of c)f=f||Bo(h.removedNodes,s),f=f&&!Bo(h.addedNodes,s);f&&n()});return o.observe(document,{childList:!0,subtree:!0}),o}const Ss=new Map;let Yf=0;function Pd(){const i=window.devicePixelRatio;i!==Yf&&(Yf=i,Ss.forEach((e,n)=>{n.currentDevicePixelRatio!==i&&e()}))}function P0(i,e){Ss.size||window.addEventListener("resize",Pd),Ss.set(i,e)}function O0(i){Ss.delete(i),Ss.size||window.removeEventListener("resize",Pd)}function A0(i,e,n){const s=i.canvas,o=s&&Wl(s);if(!o)return;const c=fd((h,p)=>{const g=o.clientWidth;n(h,p),g<o.clientWidth&&n()},window),f=new ResizeObserver(h=>{const p=h[0],g=p.contentRect.width,b=p.contentRect.height;g===0&&b===0||c(g,b)});return f.observe(o),P0(i,c),f}function Qa(i,e,n){n&&n.disconnect(),e==="resize"&&O0(i)}function I0(i,e,n){const s=i.canvas,o=fd(c=>{i.ctx!==null&&n(N0(c,i))},i);return T0(s,e,o),o}class E0 extends Md{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(C0(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Do])return!1;const s=n[Do].initial;["height","width"].forEach(c=>{const f=s[c];yt(f)?n.removeAttribute(c):n.setAttribute(c,f)});const o=s.style||{};return Object.keys(o).forEach(c=>{n.style[c]=o[c]}),n.width=n.width,delete n[Do],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const o=e.$proxies||(e.$proxies={}),f={attach:M0,detach:D0,resize:A0}[n]||I0;o[n]=f(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),o=s[n];if(!o)return;({attach:Qa,detach:Qa,resize:Qa}[n]||L0)(e,n,o),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,o){return Ry(e,n,s,o)}isAttached(e){const n=e&&Wl(e);return!!(n&&n.isConnected)}}function R0(i){return!zl()||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?k0:E0}class Jn{constructor(){ke(this,"x");ke(this,"y");ke(this,"active",!1);ke(this,"options");ke(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return _s(this.x)&&_s(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const o={};return e.forEach(c=>{o[c]=s[c]&&s[c].active()?s[c]._to:this[c]}),o}}ke(Jn,"defaults",{}),ke(Jn,"defaultRoutes");function F0(i,e){const n=i.options.ticks,s=H0(i),o=Math.min(n.maxTicksLimit||s,s),c=n.major.enabled?W0(e):[],f=c.length,h=c[0],p=c[f-1],g=[];if(f>o)return B0(e,g,c,f/o),g;const b=z0(c,e,o);if(f>0){let _,T;const L=f>1?Math.round((p-h)/(f-1)):null;for(xo(e,g,b,yt(L)?0:h-L,h),_=0,T=f-1;_<T;_++)xo(e,g,b,c[_],c[_+1]);return xo(e,g,b,p,yt(L)?e.length:p+L),g}return xo(e,g,b),g}function H0(i){const e=i.options.offset,n=i._tickSize(),s=i._length/n+(e?0:1),o=i._maxLength/n;return Math.floor(Math.min(s,o))}function z0(i,e,n){const s=U0(i),o=e.length/n;if(!s)return Math.max(o,1);const c=Iv(s);for(let f=0,h=c.length-1;f<h;f++){const p=c[f];if(p>o)return p}return Math.max(o,1)}function W0(i){const e=[];let n,s;for(n=0,s=i.length;n<s;n++)i[n].major&&e.push(n);return e}function B0(i,e,n,s){let o=0,c=n[0],f;for(s=Math.ceil(s),f=0;f<i.length;f++)f===c&&(e.push(i[f]),o++,c=n[o*s])}function xo(i,e,n,s,o){const c=Ze(s,0),f=Math.min(Ze(o,i.length),i.length);let h=0,p,g,b;for(n=Math.ceil(n),o&&(p=o-s,n=p/Math.floor(p/n)),b=c;b<0;)h++,b=Math.round(c+h*n);for(g=Math.max(c,0);g<f;g++)g===b&&(e.push(i[g]),h++,b=Math.round(c+h*n))}function U0(i){const e=i.length;let n,s;if(e<2)return!1;for(s=i[0],n=1;n<e;++n)if(i[n]-i[n-1]!==s)return!1;return s}const $0=i=>i==="left"?"right":i==="right"?"left":i,Zf=(i,e,n)=>e==="top"||e==="left"?i[e]+n:i[e]-n,Jf=(i,e)=>Math.min(e||i,i);function Qf(i,e){const n=[],s=i.length/e,o=i.length;let c=0;for(;c<o;c+=s)n.push(i[Math.floor(c)]);return n}function j0(i,e,n){const s=i.ticks.length,o=Math.min(e,s-1),c=i._startPixel,f=i._endPixel,h=1e-6;let p=i.getPixelForTick(o),g;if(!(n&&(s===1?g=Math.max(p-c,f-p):e===0?g=(i.getPixelForTick(1)-p)/2:g=(p-i.getPixelForTick(o-1))/2,p+=o<e?g:-g,p<c-h||p>f+h)))return p}function V0(i,e){rt(i,n=>{const s=n.gc,o=s.length/2;let c;if(o>e){for(c=0;c<o;++c)delete n.data[s[c]];s.splice(0,o)}})}function is(i){return i.drawTicks?i.tickLength:0}function eh(i,e){if(!i.display)return 0;const n=Ut(i.font,e),s=mn(i.padding);return(Mt(i.text)?i.text.length:1)*n.lineHeight+s.height}function K0(i,e){return zi(i,{scale:e,type:"scale"})}function X0(i,e,n){return zi(i,{tick:n,index:e,type:"tick"})}function G0(i,e,n){let s=Ol(i);return(n&&e!=="right"||!n&&e==="right")&&(s=$0(s)),s}function q0(i,e,n,s){const{top:o,left:c,bottom:f,right:h,chart:p}=i,{chartArea:g,scales:b}=p;let _=0,T,L,D;const P=f-o,N=h-c;if(i.isHorizontal()){if(L=Bt(s,c,h),nt(n)){const E=Object.keys(n)[0],I=n[E];D=b[E].getPixelForValue(I)+P-e}else n==="center"?D=(g.bottom+g.top)/2+P-e:D=Zf(i,n,e);T=h-c}else{if(nt(n)){const E=Object.keys(n)[0],I=n[E];L=b[E].getPixelForValue(I)-N+e}else n==="center"?L=(g.left+g.right)/2-N+e:L=Zf(i,n,e);D=Bt(s,f,o),_=n==="left"?-Sn:Sn}return{titleX:L,titleY:D,maxWidth:T,rotation:_}}class yr extends Jn{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:o}=this;return e=On(e,Number.POSITIVE_INFINITY),n=On(n,Number.NEGATIVE_INFINITY),s=On(s,Number.POSITIVE_INFINITY),o=On(o,Number.NEGATIVE_INFINITY),{min:On(e,s),max:On(n,o),minDefined:gn(e),maxDefined:gn(n)}}getMinMax(e){let{min:n,max:s,minDefined:o,maxDefined:c}=this.getUserBounds(),f;if(o&&c)return{min:n,max:s};const h=this.getMatchingVisibleMetas();for(let p=0,g=h.length;p<g;++p)f=h[p].controller.getMinMax(this,e),o||(n=Math.min(n,f.min)),c||(s=Math.max(s,f.max));return n=c&&n>s?s:n,s=o&&n>s?n:s,{min:On(n,On(s,n)),max:On(s,On(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ct(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:o,grace:c,ticks:f}=this.options,h=f.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=py(this,c,o),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const p=h<this.ticks.length;this._convertTicksToLabels(p?Qf(this.ticks,h):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),f.display&&(f.autoSkip||f.source==="auto")&&(this.ticks=F0(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),p&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ct(this.options.afterUpdate,[this])}beforeSetDimensions(){ct(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ct(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),ct(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ct(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,o,c;for(s=0,o=e.length;s<o;s++)c=e[s],c.label=ct(n.callback,[c.value,s,e],this)}afterTickToLabelConversion(){ct(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ct(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=Jf(this.ticks.length,e.ticks.maxTicksLimit),o=n.minRotation||0,c=n.maxRotation;let f=o,h,p,g;if(!this._isVisible()||!n.display||o>=c||s<=1||!this.isHorizontal()){this.labelRotation=o;return}const b=this._getLabelSizes(),_=b.widest.width,T=b.highest.height,L=dn(this.chart.width-_,0,this.maxWidth);h=e.offset?this.maxWidth/s:L/(s-1),_+6>h&&(h=L/(s-(e.offset?.5:1)),p=this.maxHeight-is(e.grid)-n.padding-eh(e.title,this.chart.options.font),g=Math.sqrt(_*_+T*T),f=Fv(Math.min(Math.asin(dn((b.highest.height+6)/h,-1,1)),Math.asin(dn(p/g,-1,1))-Math.asin(dn(T/g,-1,1)))),f=Math.max(o,Math.min(c,f))),this.labelRotation=f}afterCalculateLabelRotation(){ct(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ct(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:o,grid:c}}=this,f=this._isVisible(),h=this.isHorizontal();if(f){const p=eh(o,n.options.font);if(h?(e.width=this.maxWidth,e.height=is(c)+p):(e.height=this.maxHeight,e.width=is(c)+p),s.display&&this.ticks.length){const{first:g,last:b,widest:_,highest:T}=this._getLabelSizes(),L=s.padding*2,D=Ii(this.labelRotation),P=Math.cos(D),N=Math.sin(D);if(h){const E=s.mirror?0:N*_.width+P*T.height;e.height=Math.min(this.maxHeight,e.height+E+L)}else{const E=s.mirror?0:P*_.width+N*T.height;e.width=Math.min(this.maxWidth,e.width+E+L)}this._calculatePadding(g,b,N,P)}}this._handleMargins(),h?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,o){const{ticks:{align:c,padding:f},position:h}=this.options,p=this.labelRotation!==0,g=h!=="top"&&this.axis==="x";if(this.isHorizontal()){const b=this.getPixelForTick(0)-this.left,_=this.right-this.getPixelForTick(this.ticks.length-1);let T=0,L=0;p?g?(T=o*e.width,L=s*n.height):(T=s*e.height,L=o*n.width):c==="start"?L=n.width:c==="end"?T=e.width:c!=="inner"&&(T=e.width/2,L=n.width/2),this.paddingLeft=Math.max((T-b+f)*this.width/(this.width-b),0),this.paddingRight=Math.max((L-_+f)*this.width/(this.width-_),0)}else{let b=n.height/2,_=e.height/2;c==="start"?(b=0,_=e.height):c==="end"&&(b=n.height,_=0),this.paddingTop=b+f,this.paddingBottom=_+f}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ct(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)yt(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=Qf(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:o,_longestTextCache:c}=this,f=[],h=[],p=Math.floor(n/Jf(n,s));let g=0,b=0,_,T,L,D,P,N,E,I,j,X,G;for(_=0;_<n;_+=p){if(D=e[_].label,P=this._resolveTickFontOptions(_),o.font=N=P.string,E=c[N]=c[N]||{data:{},gc:[]},I=P.lineHeight,j=X=0,!yt(D)&&!Mt(D))j=Df(o,E.data,E.gc,j,D),X=I;else if(Mt(D))for(T=0,L=D.length;T<L;++T)G=D[T],!yt(G)&&!Mt(G)&&(j=Df(o,E.data,E.gc,j,G),X+=I);f.push(j),h.push(X),g=Math.max(j,g),b=Math.max(X,b)}V0(c,n);const K=f.indexOf(g),Y=h.indexOf(b),Q=he=>({width:f[he]||0,height:h[he]||0});return{first:Q(0),last:Q(n-1),widest:Q(K),highest:Q(Y),widths:f,heights:h}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Wv(this._alignToPixels?Mi(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=X0(this.getContext(),e,s))}return this.$context||(this.$context=K0(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Ii(this.labelRotation),s=Math.abs(Math.cos(n)),o=Math.abs(Math.sin(n)),c=this._getLabelSizes(),f=e.autoSkipPadding||0,h=c?c.widest.width+f:0,p=c?c.highest.height+f:0;return this.isHorizontal()?p*s>h*o?h/s:p/o:p*o<h*s?p/s:h/o}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,o=this.options,{grid:c,position:f,border:h}=o,p=c.offset,g=this.isHorizontal(),_=this.ticks.length+(p?1:0),T=is(c),L=[],D=h.setContext(this.getContext()),P=D.display?D.width:0,N=P/2,E=function(ge){return Mi(s,ge,P)};let I,j,X,G,K,Y,Q,he,fe,oe,se,R;if(f==="top")I=E(this.bottom),Y=this.bottom-T,he=I-N,oe=E(e.top)+N,R=e.bottom;else if(f==="bottom")I=E(this.top),oe=e.top,R=E(e.bottom)-N,Y=I+N,he=this.top+T;else if(f==="left")I=E(this.right),K=this.right-T,Q=I-N,fe=E(e.left)+N,se=e.right;else if(f==="right")I=E(this.left),fe=e.left,se=E(e.right)-N,K=I+N,Q=this.left+T;else if(n==="x"){if(f==="center")I=E((e.top+e.bottom)/2+.5);else if(nt(f)){const ge=Object.keys(f)[0],Le=f[ge];I=E(this.chart.scales[ge].getPixelForValue(Le))}oe=e.top,R=e.bottom,Y=I+N,he=Y+T}else if(n==="y"){if(f==="center")I=E((e.left+e.right)/2);else if(nt(f)){const ge=Object.keys(f)[0],Le=f[ge];I=E(this.chart.scales[ge].getPixelForValue(Le))}K=I-N,Q=K-T,fe=e.left,se=e.right}const F=Ze(o.ticks.maxTicksLimit,_),S=Math.max(1,Math.ceil(_/F));for(j=0;j<_;j+=S){const ge=this.getContext(j),Le=c.setContext(ge),je=h.setContext(ge),Ye=Le.lineWidth,Ke=Le.color,Se=je.dash||[],_e=je.dashOffset,Ne=Le.tickWidth,Oe=Le.tickColor,U=Le.tickBorderDash||[],Z=Le.tickBorderDashOffset;X=j0(this,j,p),X!==void 0&&(G=Mi(s,X,Ye),g?K=Q=fe=se=G:Y=he=oe=R=G,L.push({tx1:K,ty1:Y,tx2:Q,ty2:he,x1:fe,y1:oe,x2:se,y2:R,width:Ye,color:Ke,borderDash:Se,borderDashOffset:_e,tickWidth:Ne,tickColor:Oe,tickBorderDash:U,tickBorderDashOffset:Z}))}return this._ticksLength=_,this._borderValue=I,L}_computeLabelItems(e){const n=this.axis,s=this.options,{position:o,ticks:c}=s,f=this.isHorizontal(),h=this.ticks,{align:p,crossAlign:g,padding:b,mirror:_}=c,T=is(s.grid),L=T+b,D=_?-b:L,P=-Ii(this.labelRotation),N=[];let E,I,j,X,G,K,Y,Q,he,fe,oe,se,R="middle";if(o==="top")K=this.bottom-D,Y=this._getXAxisLabelAlignment();else if(o==="bottom")K=this.top+D,Y=this._getXAxisLabelAlignment();else if(o==="left"){const S=this._getYAxisLabelAlignment(T);Y=S.textAlign,G=S.x}else if(o==="right"){const S=this._getYAxisLabelAlignment(T);Y=S.textAlign,G=S.x}else if(n==="x"){if(o==="center")K=(e.top+e.bottom)/2+L;else if(nt(o)){const S=Object.keys(o)[0],ge=o[S];K=this.chart.scales[S].getPixelForValue(ge)+L}Y=this._getXAxisLabelAlignment()}else if(n==="y"){if(o==="center")G=(e.left+e.right)/2-L;else if(nt(o)){const S=Object.keys(o)[0],ge=o[S];G=this.chart.scales[S].getPixelForValue(ge)}Y=this._getYAxisLabelAlignment(T).textAlign}n==="y"&&(p==="start"?R="top":p==="end"&&(R="bottom"));const F=this._getLabelSizes();for(E=0,I=h.length;E<I;++E){j=h[E],X=j.label;const S=c.setContext(this.getContext(E));Q=this.getPixelForTick(E)+c.labelOffset,he=this._resolveTickFontOptions(E),fe=he.lineHeight,oe=Mt(X)?X.length:1;const ge=oe/2,Le=S.color,je=S.textStrokeColor,Ye=S.textStrokeWidth;let Ke=Y;f?(G=Q,Y==="inner"&&(E===I-1?Ke=this.options.reverse?"left":"right":E===0?Ke=this.options.reverse?"right":"left":Ke="center"),o==="top"?g==="near"||P!==0?se=-oe*fe+fe/2:g==="center"?se=-F.highest.height/2-ge*fe+fe:se=-F.highest.height+fe/2:g==="near"||P!==0?se=fe/2:g==="center"?se=F.highest.height/2-ge*fe:se=F.highest.height-oe*fe,_&&(se*=-1),P!==0&&!S.showLabelBackdrop&&(G+=fe/2*Math.sin(P))):(K=Q,se=(1-oe)*fe/2);let Se;if(S.showLabelBackdrop){const _e=mn(S.backdropPadding),Ne=F.heights[E],Oe=F.widths[E];let U=se-_e.top,Z=0-_e.left;switch(R){case"middle":U-=Ne/2;break;case"bottom":U-=Ne;break}switch(Y){case"center":Z-=Oe/2;break;case"right":Z-=Oe;break;case"inner":E===I-1?Z-=Oe:E>0&&(Z-=Oe/2);break}Se={left:Z,top:U,width:Oe+_e.width,height:Ne+_e.height,color:S.backdropColor}}N.push({label:X,font:he,textOffset:se,options:{rotation:P,color:Le,strokeColor:je,strokeWidth:Ye,textAlign:Ke,textBaseline:R,translation:[G,K],backdrop:Se}})}return N}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Ii(this.labelRotation))return e==="top"?"left":"right";let o="center";return n.align==="start"?o="left":n.align==="end"?o="right":n.align==="inner"&&(o="inner"),o}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:o,padding:c}}=this.options,f=this._getLabelSizes(),h=e+c,p=f.widest.width;let g,b;return n==="left"?o?(b=this.right+c,s==="near"?g="left":s==="center"?(g="center",b+=p/2):(g="right",b+=p)):(b=this.right-h,s==="near"?g="right":s==="center"?(g="center",b-=p/2):(g="left",b=this.left)):n==="right"?o?(b=this.left+c,s==="near"?g="right":s==="center"?(g="center",b-=p/2):(g="left",b-=p)):(b=this.left+h,s==="near"?g="left":s==="center"?(g="center",b+=p/2):(g="right",b=this.right)):g="right",{textAlign:g,x:b}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:o,width:c,height:f}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,o,c,f),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const o=this.ticks.findIndex(c=>c.value===e);return o>=0?n.setContext(this.getContext(o)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,o=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let c,f;const h=(p,g,b)=>{!b.width||!b.color||(s.save(),s.lineWidth=b.width,s.strokeStyle=b.color,s.setLineDash(b.borderDash||[]),s.lineDashOffset=b.borderDashOffset,s.beginPath(),s.moveTo(p.x,p.y),s.lineTo(g.x,g.y),s.stroke(),s.restore())};if(n.display)for(c=0,f=o.length;c<f;++c){const p=o[c];n.drawOnChartArea&&h({x:p.x1,y:p.y1},{x:p.x2,y:p.y2},p),n.drawTicks&&h({x:p.tx1,y:p.ty1},{x:p.tx2,y:p.ty2},{color:p.tickColor,width:p.tickWidth,borderDash:p.tickBorderDash,borderDashOffset:p.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:o}}=this,c=s.setContext(this.getContext()),f=s.display?c.width:0;if(!f)return;const h=o.setContext(this.getContext(0)).lineWidth,p=this._borderValue;let g,b,_,T;this.isHorizontal()?(g=Mi(e,this.left,f)-f/2,b=Mi(e,this.right,h)+h/2,_=T=p):(_=Mi(e,this.top,f)-f/2,T=Mi(e,this.bottom,h)+h/2,g=b=p),n.save(),n.lineWidth=c.width,n.strokeStyle=c.color,n.beginPath(),n.moveTo(g,_),n.lineTo(b,T),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,o=this._computeLabelArea();o&&Il(s,o);const c=this.getLabelItems(e);for(const f of c){const h=f.options,p=f.font,g=f.label,b=f.textOffset;ks(s,g,0,b,p,h)}o&&El(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:o}}=this;if(!s.display)return;const c=Ut(s.font),f=mn(s.padding),h=s.align;let p=c.lineHeight/2;n==="bottom"||n==="center"||nt(n)?(p+=f.bottom,Mt(s.text)&&(p+=c.lineHeight*(s.text.length-1))):p+=f.top;const{titleX:g,titleY:b,maxWidth:_,rotation:T}=q0(this,p,n,h);ks(e,s.text,0,0,c,{color:s.color,maxWidth:_,rotation:T,textAlign:G0(h,n,o),textBaseline:"middle",translation:[g,b]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=Ze(e.grid&&e.grid.z,-1),o=Ze(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==yr.prototype.draw?[{z:n,draw:c=>{this.draw(c)}}]:[{z:s,draw:c=>{this.drawBackground(),this.drawGrid(c),this.drawTitle()}},{z:o,draw:()=>{this.drawBorder()}},{z:n,draw:c=>{this.drawLabels(c)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",o=[];let c,f;for(c=0,f=n.length;c<f;++c){const h=n[c];h[s]===this.id&&(!e||h.type===e)&&o.push(h)}return o}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Ut(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class _o{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;J0(n)&&(s=this.register(n));const o=this.items,c=e.id,f=this.scope+"."+c;if(!c)throw new Error("class does not have id: "+e);return c in o||(o[c]=e,Y0(e,f,s),this.override&&_t.override(e.id,e.overrides)),f}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,o=this.scope;s in n&&delete n[s],o&&s in _t[o]&&(delete _t[o][s],this.override&&delete Hi[s])}}function Y0(i,e,n){const s=xs(Object.create(null),[n?_t.get(n):{},_t.get(e),i.defaults]);_t.set(e,s),i.defaultRoutes&&Z0(e,i.defaultRoutes),i.descriptors&&_t.describe(e,i.descriptors)}function Z0(i,e){Object.keys(e).forEach(n=>{const s=n.split("."),o=s.pop(),c=[i].concat(s).join("."),f=e[n].split("."),h=f.pop(),p=f.join(".");_t.route(c,o,p,h)})}function J0(i){return"id"in i&&"defaults"in i}class Q0{constructor(){this.controllers=new _o(vs,"datasets",!0),this.elements=new _o(Jn,"elements"),this.plugins=new _o(Object,"plugins"),this.scales=new _o(yr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(o=>{const c=s||this._getRegistryForType(o);s||c.isForType(o)||c===this.plugins&&o.id?this._exec(e,c,o):rt(o,f=>{const h=s||this._getRegistryForType(f);this._exec(e,h,f)})})}_exec(e,n,s){const o=Dl(e);ct(s["before"+o],[],s),n[e](s),ct(s["after"+o],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const o=n.get(e);if(o===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return o}}var In=new Q0;class eb{constructor(){this._init=[]}notify(e,n,s,o){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const c=o?this._descriptors(e).filter(o):this._descriptors(e),f=this._notify(c,e,n,s);return n==="afterDestroy"&&(this._notify(c,e,"stop"),this._notify(this._init,e,"uninstall")),f}_notify(e,n,s,o){o=o||{};for(const c of e){const f=c.plugin,h=f[s],p=[n,o,c.options];if(ct(h,p,f)===!1&&o.cancelable)return!1}return!0}invalidate(){yt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,o=Ze(s.options&&s.options.plugins,{}),c=tb(s);return o===!1&&!n?[]:ib(e,c,o,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,o=(c,f)=>c.filter(h=>!f.some(p=>h.plugin.id===p.plugin.id));this._notify(o(n,s),e,"stop"),this._notify(o(s,n),e,"start")}}function tb(i){const e={},n=[],s=Object.keys(In.plugins.items);for(let c=0;c<s.length;c++)n.push(In.getPlugin(s[c]));const o=i.plugins||[];for(let c=0;c<o.length;c++){const f=o[c];n.indexOf(f)===-1&&(n.push(f),e[f.id]=!0)}return{plugins:n,localIds:e}}function nb(i,e){return!e&&i===!1?null:i===!0?{}:i}function ib(i,{plugins:e,localIds:n},s,o){const c=[],f=i.getContext();for(const h of e){const p=h.id,g=nb(s[p],o);g!==null&&c.push({plugin:h,options:rb(i.config,{plugin:h,local:n[p]},g,f)})}return c}function rb(i,{plugin:e,local:n},s,o){const c=i.pluginScopeKeys(e),f=i.getOptionScopes(s,c);return n&&e.defaults&&f.push(e.defaults),i.createResolver(f,o,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function dl(i,e){const n=_t.datasets[i]||{};return((e.datasets||{})[i]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function sb(i,e){let n=i;return i==="_index_"?n=e:i==="_value_"&&(n=e==="x"?"y":"x"),n}function ob(i,e){return i===e?"_index_":"_value_"}function th(i){if(i==="x"||i==="y"||i==="r")return i}function ab(i){if(i==="top"||i==="bottom")return"x";if(i==="left"||i==="right")return"y"}function pl(i,...e){if(th(i))return i;for(const n of e){const s=n.axis||ab(n.position)||i.length>1&&th(i[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${i}' axis. Please provide 'axis' or 'position' option.`)}function nh(i,e,n){if(n[e+"AxisID"]===i)return{axis:e}}function lb(i,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===i||s.yAxisID===i);if(n.length)return nh(i,"x",n[0])||nh(i,"y",n[0])}return{}}function cb(i,e){const n=Hi[i.type]||{scales:{}},s=e.scales||{},o=dl(i.type,e),c=Object.create(null);return Object.keys(s).forEach(f=>{const h=s[f];if(!nt(h))return console.error(`Invalid scale configuration for scale: ${f}`);if(h._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${f}`);const p=pl(f,h,lb(f,i),_t.scales[h.type]),g=ob(p,o),b=n.scales||{};c[f]=hs(Object.create(null),[{axis:p},h,b[p],b[g]])}),i.data.datasets.forEach(f=>{const h=f.type||i.type,p=f.indexAxis||dl(h,e),b=(Hi[h]||{}).scales||{};Object.keys(b).forEach(_=>{const T=sb(_,p),L=f[T+"AxisID"]||T;c[L]=c[L]||Object.create(null),hs(c[L],[{axis:T},s[L],b[_]])})}),Object.keys(c).forEach(f=>{const h=c[f];hs(h,[_t.scales[h.type],_t.scale])}),c}function Od(i){const e=i.options||(i.options={});e.plugins=Ze(e.plugins,{}),e.scales=cb(i,e)}function Ad(i){return i=i||{},i.datasets=i.datasets||[],i.labels=i.labels||[],i}function ub(i){return i=i||{},i.data=Ad(i.data),Od(i),i}const ih=new Map,Id=new Set;function wo(i,e){let n=ih.get(i);return n||(n=e(),ih.set(i,n),Id.add(n)),n}const rs=(i,e,n)=>{const s=Fo(e,n);s!==void 0&&i.add(s)};class fb{constructor(e){this._config=ub(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Ad(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Od(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return wo(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return wo(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return wo(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return wo(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let o=s.get(e);return(!o||n)&&(o=new Map,s.set(e,o)),o}getOptionScopes(e,n,s){const{options:o,type:c}=this,f=this._cachedScopes(e,s),h=f.get(n);if(h)return h;const p=new Set;n.forEach(b=>{e&&(p.add(e),b.forEach(_=>rs(p,e,_))),b.forEach(_=>rs(p,o,_)),b.forEach(_=>rs(p,Hi[c]||{},_)),b.forEach(_=>rs(p,_t,_)),b.forEach(_=>rs(p,ul,_))});const g=Array.from(p);return g.length===0&&g.push(Object.create(null)),Id.has(n)&&f.set(n,g),g}chartOptionScopes(){const{options:e,type:n}=this;return[e,Hi[n]||{},_t.datasets[n]||{},{type:n},_t,ul]}resolveNamedOptions(e,n,s,o=[""]){const c={$shared:!0},{resolver:f,subPrefixes:h}=rh(this._resolverCache,e,o);let p=f;if(db(f,n)){c.$shared=!1,s=gi(s)?s():s;const g=this.createResolver(e,s,h);p=gr(f,s,g)}for(const g of n)c[g]=p[g];return c}createResolver(e,n,s=[""],o){const{resolver:c}=rh(this._resolverCache,e,s);return nt(n)?gr(c,n,void 0,o):c}}function rh(i,e,n){let s=i.get(e);s||(s=new Map,i.set(e,s));const o=n.join();let c=s.get(o);return c||(c={resolver:Rl(e,n),subPrefixes:n.filter(h=>!h.toLowerCase().includes("hover"))},s.set(o,c)),c}const hb=i=>nt(i)&&Object.getOwnPropertyNames(i).some(e=>gi(i[e]));function db(i,e){const{isScriptable:n,isIndexable:s}=vd(i);for(const o of e){const c=n(o),f=s(o),h=(f||c)&&i[o];if(c&&(gi(h)||hb(h))||f&&Mt(h))return!0}return!1}var pb="4.4.7";const gb=["top","bottom","left","right","chartArea"];function sh(i,e){return i==="top"||i==="bottom"||gb.indexOf(i)===-1&&e==="x"}function oh(i,e){return function(n,s){return n[i]===s[i]?n[e]-s[e]:n[i]-s[i]}}function ah(i){const e=i.chart,n=e.options.animation;e.notifyPlugins("afterRender"),ct(n&&n.onComplete,[i],e)}function mb(i){const e=i.chart,n=e.options.animation;ct(n&&n.onProgress,[i],e)}function Ed(i){return zl()&&typeof i=="string"?i=document.getElementById(i):i&&i.length&&(i=i[0]),i&&i.canvas&&(i=i.canvas),i}const Po={},lh=i=>{const e=Ed(i);return Object.values(Po).filter(n=>n.canvas===e).pop()};function vb(i,e,n){const s=Object.keys(i);for(const o of s){const c=+o;if(c>=e){const f=i[o];delete i[o],(n>0||c>e)&&(i[c+n]=f)}}}function yb(i,e,n,s){return!n||i.type==="mouseout"?null:s?e:i}function ko(i,e,n){return i.options.clip?i[n]:e[n]}function bb(i,e){const{xScale:n,yScale:s}=i;return n&&s?{left:ko(n,e,"left"),right:ko(n,e,"right"),top:ko(s,e,"top"),bottom:ko(s,e,"bottom")}:e}var ui;let Go=(ui=class{static register(...e){In.add(...e),ch()}static unregister(...e){In.remove(...e),ch()}constructor(e,n){const s=this.config=new fb(n),o=Ed(e),c=lh(o);if(c)throw new Error("Canvas is already in use. Chart with ID '"+c.id+"' must be destroyed before the canvas with ID '"+c.canvas.id+"' can be reused.");const f=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||R0(o)),this.platform.updateConfig(s);const h=this.platform.acquireContext(o,f.aspectRatio),p=h&&h.canvas,g=p&&p.height,b=p&&p.width;if(this.id=Cv(),this.ctx=h,this.canvas=p,this.width=b,this.height=g,this._options=f,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new eb,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Vv(_=>this.update(_),f.resizeDelay||0),this._dataChanges=[],Po[this.id]=this,!h||!p){console.error("Failed to create chart: can't acquire context from the given item");return}Kn.listen(this,"complete",ah),Kn.listen(this,"progress",mb),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:o,_aspectRatio:c}=this;return yt(e)?n&&c?c:o?s/o:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return In}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():If(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Pf(this.canvas,this.ctx),this}stop(){return Kn.stop(this),this}resize(e,n){Kn.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,o=this.canvas,c=s.maintainAspectRatio&&this.aspectRatio,f=this.platform.getMaximumSize(o,e,n,c),h=s.devicePixelRatio||this.platform.getDevicePixelRatio(),p=this.width?"resize":"attach";this.width=f.width,this.height=f.height,this._aspectRatio=this.aspectRatio,If(this,h,!0)&&(this.notifyPlugins("resize",{size:f}),ct(s.onResize,[this,f],this),this.attached&&this._doResize(p)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};rt(n,(s,o)=>{s.id=o})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,o=Object.keys(s).reduce((f,h)=>(f[h]=!1,f),{});let c=[];n&&(c=c.concat(Object.keys(n).map(f=>{const h=n[f],p=pl(f,h),g=p==="r",b=p==="x";return{options:h,dposition:g?"chartArea":b?"bottom":"left",dtype:g?"radialLinear":b?"category":"linear"}}))),rt(c,f=>{const h=f.options,p=h.id,g=pl(p,h),b=Ze(h.type,f.dtype);(h.position===void 0||sh(h.position,g)!==sh(f.dposition))&&(h.position=f.dposition),o[p]=!0;let _=null;if(p in s&&s[p].type===b)_=s[p];else{const T=In.getScale(b);_=new T({id:p,type:b,ctx:this.ctx,chart:this}),s[_.id]=_}_.init(h,e)}),rt(o,(f,h)=>{f||delete s[h]}),rt(s,f=>{pn.configure(this,f,f.options),pn.addBox(this,f)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((o,c)=>o.index-c.index),s>n){for(let o=n;o<s;++o)this._destroyDatasetMeta(o);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(oh("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,o)=>{n.filter(c=>c===s._dataset).length===0&&this._destroyDatasetMeta(o)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,o;for(this._removeUnreferencedMetasets(),s=0,o=n.length;s<o;s++){const c=n[s];let f=this.getDatasetMeta(s);const h=c.type||this.config.type;if(f.type&&f.type!==h&&(this._destroyDatasetMeta(s),f=this.getDatasetMeta(s)),f.type=h,f.indexAxis=c.indexAxis||dl(h,this.options),f.order=c.order||0,f.index=s,f.label=""+c.label,f.visible=this.isDatasetVisible(s),f.controller)f.controller.updateIndex(s),f.controller.linkScales();else{const p=In.getController(h),{datasetElementType:g,dataElementType:b}=_t.datasets[h];Object.assign(p,{dataElementType:In.getElement(b),datasetElementType:g&&In.getElement(g)}),f.controller=new p(this,s),e.push(f.controller)}}return this._updateMetasets(),e}_resetElements(){rt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),o=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const c=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let f=0;for(let g=0,b=this.data.datasets.length;g<b;g++){const{controller:_}=this.getDatasetMeta(g),T=!o&&c.indexOf(_)===-1;_.buildOrUpdateElements(T),f=Math.max(+_.getMaxOverflow(),f)}f=this._minPadding=s.layout.autoPadding?f:0,this._updateLayout(f),o||rt(c,g=>{g.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(oh("z","_idx"));const{_active:h,_lastEvent:p}=this;p?this._eventHandler(p,!0):h.length&&this._updateHoverStyles(h,h,!0),this.render()}_updateScales(){rt(this.scales,e=>{pn.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!_f(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:o,count:c}of n){const f=s==="_removeElements"?-c:c;vb(e,o,f)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=c=>new Set(e.filter(f=>f[0]===c).map((f,h)=>h+","+f.splice(1).join(","))),o=s(0);for(let c=1;c<n;c++)if(!_f(o,s(c)))return;return Array.from(o).map(c=>c.split(",")).map(c=>({method:c[1],start:+c[2],count:+c[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;pn.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],rt(this.boxes,o=>{s&&o.position==="chartArea"||(o.configure&&o.configure(),this._layers.push(...o._layers()))},this),this._layers.forEach((o,c)=>{o._idx=c}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,gi(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),o={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",o)!==!1&&(s.controller._update(n),o.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",o))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Kn.has(this)?this.attached&&!Kn.running(this)&&Kn.start(this):(this.draw(),ah({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:o}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,o)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let o,c;for(o=0,c=n.length;o<c;++o){const f=n[o];(!e||f.visible)&&s.push(f)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s=e._clip,o=!s.disabled,c=bb(e,this.chartArea),f={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",f)!==!1&&(o&&Il(n,{left:s.left===!1?0:c.left-s.left,right:s.right===!1?this.width:c.right+s.right,top:s.top===!1?0:c.top-s.top,bottom:s.bottom===!1?this.height:c.bottom+s.bottom}),e.controller.draw(),o&&El(n),f.cancelable=!1,this.notifyPlugins("afterDatasetDraw",f))}isPointInArea(e){return ws(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,o){const c=g0.modes[n];return typeof c=="function"?c(this,e,s,o):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let o=s.filter(c=>c&&c._dataset===n).pop();return o||(o={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(o)),o}getContext(){return this.$context||(this.$context=zi(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const o=s?"show":"hide",c=this.getDatasetMeta(e),f=c.controller._resolveAnimations(void 0,o);Ho(n)?(c.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),f.update(c,{visible:s}),this.update(h=>h.datasetIndex===e?o:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Kn.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Pf(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Po[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(c,f)=>{n.addEventListener(this,c,f),e[c]=f},o=(c,f,h)=>{c.offsetX=f,c.offsetY=h,this._eventHandler(c)};rt(this.options.events,c=>s(c,o))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(p,g)=>{n.addEventListener(this,p,g),e[p]=g},o=(p,g)=>{e[p]&&(n.removeEventListener(this,p,g),delete e[p])},c=(p,g)=>{this.canvas&&this.resize(p,g)};let f;const h=()=>{o("attach",h),this.attached=!0,this.resize(),s("resize",c),s("detach",f)};f=()=>{this.attached=!1,o("resize",c),this._stop(),this._resize(0,0),s("attach",h)},n.isAttached(this.canvas)?h():f()}unbindEvents(){rt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},rt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const o=s?"set":"remove";let c,f,h,p;for(n==="dataset"&&(c=this.getDatasetMeta(e[0].datasetIndex),c.controller["_"+o+"DatasetHoverStyle"]()),h=0,p=e.length;h<p;++h){f=e[h];const g=f&&this.getDatasetMeta(f.datasetIndex).controller;g&&g[o+"HoverStyle"](f.element,f.datasetIndex,f.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:c,index:f})=>{const h=this.getDatasetMeta(c);if(!h)throw new Error("No dataset found at index "+c);return{datasetIndex:c,element:h.data[f],index:f}});!Eo(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const o=this.options.hover,c=(p,g)=>p.filter(b=>!g.some(_=>b.datasetIndex===_.datasetIndex&&b.index===_.index)),f=c(n,e),h=s?e:c(e,n);f.length&&this.updateHoverStyle(f,o.mode,!1),h.length&&o.mode&&this.updateHoverStyle(h,o.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},o=f=>(f.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,o)===!1)return;const c=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,o),(c||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:o=[],options:c}=this,f=n,h=this._getActiveElements(e,o,s,f),p=Pv(e),g=yb(e,this._lastEvent,s,p);s&&(this._lastEvent=null,ct(c.onHover,[e,h,this],this),p&&ct(c.onClick,[e,h,this],this));const b=!Eo(h,o);return(b||n)&&(this._active=h,this._updateHoverStyles(h,o,n)),this._lastEvent=g,b}_getActiveElements(e,n,s,o){if(e.type==="mouseout")return[];if(!s)return n;const c=this.options.hover;return this.getElementsAtEventForMode(e,c.mode,c,o)}},ke(ui,"defaults",_t),ke(ui,"instances",Po),ke(ui,"overrides",Hi),ke(ui,"registry",In),ke(ui,"version",pb),ke(ui,"getChart",lh),ui);function ch(){return rt(Go.instances,i=>i._plugins.invalidate())}function Rd(i,e,n=e){i.lineCap=Ze(n.borderCapStyle,e.borderCapStyle),i.setLineDash(Ze(n.borderDash,e.borderDash)),i.lineDashOffset=Ze(n.borderDashOffset,e.borderDashOffset),i.lineJoin=Ze(n.borderJoinStyle,e.borderJoinStyle),i.lineWidth=Ze(n.borderWidth,e.borderWidth),i.strokeStyle=Ze(n.borderColor,e.borderColor)}function xb(i,e,n){i.lineTo(n.x,n.y)}function _b(i){return i.stepped?ry:i.tension||i.cubicInterpolationMode==="monotone"?sy:xb}function Fd(i,e,n={}){const s=i.length,{start:o=0,end:c=s-1}=n,{start:f,end:h}=e,p=Math.max(o,f),g=Math.min(c,h),b=o<f&&c<f||o>h&&c>h;return{count:s,start:p,loop:e.loop,ilen:g<p&&!b?s+g-p:g-p}}function wb(i,e,n,s){const{points:o,options:c}=e,{count:f,start:h,loop:p,ilen:g}=Fd(o,n,s),b=_b(c);let{move:_=!0,reverse:T}=s||{},L,D,P;for(L=0;L<=g;++L)D=o[(h+(T?g-L:L))%f],!D.skip&&(_?(i.moveTo(D.x,D.y),_=!1):b(i,P,D,T,c.stepped),P=D);return p&&(D=o[(h+(T?g:0))%f],b(i,P,D,T,c.stepped)),!!p}function kb(i,e,n,s){const o=e.points,{count:c,start:f,ilen:h}=Fd(o,n,s),{move:p=!0,reverse:g}=s||{};let b=0,_=0,T,L,D,P,N,E;const I=X=>(f+(g?h-X:X))%c,j=()=>{P!==N&&(i.lineTo(b,N),i.lineTo(b,P),i.lineTo(b,E))};for(p&&(L=o[I(0)],i.moveTo(L.x,L.y)),T=0;T<=h;++T){if(L=o[I(T)],L.skip)continue;const X=L.x,G=L.y,K=X|0;K===D?(G<P?P=G:G>N&&(N=G),b=(_*b+X)/++_):(j(),i.lineTo(X,G),D=K,_=0,P=N=G),E=G}j()}function gl(i){const e=i.options,n=e.borderDash&&e.borderDash.length;return!i._decimated&&!i._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?kb:wb}function Sb(i){return i.stepped?Hy:i.tension||i.cubicInterpolationMode==="monotone"?zy:Oi}function Cb(i,e,n,s){let o=e._path;o||(o=e._path=new Path2D,e.path(o,n,s)&&o.closePath()),Rd(i,e.options),i.stroke(o)}function Tb(i,e,n,s){const{segments:o,options:c}=e,f=gl(e);for(const h of o)Rd(i,c,h.style),i.beginPath(),f(i,e,h,{start:n,end:n+s-1})&&i.closePath(),i.stroke()}const Lb=typeof Path2D=="function";function Nb(i,e,n,s){Lb&&!e.options.segment?Cb(i,e,n,s):Tb(i,e,n,s)}class cs extends Jn{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const o=s.spanGaps?this._loop:this._fullLoop;Dy(this._points,s,e,o,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Xy(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,s=e.length;return s&&n[e[s-1].end]}interpolate(e,n){const s=this.options,o=e[n],c=this.points,f=jy(this,{property:n,start:o,end:o});if(!f.length)return;const h=[],p=Sb(s);let g,b;for(g=0,b=f.length;g<b;++g){const{start:_,end:T}=f[g],L=c[_],D=c[T];if(L===D){h.push(L);continue}const P=Math.abs((o-L[n])/(D[n]-L[n])),N=p(L,D,P,s.stepped);N[n]=e[n],h.push(N)}return h.length===1?h[0]:h}pathSegment(e,n,s){return gl(this)(e,this,n,s)}path(e,n,s){const o=this.segments,c=gl(this);let f=this._loop;n=n||0,s=s||this.points.length-n;for(const h of o)f&=c(e,this,h,{start:n,end:n+s-1});return!!f}draw(e,n,s,o){const c=this.options||{};(this.points||[]).length&&c.borderWidth&&(e.save(),Nb(e,this,s,o),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}ke(cs,"id","line"),ke(cs,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),ke(cs,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),ke(cs,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function uh(i,e,n,s){const o=i.options,{[n]:c}=i.getProps([n],s);return Math.abs(e-c)<o.radius+o.hitRadius}class Oo extends Jn{constructor(n){super();ke(this,"parsed");ke(this,"skip");ke(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,s,o){const c=this.options,{x:f,y:h}=this.getProps(["x","y"],o);return Math.pow(n-f,2)+Math.pow(s-h,2)<Math.pow(c.hitRadius+c.radius,2)}inXRange(n,s){return uh(this,n,"x",s)}inYRange(n,s){return uh(this,n,"y",s)}getCenterPoint(n){const{x:s,y:o}=this.getProps(["x","y"],n);return{x:s,y:o}}size(n){n=n||this.options||{};let s=n.radius||0;s=Math.max(s,s&&n.hoverRadius||0);const o=s&&n.borderWidth||0;return(s+o)*2}draw(n,s){const o=this.options;this.skip||o.radius<.1||!ws(this,s,this.size(o)/2)||(n.strokeStyle=o.borderColor,n.lineWidth=o.borderWidth,n.fillStyle=o.backgroundColor,fl(n,o,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}ke(Oo,"id","point"),ke(Oo,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),ke(Oo,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const fh=(i,e)=>{let{boxHeight:n=e,boxWidth:s=e}=i;return i.usePointStyle&&(n=Math.min(n,e),s=i.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},Mb=(i,e)=>i!==null&&e!==null&&i.datasetIndex===e.datasetIndex&&i.index===e.index;class hh extends Jn{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=ct(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,o)=>e.sort(s,o,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,o=Ut(s.font),c=o.size,f=this._computeTitleHeight(),{boxWidth:h,itemHeight:p}=fh(s,c);let g,b;n.font=o.string,this.isHorizontal()?(g=this.maxWidth,b=this._fitRows(f,c,h,p)+10):(b=this.maxHeight,g=this._fitCols(f,o,h,p)+10),this.width=Math.min(g,e.maxWidth||this.maxWidth),this.height=Math.min(b,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,o){const{ctx:c,maxWidth:f,options:{labels:{padding:h}}}=this,p=this.legendHitBoxes=[],g=this.lineWidths=[0],b=o+h;let _=e;c.textAlign="left",c.textBaseline="middle";let T=-1,L=-b;return this.legendItems.forEach((D,P)=>{const N=s+n/2+c.measureText(D.text).width;(P===0||g[g.length-1]+N+2*h>f)&&(_+=b,g[g.length-(P>0?0:1)]=0,L+=b,T++),p[P]={left:0,top:L,row:T,width:N,height:o},g[g.length-1]+=N+h}),_}_fitCols(e,n,s,o){const{ctx:c,maxHeight:f,options:{labels:{padding:h}}}=this,p=this.legendHitBoxes=[],g=this.columnSizes=[],b=f-e;let _=h,T=0,L=0,D=0,P=0;return this.legendItems.forEach((N,E)=>{const{itemWidth:I,itemHeight:j}=Db(s,n,c,N,o);E>0&&L+j+2*h>b&&(_+=T+h,g.push({width:T,height:L}),D+=T+h,P++,T=L=0),p[E]={left:D,top:L,col:P,width:I,height:j},T=Math.max(T,I),L+=j+h}),_+=T,g.push({width:T,height:L}),_}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:o},rtl:c}}=this,f=fr(c,this.left,this.width);if(this.isHorizontal()){let h=0,p=Bt(s,this.left+o,this.right-this.lineWidths[h]);for(const g of n)h!==g.row&&(h=g.row,p=Bt(s,this.left+o,this.right-this.lineWidths[h])),g.top+=this.top+e+o,g.left=f.leftForLtr(f.x(p),g.width),p+=g.width+o}else{let h=0,p=Bt(s,this.top+e+o,this.bottom-this.columnSizes[h].height);for(const g of n)g.col!==h&&(h=g.col,p=Bt(s,this.top+e+o,this.bottom-this.columnSizes[h].height)),g.top=p,g.left+=this.left+o,g.left=f.leftForLtr(f.x(g.left),g.width),p+=g.height+o}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Il(e,this),this._draw(),El(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:o}=this,{align:c,labels:f}=e,h=_t.color,p=fr(e.rtl,this.left,this.width),g=Ut(f.font),{padding:b}=f,_=g.size,T=_/2;let L;this.drawTitle(),o.textAlign=p.textAlign("left"),o.textBaseline="middle",o.lineWidth=.5,o.font=g.string;const{boxWidth:D,boxHeight:P,itemHeight:N}=fh(f,_),E=function(K,Y,Q){if(isNaN(D)||D<=0||isNaN(P)||P<0)return;o.save();const he=Ze(Q.lineWidth,1);if(o.fillStyle=Ze(Q.fillStyle,h),o.lineCap=Ze(Q.lineCap,"butt"),o.lineDashOffset=Ze(Q.lineDashOffset,0),o.lineJoin=Ze(Q.lineJoin,"miter"),o.lineWidth=he,o.strokeStyle=Ze(Q.strokeStyle,h),o.setLineDash(Ze(Q.lineDash,[])),f.usePointStyle){const fe={radius:P*Math.SQRT2/2,pointStyle:Q.pointStyle,rotation:Q.rotation,borderWidth:he},oe=p.xPlus(K,D/2),se=Y+T;gd(o,fe,oe,se,f.pointStyleWidth&&D)}else{const fe=Y+Math.max((_-P)/2,0),oe=p.leftForLtr(K,D),se=ms(Q.borderRadius);o.beginPath(),Object.values(se).some(R=>R!==0)?hl(o,{x:oe,y:fe,w:D,h:P,radius:se}):o.rect(oe,fe,D,P),o.fill(),he!==0&&o.stroke()}o.restore()},I=function(K,Y,Q){ks(o,Q.text,K,Y+N/2,g,{strikethrough:Q.hidden,textAlign:p.textAlign(Q.textAlign)})},j=this.isHorizontal(),X=this._computeTitleHeight();j?L={x:Bt(c,this.left+b,this.right-s[0]),y:this.top+b+X,line:0}:L={x:this.left+b,y:Bt(c,this.top+X+b,this.bottom-n[0].height),line:0},wd(this.ctx,e.textDirection);const G=N+b;this.legendItems.forEach((K,Y)=>{o.strokeStyle=K.fontColor,o.fillStyle=K.fontColor;const Q=o.measureText(K.text).width,he=p.textAlign(K.textAlign||(K.textAlign=f.textAlign)),fe=D+T+Q;let oe=L.x,se=L.y;p.setWidth(this.width),j?Y>0&&oe+fe+b>this.right&&(se=L.y+=G,L.line++,oe=L.x=Bt(c,this.left+b,this.right-s[L.line])):Y>0&&se+G>this.bottom&&(oe=L.x=oe+n[L.line].width+b,L.line++,se=L.y=Bt(c,this.top+X+b,this.bottom-n[L.line].height));const R=p.x(oe);if(E(R,se,K),oe=Kv(he,oe+D+T,j?oe+fe:this.right,e.rtl),I(p.x(oe),se,K),j)L.x+=fe+b;else if(typeof K.text!="string"){const F=g.lineHeight;L.y+=Hd(K,F)+b}else L.y+=G}),kd(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=Ut(n.font),o=mn(n.padding);if(!n.display)return;const c=fr(e.rtl,this.left,this.width),f=this.ctx,h=n.position,p=s.size/2,g=o.top+p;let b,_=this.left,T=this.width;if(this.isHorizontal())T=Math.max(...this.lineWidths),b=this.top+g,_=Bt(e.align,_,this.right-T);else{const D=this.columnSizes.reduce((P,N)=>Math.max(P,N.height),0);b=g+Bt(e.align,this.top,this.bottom-D-e.labels.padding-this._computeTitleHeight())}const L=Bt(h,_,_+T);f.textAlign=c.textAlign(Ol(h)),f.textBaseline="middle",f.strokeStyle=n.color,f.fillStyle=n.color,f.font=s.string,ks(f,n.text,L,b,s)}_computeTitleHeight(){const e=this.options.title,n=Ut(e.font),s=mn(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,o,c;if(as(e,this.left,this.right)&&as(n,this.top,this.bottom)){for(c=this.legendHitBoxes,s=0;s<c.length;++s)if(o=c[s],as(e,o.left,o.left+o.width)&&as(n,o.top,o.top+o.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!Ab(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const o=this._hoveredItem,c=Mb(o,s);o&&!c&&ct(n.onLeave,[e,o,this],this),this._hoveredItem=s,s&&!c&&ct(n.onHover,[e,s,this],this)}else s&&ct(n.onClick,[e,s,this],this)}}function Db(i,e,n,s,o){const c=Pb(s,i,e,n),f=Ob(o,s,e.lineHeight);return{itemWidth:c,itemHeight:f}}function Pb(i,e,n,s){let o=i.text;return o&&typeof o!="string"&&(o=o.reduce((c,f)=>c.length>f.length?c:f)),e+n.size/2+s.measureText(o).width}function Ob(i,e,n){let s=i;return typeof e.text!="string"&&(s=Hd(e,n)),s}function Hd(i,e){const n=i.text?i.text.length:0;return e*n}function Ab(i,e){return!!((i==="mousemove"||i==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(i==="click"||i==="mouseup"))}var Ib={id:"legend",_element:hh,start(i,e,n){const s=i.legend=new hh({ctx:i.ctx,options:n,chart:i});pn.configure(i,s,n),pn.addBox(i,s)},stop(i){pn.removeBox(i,i.legend),delete i.legend},beforeUpdate(i,e,n){const s=i.legend;pn.configure(i,s,n),s.options=n},afterUpdate(i){const e=i.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(i,e){e.replay||i.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(i,e,n){const s=e.datasetIndex,o=n.chart;o.isDatasetVisible(s)?(o.hide(s),e.hidden=!0):(o.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:i=>i.chart.options.color,boxWidth:40,padding:10,generateLabels(i){const e=i.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:o,color:c,useBorderRadius:f,borderRadius:h}}=i.legend.options;return i._getSortedDatasetMetas().map(p=>{const g=p.controller.getStyle(n?0:void 0),b=mn(g.borderWidth);return{text:e[p.index].label,fillStyle:g.backgroundColor,fontColor:c,hidden:!p.visible,lineCap:g.borderCapStyle,lineDash:g.borderDash,lineDashOffset:g.borderDashOffset,lineJoin:g.borderJoinStyle,lineWidth:(b.width+b.height)/4,strokeStyle:g.borderColor,pointStyle:s||g.pointStyle,rotation:g.rotation,textAlign:o||g.textAlign,borderRadius:f&&(h||g.borderRadius),datasetIndex:p.index}},this)}},title:{color:i=>i.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:i=>!i.startsWith("on"),labels:{_scriptable:i=>!["generateLabels","filter","sort"].includes(i)}}};class zd extends Jn{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const o=Mt(s.text)?s.text.length:1;this._padding=mn(s.padding);const c=o*Ut(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=c:this.width=c}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:s,bottom:o,right:c,options:f}=this,h=f.align;let p=0,g,b,_;return this.isHorizontal()?(b=Bt(h,s,c),_=n+e,g=c-s):(f.position==="left"?(b=s+e,_=Bt(h,o,n),p=Pt*-.5):(b=c-e,_=Bt(h,n,o),p=Pt*.5),g=o-n),{titleX:b,titleY:_,maxWidth:g,rotation:p}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const s=Ut(n.font),c=s.lineHeight/2+this._padding.top,{titleX:f,titleY:h,maxWidth:p,rotation:g}=this._drawArgs(c);ks(e,n.text,0,0,s,{color:n.color,maxWidth:p,rotation:g,textAlign:Ol(n.align),textBaseline:"middle",translation:[f,h]})}}function Eb(i,e){const n=new zd({ctx:i.ctx,options:e,chart:i});pn.configure(i,n,e),pn.addBox(i,n),i.titleBlock=n}var Rb={id:"title",_element:zd,start(i,e,n){Eb(i,n)},stop(i){const e=i.titleBlock;pn.removeBox(i,e),delete i.titleBlock},beforeUpdate(i,e,n){const s=i.titleBlock;pn.configure(i,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const us={average(i){if(!i.length)return!1;let e,n,s=new Set,o=0,c=0;for(e=0,n=i.length;e<n;++e){const h=i[e].element;if(h&&h.hasValue()){const p=h.tooltipPosition();s.add(p.x),o+=p.y,++c}}return c===0||s.size===0?!1:{x:[...s].reduce((h,p)=>h+p)/s.size,y:o/c}},nearest(i,e){if(!i.length)return!1;let n=e.x,s=e.y,o=Number.POSITIVE_INFINITY,c,f,h;for(c=0,f=i.length;c<f;++c){const p=i[c].element;if(p&&p.hasValue()){const g=p.getCenterPoint(),b=cl(e,g);b<o&&(o=b,h=p)}}if(h){const p=h.tooltipPosition();n=p.x,s=p.y}return{x:n,y:s}}};function An(i,e){return e&&(Mt(e)?Array.prototype.push.apply(i,e):i.push(e)),i}function Xn(i){return(typeof i=="string"||i instanceof String)&&i.indexOf(`
`)>-1?i.split(`
`):i}function Fb(i,e){const{element:n,datasetIndex:s,index:o}=e,c=i.getDatasetMeta(s).controller,{label:f,value:h}=c.getLabelAndValue(o);return{chart:i,label:f,parsed:c.getParsed(o),raw:i.data.datasets[s].data[o],formattedValue:h,dataset:c.getDataset(),dataIndex:o,datasetIndex:s,element:n}}function dh(i,e){const n=i.chart.ctx,{body:s,footer:o,title:c}=i,{boxWidth:f,boxHeight:h}=e,p=Ut(e.bodyFont),g=Ut(e.titleFont),b=Ut(e.footerFont),_=c.length,T=o.length,L=s.length,D=mn(e.padding);let P=D.height,N=0,E=s.reduce((X,G)=>X+G.before.length+G.lines.length+G.after.length,0);if(E+=i.beforeBody.length+i.afterBody.length,_&&(P+=_*g.lineHeight+(_-1)*e.titleSpacing+e.titleMarginBottom),E){const X=e.displayColors?Math.max(h,p.lineHeight):p.lineHeight;P+=L*X+(E-L)*p.lineHeight+(E-1)*e.bodySpacing}T&&(P+=e.footerMarginTop+T*b.lineHeight+(T-1)*e.footerSpacing);let I=0;const j=function(X){N=Math.max(N,n.measureText(X).width+I)};return n.save(),n.font=g.string,rt(i.title,j),n.font=p.string,rt(i.beforeBody.concat(i.afterBody),j),I=e.displayColors?f+2+e.boxPadding:0,rt(s,X=>{rt(X.before,j),rt(X.lines,j),rt(X.after,j)}),I=0,n.font=b.string,rt(i.footer,j),n.restore(),N+=D.width,{width:N,height:P}}function Hb(i,e){const{y:n,height:s}=e;return n<s/2?"top":n>i.height-s/2?"bottom":"center"}function zb(i,e,n,s){const{x:o,width:c}=s,f=n.caretSize+n.caretPadding;if(i==="left"&&o+c+f>e.width||i==="right"&&o-c-f<0)return!0}function Wb(i,e,n,s){const{x:o,width:c}=n,{width:f,chartArea:{left:h,right:p}}=i;let g="center";return s==="center"?g=o<=(h+p)/2?"left":"right":o<=c/2?g="left":o>=f-c/2&&(g="right"),zb(g,i,e,n)&&(g="center"),g}function ph(i,e,n){const s=n.yAlign||e.yAlign||Hb(i,n);return{xAlign:n.xAlign||e.xAlign||Wb(i,e,n,s),yAlign:s}}function Bb(i,e){let{x:n,width:s}=i;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function Ub(i,e,n){let{y:s,height:o}=i;return e==="top"?s+=n:e==="bottom"?s-=o+n:s-=o/2,s}function gh(i,e,n,s){const{caretSize:o,caretPadding:c,cornerRadius:f}=i,{xAlign:h,yAlign:p}=n,g=o+c,{topLeft:b,topRight:_,bottomLeft:T,bottomRight:L}=ms(f);let D=Bb(e,h);const P=Ub(e,p,g);return p==="center"?h==="left"?D+=g:h==="right"&&(D-=g):h==="left"?D-=Math.max(b,T)+o:h==="right"&&(D+=Math.max(_,L)+o),{x:dn(D,0,s.width-e.width),y:dn(P,0,s.height-e.height)}}function So(i,e,n){const s=mn(n.padding);return e==="center"?i.x+i.width/2:e==="right"?i.x+i.width-s.right:i.x+s.left}function mh(i){return An([],Xn(i))}function $b(i,e,n){return zi(i,{tooltip:e,tooltipItems:n,type:"tooltip"})}function vh(i,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?i.override(n):i}const Wd={beforeTitle:Vn,title(i){if(i.length>0){const e=i[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Vn,beforeBody:Vn,beforeLabel:Vn,label(i){if(this&&this.options&&this.options.mode==="dataset")return i.label+": "+i.formattedValue||i.formattedValue;let e=i.dataset.label||"";e&&(e+=": ");const n=i.formattedValue;return yt(n)||(e+=n),e},labelColor(i){const n=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(i){const n=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Vn,afterBody:Vn,beforeFooter:Vn,footer:Vn,afterFooter:Vn};function en(i,e,n,s){const o=i[e].call(n,s);return typeof o>"u"?Wd[e].call(n,s):o}class ml extends Jn{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),o=s.enabled&&n.options.animation&&s.animations,c=new Cd(this.chart,o);return o._cacheable&&(this._cachedAnimations=Object.freeze(c)),c}getContext(){return this.$context||(this.$context=$b(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,o=en(s,"beforeTitle",this,e),c=en(s,"title",this,e),f=en(s,"afterTitle",this,e);let h=[];return h=An(h,Xn(o)),h=An(h,Xn(c)),h=An(h,Xn(f)),h}getBeforeBody(e,n){return mh(en(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,o=[];return rt(e,c=>{const f={before:[],lines:[],after:[]},h=vh(s,c);An(f.before,Xn(en(h,"beforeLabel",this,c))),An(f.lines,en(h,"label",this,c)),An(f.after,Xn(en(h,"afterLabel",this,c))),o.push(f)}),o}getAfterBody(e,n){return mh(en(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,o=en(s,"beforeFooter",this,e),c=en(s,"footer",this,e),f=en(s,"afterFooter",this,e);let h=[];return h=An(h,Xn(o)),h=An(h,Xn(c)),h=An(h,Xn(f)),h}_createItems(e){const n=this._active,s=this.chart.data,o=[],c=[],f=[];let h=[],p,g;for(p=0,g=n.length;p<g;++p)h.push(Fb(this.chart,n[p]));return e.filter&&(h=h.filter((b,_,T)=>e.filter(b,_,T,s))),e.itemSort&&(h=h.sort((b,_)=>e.itemSort(b,_,s))),rt(h,b=>{const _=vh(e.callbacks,b);o.push(en(_,"labelColor",this,b)),c.push(en(_,"labelPointStyle",this,b)),f.push(en(_,"labelTextColor",this,b))}),this.labelColors=o,this.labelPointStyles=c,this.labelTextColors=f,this.dataPoints=h,h}update(e,n){const s=this.options.setContext(this.getContext()),o=this._active;let c,f=[];if(!o.length)this.opacity!==0&&(c={opacity:0});else{const h=us[s.position].call(this,o,this._eventPosition);f=this._createItems(s),this.title=this.getTitle(f,s),this.beforeBody=this.getBeforeBody(f,s),this.body=this.getBody(f,s),this.afterBody=this.getAfterBody(f,s),this.footer=this.getFooter(f,s);const p=this._size=dh(this,s),g=Object.assign({},h,p),b=ph(this.chart,s,g),_=gh(s,g,b,this.chart);this.xAlign=b.xAlign,this.yAlign=b.yAlign,c={opacity:1,x:_.x,y:_.y,width:p.width,height:p.height,caretX:h.x,caretY:h.y}}this._tooltipItems=f,this.$context=void 0,c&&this._resolveAnimations().update(this,c),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,o){const c=this.getCaretPosition(e,s,o);n.lineTo(c.x1,c.y1),n.lineTo(c.x2,c.y2),n.lineTo(c.x3,c.y3)}getCaretPosition(e,n,s){const{xAlign:o,yAlign:c}=this,{caretSize:f,cornerRadius:h}=s,{topLeft:p,topRight:g,bottomLeft:b,bottomRight:_}=ms(h),{x:T,y:L}=e,{width:D,height:P}=n;let N,E,I,j,X,G;return c==="center"?(X=L+P/2,o==="left"?(N=T,E=N-f,j=X+f,G=X-f):(N=T+D,E=N+f,j=X-f,G=X+f),I=N):(o==="left"?E=T+Math.max(p,b)+f:o==="right"?E=T+D-Math.max(g,_)-f:E=this.caretX,c==="top"?(j=L,X=j-f,N=E-f,I=E+f):(j=L+P,X=j+f,N=E+f,I=E-f),G=j),{x1:N,x2:E,x3:I,y1:j,y2:X,y3:G}}drawTitle(e,n,s){const o=this.title,c=o.length;let f,h,p;if(c){const g=fr(s.rtl,this.x,this.width);for(e.x=So(this,s.titleAlign,s),n.textAlign=g.textAlign(s.titleAlign),n.textBaseline="middle",f=Ut(s.titleFont),h=s.titleSpacing,n.fillStyle=s.titleColor,n.font=f.string,p=0;p<c;++p)n.fillText(o[p],g.x(e.x),e.y+f.lineHeight/2),e.y+=f.lineHeight+h,p+1===c&&(e.y+=s.titleMarginBottom-h)}}_drawColorBox(e,n,s,o,c){const f=this.labelColors[s],h=this.labelPointStyles[s],{boxHeight:p,boxWidth:g}=c,b=Ut(c.bodyFont),_=So(this,"left",c),T=o.x(_),L=p<b.lineHeight?(b.lineHeight-p)/2:0,D=n.y+L;if(c.usePointStyle){const P={radius:Math.min(g,p)/2,pointStyle:h.pointStyle,rotation:h.rotation,borderWidth:1},N=o.leftForLtr(T,g)+g/2,E=D+p/2;e.strokeStyle=c.multiKeyBackground,e.fillStyle=c.multiKeyBackground,fl(e,P,N,E),e.strokeStyle=f.borderColor,e.fillStyle=f.backgroundColor,fl(e,P,N,E)}else{e.lineWidth=nt(f.borderWidth)?Math.max(...Object.values(f.borderWidth)):f.borderWidth||1,e.strokeStyle=f.borderColor,e.setLineDash(f.borderDash||[]),e.lineDashOffset=f.borderDashOffset||0;const P=o.leftForLtr(T,g),N=o.leftForLtr(o.xPlus(T,1),g-2),E=ms(f.borderRadius);Object.values(E).some(I=>I!==0)?(e.beginPath(),e.fillStyle=c.multiKeyBackground,hl(e,{x:P,y:D,w:g,h:p,radius:E}),e.fill(),e.stroke(),e.fillStyle=f.backgroundColor,e.beginPath(),hl(e,{x:N,y:D+1,w:g-2,h:p-2,radius:E}),e.fill()):(e.fillStyle=c.multiKeyBackground,e.fillRect(P,D,g,p),e.strokeRect(P,D,g,p),e.fillStyle=f.backgroundColor,e.fillRect(N,D+1,g-2,p-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:o}=this,{bodySpacing:c,bodyAlign:f,displayColors:h,boxHeight:p,boxWidth:g,boxPadding:b}=s,_=Ut(s.bodyFont);let T=_.lineHeight,L=0;const D=fr(s.rtl,this.x,this.width),P=function(Q){n.fillText(Q,D.x(e.x+L),e.y+T/2),e.y+=T+c},N=D.textAlign(f);let E,I,j,X,G,K,Y;for(n.textAlign=f,n.textBaseline="middle",n.font=_.string,e.x=So(this,N,s),n.fillStyle=s.bodyColor,rt(this.beforeBody,P),L=h&&N!=="right"?f==="center"?g/2+b:g+2+b:0,X=0,K=o.length;X<K;++X){for(E=o[X],I=this.labelTextColors[X],n.fillStyle=I,rt(E.before,P),j=E.lines,h&&j.length&&(this._drawColorBox(n,e,X,D,s),T=Math.max(_.lineHeight,p)),G=0,Y=j.length;G<Y;++G)P(j[G]),T=_.lineHeight;rt(E.after,P)}L=0,T=_.lineHeight,rt(this.afterBody,P),e.y-=c}drawFooter(e,n,s){const o=this.footer,c=o.length;let f,h;if(c){const p=fr(s.rtl,this.x,this.width);for(e.x=So(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=p.textAlign(s.footerAlign),n.textBaseline="middle",f=Ut(s.footerFont),n.fillStyle=s.footerColor,n.font=f.string,h=0;h<c;++h)n.fillText(o[h],p.x(e.x),e.y+f.lineHeight/2),e.y+=f.lineHeight+s.footerSpacing}}drawBackground(e,n,s,o){const{xAlign:c,yAlign:f}=this,{x:h,y:p}=e,{width:g,height:b}=s,{topLeft:_,topRight:T,bottomLeft:L,bottomRight:D}=ms(o.cornerRadius);n.fillStyle=o.backgroundColor,n.strokeStyle=o.borderColor,n.lineWidth=o.borderWidth,n.beginPath(),n.moveTo(h+_,p),f==="top"&&this.drawCaret(e,n,s,o),n.lineTo(h+g-T,p),n.quadraticCurveTo(h+g,p,h+g,p+T),f==="center"&&c==="right"&&this.drawCaret(e,n,s,o),n.lineTo(h+g,p+b-D),n.quadraticCurveTo(h+g,p+b,h+g-D,p+b),f==="bottom"&&this.drawCaret(e,n,s,o),n.lineTo(h+L,p+b),n.quadraticCurveTo(h,p+b,h,p+b-L),f==="center"&&c==="left"&&this.drawCaret(e,n,s,o),n.lineTo(h,p+_),n.quadraticCurveTo(h,p,h+_,p),n.closePath(),n.fill(),o.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,o=s&&s.x,c=s&&s.y;if(o||c){const f=us[e.position].call(this,this._active,this._eventPosition);if(!f)return;const h=this._size=dh(this,e),p=Object.assign({},f,this._size),g=ph(n,e,p),b=gh(e,p,g,n);(o._to!==b.x||c._to!==b.y)&&(this.xAlign=g.xAlign,this.yAlign=g.yAlign,this.width=h.width,this.height=h.height,this.caretX=f.x,this.caretY=f.y,this._resolveAnimations().update(this,b))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const o={width:this.width,height:this.height},c={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const f=mn(n.padding),h=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&h&&(e.save(),e.globalAlpha=s,this.drawBackground(c,e,o,n),wd(e,n.textDirection),c.y+=f.top,this.drawTitle(c,e,n),this.drawBody(c,e,n),this.drawFooter(c,e,n),kd(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,o=e.map(({datasetIndex:h,index:p})=>{const g=this.chart.getDatasetMeta(h);if(!g)throw new Error("Cannot find a dataset at index "+h);return{datasetIndex:h,element:g.data[p],index:p}}),c=!Eo(s,o),f=this._positionChanged(o,n);(c||f)&&(this._active=o,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const o=this.options,c=this._active||[],f=this._getActiveElements(e,c,n,s),h=this._positionChanged(f,e),p=n||!Eo(f,c)||h;return p&&(this._active=f,(o.enabled||o.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),p}_getActiveElements(e,n,s,o){const c=this.options;if(e.type==="mouseout")return[];if(!o)return n.filter(h=>this.chart.data.datasets[h.datasetIndex]&&this.chart.getDatasetMeta(h.datasetIndex).controller.getParsed(h.index)!==void 0);const f=this.chart.getElementsAtEventForMode(e,c.mode,c,s);return c.reverse&&f.reverse(),f}_positionChanged(e,n){const{caretX:s,caretY:o,options:c}=this,f=us[c.position].call(this,e,n);return f!==!1&&(s!==f.x||o!==f.y)}}ke(ml,"positioners",us);var jb={id:"tooltip",_element:ml,positioners:us,afterInit(i,e,n){n&&(i.tooltip=new ml({chart:i,options:n}))},beforeUpdate(i,e,n){i.tooltip&&i.tooltip.initialize(n)},reset(i,e,n){i.tooltip&&i.tooltip.initialize(n)},afterDraw(i){const e=i.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(i.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(i.ctx),i.notifyPlugins("afterTooltipDraw",n)}},afterEvent(i,e){if(i.tooltip){const n=e.replay;i.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(i,e)=>e.bodyFont.size,boxWidth:(i,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Wd},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:i=>i!=="filter"&&i!=="itemSort"&&i!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Vb=(i,e,n,s)=>(typeof e=="string"?(n=i.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function Kb(i,e,n,s){const o=i.indexOf(e);if(o===-1)return Vb(i,e,n,s);const c=i.lastIndexOf(e);return o!==c?n:o}const Xb=(i,e)=>i===null?null:dn(Math.round(i),0,e);function yh(i){const e=this.getLabels();return i>=0&&i<e.length?e[i]:i}class vl extends yr{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:o,label:c}of n)s[o]===c&&s.splice(o,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(yt(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:Kb(s,e,Ze(n,e),this._addedLabels),Xb(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:o}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(o=this.getLabels().length-1)),this.min=s,this.max=o}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,o=[];let c=this.getLabels();c=e===0&&n===c.length-1?c:c.slice(e,n+1),this._valueRange=Math.max(c.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let f=e;f<=n;f++)o.push({value:f});return o}getLabelForValue(e){return yh.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}ke(vl,"id","category"),ke(vl,"defaults",{ticks:{callback:yh}});function Gb(i,e){const n=[],{bounds:o,step:c,min:f,max:h,precision:p,count:g,maxTicks:b,maxDigits:_,includeBounds:T}=i,L=c||1,D=b-1,{min:P,max:N}=e,E=!yt(f),I=!yt(h),j=!yt(g),X=(N-P)/(_+1);let G=kf((N-P)/D/L)*L,K,Y,Q,he;if(G<1e-14&&!E&&!I)return[{value:P},{value:N}];he=Math.ceil(N/G)-Math.floor(P/G),he>D&&(G=kf(he*G/D/L)*L),yt(p)||(K=Math.pow(10,p),G=Math.ceil(G*K)/K),o==="ticks"?(Y=Math.floor(P/G)*G,Q=Math.ceil(N/G)*G):(Y=P,Q=N),E&&I&&c&&Ev((h-f)/c,G/1e3)?(he=Math.round(Math.min((h-f)/G,b)),G=(h-f)/he,Y=f,Q=h):j?(Y=E?f:Y,Q=I?h:Q,he=g-1,G=(Q-Y)/he):(he=(Q-Y)/G,ds(he,Math.round(he),G/1e3)?he=Math.round(he):he=Math.ceil(he));const fe=Math.max(Sf(G),Sf(Y));K=Math.pow(10,yt(p)?fe:p),Y=Math.round(Y*K)/K,Q=Math.round(Q*K)/K;let oe=0;for(E&&(T&&Y!==f?(n.push({value:f}),Y<f&&oe++,ds(Math.round((Y+oe*G)*K)/K,f,bh(f,X,i))&&oe++):Y<f&&oe++);oe<he;++oe){const se=Math.round((Y+oe*G)*K)/K;if(I&&se>h)break;n.push({value:se})}return I&&T&&Q!==h?n.length&&ds(n[n.length-1].value,h,bh(h,X,i))?n[n.length-1].value=h:n.push({value:h}):(!I||Q===h)&&n.push({value:Q}),n}function bh(i,e,{horizontal:n,minRotation:s}){const o=Ii(s),c=(n?Math.sin(o):Math.cos(o))||.001,f=.75*e*(""+i).length;return Math.min(e/c,f)}class qb extends yr{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return yt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:o,max:c}=this;const f=p=>o=n?o:p,h=p=>c=s?c:p;if(e){const p=pr(o),g=pr(c);p<0&&g<0?h(0):p>0&&g>0&&f(0)}if(o===c){let p=c===0?1:Math.abs(c*.05);h(c+p),e||f(o-p)}this.min=o,this.max=c}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,o;return s?(o=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,o>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${o} ticks. Limiting to 1000.`),o=1e3)):(o=this.computeTickLimit(),n=n||11),n&&(o=Math.min(n,o)),o}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const o={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},c=this._range||this,f=Gb(o,c);return e.bounds==="ticks"&&Rv(f,this,"value"),e.reverse?(f.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),f}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const o=(s-n)/Math.max(e.length-1,1)/2;n-=o,s+=o}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return hd(e,this.chart.options.locale,this.options.ticks.format)}}class yl extends qb{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=gn(e)?e:0,this.max=gn(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Ii(this.options.ticks.minRotation),o=(e?Math.sin(s):Math.cos(s))||.001,c=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,c.lineHeight/o))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}ke(yl,"id","linear"),ke(yl,"defaults",{ticks:{callback:pd.formatters.numeric}});const qo={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},nn=Object.keys(qo);function xh(i,e){return i-e}function _h(i,e){if(yt(e))return null;const n=i._adapter,{parser:s,round:o,isoWeekday:c}=i._parseOpts;let f=e;return typeof s=="function"&&(f=s(f)),gn(f)||(f=typeof s=="string"?n.parse(f,s):n.parse(f)),f===null?null:(o&&(f=o==="week"&&(_s(c)||c===!0)?n.startOf(f,"isoWeek",c):n.startOf(f,o)),+f)}function wh(i,e,n,s){const o=nn.length;for(let c=nn.indexOf(i);c<o-1;++c){const f=qo[nn[c]],h=f.steps?f.steps:Number.MAX_SAFE_INTEGER;if(f.common&&Math.ceil((n-e)/(h*f.size))<=s)return nn[c]}return nn[o-1]}function Yb(i,e,n,s,o){for(let c=nn.length-1;c>=nn.indexOf(n);c--){const f=nn[c];if(qo[f].common&&i._adapter.diff(o,s,f)>=e-1)return f}return nn[n?nn.indexOf(n):0]}function Zb(i){for(let e=nn.indexOf(i)+1,n=nn.length;e<n;++e)if(qo[nn[e]].common)return nn[e]}function kh(i,e,n){if(!n)i[e]=!0;else if(n.length){const{lo:s,hi:o}=Pl(n,e),c=n[s]>=e?n[s]:n[o];i[c]=!0}}function Jb(i,e,n,s){const o=i._adapter,c=+o.startOf(e[0].value,s),f=e[e.length-1].value;let h,p;for(h=c;h<=f;h=+o.add(h,1,s))p=n[h],p>=0&&(e[p].major=!0);return e}function Sh(i,e,n){const s=[],o={},c=e.length;let f,h;for(f=0;f<c;++f)h=e[f],o[h]=f,s.push({value:h,major:!1});return c===0||!n?s:Jb(i,s,o,n)}class Uo extends yr{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),o=this._adapter=new u0._date(e.adapters.date);o.init(n),hs(s.displayFormats,o.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:_h(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:o,max:c,minDefined:f,maxDefined:h}=this.getUserBounds();function p(g){!f&&!isNaN(g.min)&&(o=Math.min(o,g.min)),!h&&!isNaN(g.max)&&(c=Math.max(c,g.max))}(!f||!h)&&(p(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&p(this.getMinMax(!1))),o=gn(o)&&!isNaN(o)?o:+n.startOf(Date.now(),s),c=gn(c)&&!isNaN(c)?c:+n.endOf(Date.now(),s)+1,this.min=Math.min(o,c-1),this.max=Math.max(o+1,c)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,o=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&o.length&&(this.min=this._userMin||o[0],this.max=this._userMax||o[o.length-1]);const c=this.min,f=this.max,h=Uv(o,c,f);return this._unit=n.unit||(s.autoSkip?wh(n.minUnit,this.min,this.max,this._getLabelCapacity(c)):Yb(this,h.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:Zb(this._unit),this.initOffsets(o),e.reverse&&h.reverse(),Sh(this,h,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,o,c;this.options.offset&&e.length&&(o=this.getDecimalForValue(e[0]),e.length===1?n=1-o:n=(this.getDecimalForValue(e[1])-o)/2,c=this.getDecimalForValue(e[e.length-1]),e.length===1?s=c:s=(c-this.getDecimalForValue(e[e.length-2]))/2);const f=e.length<3?.5:.25;n=dn(n,0,f),s=dn(s,0,f),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,o=this.options,c=o.time,f=c.unit||wh(c.minUnit,n,s,this._getLabelCapacity(n)),h=Ze(o.ticks.stepSize,1),p=f==="week"?c.isoWeekday:!1,g=_s(p)||p===!0,b={};let _=n,T,L;if(g&&(_=+e.startOf(_,"isoWeek",p)),_=+e.startOf(_,g?"day":f),e.diff(s,n,f)>1e5*h)throw new Error(n+" and "+s+" are too far apart with stepSize of "+h+" "+f);const D=o.ticks.source==="data"&&this.getDataTimestamps();for(T=_,L=0;T<s;T=+e.add(T,h,f),L++)kh(b,T,D);return(T===s||o.bounds==="ticks"||L===1)&&kh(b,T,D),Object.keys(b).sort(xh).map(P=>+P)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const o=this.options.time.displayFormats,c=this._unit,f=n||o[c];return this._adapter.format(e,f)}_tickFormatFunction(e,n,s,o){const c=this.options,f=c.ticks.callback;if(f)return ct(f,[e,n,s],this);const h=c.time.displayFormats,p=this._unit,g=this._majorUnit,b=p&&h[p],_=g&&h[g],T=s[n],L=g&&_&&T&&T.major;return this._adapter.format(e,o||(L?_:b))}generateTickLabels(e){let n,s,o;for(n=0,s=e.length;n<s;++n)o=e[n],o.label=this._tickFormatFunction(o.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,o=Ii(this.isHorizontal()?n.maxRotation:n.minRotation),c=Math.cos(o),f=Math.sin(o),h=this._resolveTickFontOptions(0).size;return{w:s*c+h*f,h:s*f+h*c}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,o=s[n.unit]||s.millisecond,c=this._tickFormatFunction(e,0,Sh(this,[e],this._majorUnit),o),f=this._getLabelSize(c),h=Math.floor(this.isHorizontal()?this.width/f.w:this.height/f.h)-1;return h>0?h:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const o=this.getMatchingVisibleMetas();if(this._normalized&&o.length)return this._cache.data=o[0].controller.getAllParsedValues(this);for(n=0,s=o.length;n<s;++n)e=e.concat(o[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const o=this.getLabels();for(n=0,s=o.length;n<s;++n)e.push(_h(this,o[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return jv(e.sort(xh))}}ke(Uo,"id","time"),ke(Uo,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Co(i,e,n){let s=0,o=i.length-1,c,f,h,p;n?(e>=i[s].pos&&e<=i[o].pos&&({lo:s,hi:o}=Ei(i,"pos",e)),{pos:c,time:h}=i[s],{pos:f,time:p}=i[o]):(e>=i[s].time&&e<=i[o].time&&({lo:s,hi:o}=Ei(i,"time",e)),{time:c,pos:h}=i[s],{time:f,pos:p}=i[o]);const g=f-c;return g?h+(p-h)*(e-c)/g:h}class Ch extends Uo{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Co(n,this.min),this._tableRange=Co(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,o=[],c=[];let f,h,p,g,b;for(f=0,h=e.length;f<h;++f)g=e[f],g>=n&&g<=s&&o.push(g);if(o.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(f=0,h=o.length;f<h;++f)b=o[f+1],p=o[f-1],g=o[f],Math.round((b+p)/2)!==g&&c.push({time:g,pos:f/(h-1)});return c}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((o,c)=>o-c)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Co(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return Co(this._table,s*this._tableRange+this._minPos,!0)}}ke(Ch,"id","timeseries"),ke(Ch,"defaults",Uo.defaults);const Bd="label";function Th(i,e){typeof i=="function"?i(e):i&&(i.current=e)}function Qb(i,e){const n=i.options;n&&e&&Object.assign(n,e)}function Ud(i,e){i.labels=e}function $d(i,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Bd;const s=[];i.datasets=e.map(o=>{const c=i.datasets.find(f=>f[n]===o[n]);return!c||!o.data||s.includes(c)?{...o}:(s.push(c),Object.assign(c,o),c)})}function ex(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bd;const n={labels:[],datasets:[]};return Ud(n,i.labels),$d(n,i.datasets,e),n}function tx(i,e){const{height:n=150,width:s=300,redraw:o=!1,datasetIdKey:c,type:f,data:h,options:p,plugins:g=[],fallbackContent:b,updateMode:_,...T}=i,L=gt(null),D=gt(null),P=()=>{L.current&&(D.current=new Go(L.current,{type:f,data:ex(h,c),options:p&&{...p},plugins:g}),Th(e,D.current))},N=()=>{Th(e,null),D.current&&(D.current.destroy(),D.current=null)};return Ve(()=>{!o&&D.current&&p&&Qb(D.current,p)},[o,p]),Ve(()=>{!o&&D.current&&Ud(D.current.config.data,h.labels)},[o,h.labels]),Ve(()=>{!o&&D.current&&h.datasets&&$d(D.current.config.data,h.datasets,c)},[o,h.datasets]),Ve(()=>{D.current&&(o?(N(),setTimeout(P)):D.current.update(_))},[o,p,h.labels,h.datasets,_]),Ve(()=>{D.current&&(N(),setTimeout(P))},[f]),Ve(()=>(P(),()=>N()),[]),id.createElement("canvas",{ref:L,role:"img",height:n,width:s,...T},b)}const nx=Cl(tx);function ix(i,e){return Go.register(e),Cl((n,s)=>id.createElement(nx,{...n,ref:s,type:i}))}const rx=ix("line",Mo);Go.register(vl,yl,Oo,cs,Rb,jb,Ib);const sx=({isDarkMode:i})=>{const[e,n]=ae([]),[s,o]=ae(!0),[c,f]=ae(null),h=async()=>{try{const L=await Te.getSystemStats();n(L),f(null)}catch(L){console.error("Stats yÃ¼klenemedi:",L),f("Failed to load statistics")}finally{o(!1)}};Ve(()=>{h();const L=setInterval(h,6e4);return()=>clearInterval(L)},[]);const p=L=>{const D=L.filter(E=>E.titleID),P=L.filter(E=>!E.titleID),N=E=>({frequency:E.reduce((I,j)=>I+j.frequency,0)/(E.length||1)/1e6,temperature:E.reduce((I,j)=>I+j.temperature,0)/(E.length||1),socTemp:E.reduce((I,j)=>I+j.socSensorTemperature,0)/(E.length||1)});return{game:N(D),idle:N(P)}},g=()=>{if(e.length===0)return;const L=["Timestamp","CPU Frequency (MHz)","CPU Temperature (Â°C)","SoC Temperature (Â°C)","Title ID","Title Name"],D=e.map(X=>{const G=new Date(X.timestamp).toISOString(),K=(X.frequency/1e6).toFixed(2),Y=X.temperature.toFixed(2),Q=X.socSensorTemperature.toFixed(2),he=X.titleID||"",fe=X.titleName||"";return[G,K,Y,Q,he,fe].join(",")}),P=[L.join(","),...D].join(`
`),N=new Blob([P],{type:"text/csv;charset=utf-8;"}),E=URL.createObjectURL(N),I=document.createElement("a"),j=new Date().toISOString().split("T")[0];I.setAttribute("href",E),I.setAttribute("download",`system-stats-${j}.csv`),I.style.visibility="hidden",document.body.appendChild(I),I.click(),document.body.removeChild(I)},b={responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top",labels:{color:i?"#fff":"#666"}},tooltip:{mode:"index",intersect:!1}},scales:{y:{type:"linear",display:!0,position:"left",grid:{color:i?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:i?"#fff":"#666"}},y1:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1},ticks:{color:i?"#fff":"#666"}},x:{grid:{color:i?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:i?"#fff":"#666"}}}},_={labels:e.map(L=>new Date(L.timestamp).toLocaleTimeString()),datasets:[{label:"CPU Frequency (MHz)",data:e.map(L=>L.frequency/1e6),borderColor:"#3498db",backgroundColor:"rgba(52, 152, 219, 0.5)",yAxisID:"y"},{label:"CPU Temperature (Â°C)",data:e.map(L=>L.temperature),borderColor:"#e74c3c",backgroundColor:"rgba(231, 76, 60, 0.5)",yAxisID:"y1"},{label:"SoC Temperature (Â°C)",data:e.map(L=>L.socSensorTemperature),borderColor:"#f1c40f",backgroundColor:"rgba(241, 196, 15, 0.5)",yAxisID:"y1"}]},T=p(e);return v("div",{className:`statistics ${i?"dark":""}`,children:s?v("div",{className:"statistics-loading",children:"Loading statistics..."}):c?v("div",{className:"statistics-error",children:c}):v("div",{className:"statistics-content",children:[v("div",{className:"chart-container",children:[v("button",{className:"export-button",onClick:g,disabled:e.length===0,title:"Export statistics to CSV file",children:"Export CSV"}),v(rx,{options:b,data:_})]}),v("div",{className:"stats-averages",children:[v("div",{className:"averages-group",children:[v("h3",{children:"System Idle Averages"}),v("div",{className:"averages-grid",children:[v("div",{className:"average-item",children:[v("span",{children:"CPU Frequency"}),v("strong",{children:[T.idle.frequency.toFixed(0)," MHz"]})]}),v("div",{className:"average-item",children:[v("span",{children:"CPU Temperature"}),v("strong",{children:[T.idle.temperature.toFixed(1),"Â°C"]})]}),v("div",{className:"average-item",children:[v("span",{children:"SoC Temperature"}),v("strong",{children:[T.idle.socTemp.toFixed(1),"Â°C"]})]})]})]}),v("div",{className:"averages-group",children:[v("h3",{children:"Gaming Averages"}),v("div",{className:"averages-grid",children:[v("div",{className:"average-item",children:[v("span",{children:"CPU Frequency"}),v("strong",{children:[T.game.frequency.toFixed(0)," MHz"]})]}),v("div",{className:"average-item",children:[v("span",{children:"CPU Temperature"}),v("strong",{children:[T.game.temperature.toFixed(1),"Â°C"]})]}),v("div",{className:"average-item",children:[v("span",{children:"SoC Temperature"}),v("strong",{children:[T.game.socTemp.toFixed(1),"Â°C"]})]})]})]})]})]})})};class Ao{static getConfig(e){return this.windows[e]}static getDesktopItems(){return[...Object.values(this.windows).filter(e=>e.visible!==!1).map((e,n)=>({id:n+1,name:e.title,type:e.id,app:e.id,icon:e.icon})),{id:Object.values(this.windows).length+1,name:"GitHub",type:"link",app:"link",icon:"ğŸ™",url:"https://github.com/barisyild/airpsx"}]}static getComponent(e){var n;return(n=this.windows[e])==null?void 0:n.component}}ke(Ao,"windows",{fileManager:{id:"fileManager",title:"File Manager",icon:"ğŸ“",defaultWidth:800,defaultHeight:600,minWidth:400,minHeight:300,component:um},processList:{id:"processList",title:"Process List",icon:"ğŸ“Š",defaultWidth:700,defaultHeight:500,minWidth:300,minHeight:200,component:pm},scriptEditor:{id:"scriptEditor",title:"Script Editor",icon:"ğŸ“",defaultWidth:800,defaultHeight:600,minWidth:400,minHeight:300,component:Sm},scriptStore:{id:"scriptStore",title:"Script Store",icon:"ğŸ“¦",defaultWidth:850,defaultHeight:600,minWidth:400,minHeight:300,component:Cm},systemInfo:{id:"systemInfo",title:"System Info",icon:"ğŸ–¥ï¸",defaultWidth:600,defaultHeight:400,minWidth:300,minHeight:200,component:Kh},statistics:{id:"statistics",title:"Statistics",icon:"ğŸ“ˆ",defaultWidth:800,defaultHeight:600,minWidth:400,minHeight:300,component:sx},applications:{id:"applications",title:"Applications",icon:"ğŸ®",defaultWidth:800,defaultHeight:600,minWidth:400,minHeight:300,component:om},profiles:{id:"profiles",title:"Profiles",icon:"ğŸ‘¤",defaultWidth:700,defaultHeight:500,minWidth:300,minHeight:200,component:gm},scheduler:{id:"scheduler",title:"Scheduler",icon:"â°",defaultWidth:900,defaultHeight:700,minWidth:500,minHeight:400,component:km},mediaGallery:{id:"mediaGallery",title:"Media Gallery",icon:"ğŸ–¼ï¸",defaultWidth:900,defaultHeight:700,minWidth:400,minHeight:300,component:fm},mediaPlayer:{id:"mediaPlayer",title:"Media Player",icon:"ğŸ¬",defaultWidth:800,defaultHeight:500,minWidth:400,minHeight:300,visible:!1,component:hm},imageViewer:{id:"imageViewer",title:"Image Viewer",icon:"ğŸ–¼ï¸",defaultWidth:800,defaultHeight:600,minWidth:400,minHeight:300,visible:!1,component:dm},scriptDetail:{id:"scriptDetail",title:"Script Detail",icon:"ğŸ“",defaultWidth:700,defaultHeight:500,minWidth:400,minHeight:350,visible:!1,component:Tm}});const ox=({onAccept:i,isDarkMode:e})=>v("div",{className:`disclaimer-overlay ${e?"dark":""}`,children:v("div",{className:"disclaimer-modal",children:[v("h2",{children:"Disclaimer"}),v("div",{className:"disclaimer-content",children:["This software operates based on the data provided by users and the actions performed. Unexpected actions by users, improper use, or unforeseen circumstances may cause the console to behave unexpectedly or become bricked.",v("br",{}),v("br",{}),"The developer cannot be held responsible for any data loss, service interruptions, or other adverse outcomes that may occur during the use of the software.",v("br",{})," By using this software, you agree to this disclaimer of liability. We would like to explicitly state that this software does not support piracy and cannot be used for such purposes. The use of the software for illegal activities is strictly prohibited, and the developer accepts no responsibility for such misuse.",v("br",{}),v("br",{}),"In certain cases, improper use of this software may render your hardware inoperable ('bricked'). The developer is not liable for such outcomes."]}),v("div",{className:"disclaimer-actions",children:v("button",{onClick:i,children:"I Accept"})})]})}),ax=()=>{const[i]=ae(Ao.getDesktopItems()),[e,n]=ae([]),[s,o]=ae(null),[c,f]=ae({show:!1,x:0,y:0,item:null}),[h,p]=ae(()=>{const V=localStorage.getItem("theme");return V?V==="dark":!0}),[g,b]=ae([]),[_,T]=ae(null),[L,D]=ae(!0),[P,N]=ae("tr"),[E,I]=ae({id:null,time:0,clickCount:0}),[j,X]=ae(new Set),[G,K]=ae(-1),[Y,Q]=ae(!1),[he,fe]=ae(()=>document.cookie.includes("disclaimerAccepted=true")),[oe,se]=ae({uploading:!1,progress:0,error:null,success:!1}),[R,F]=ae(!1),[S,ge]=ae(""),[Le,je]=ae({loading:!1,error:null,success:!1}),Ye=gt(null),Ke=gt(null);Ve(()=>{localStorage.setItem("theme",h?"dark":"light")},[h]);const Se=async()=>{try{const V=await Te.getStorageInfo();b(V),T(null)}catch(V){console.error("Storage bilgisi alÄ±namadÄ±:",V),T("Failed to load storage information")}finally{D(!1)}};Ve(()=>{Se();const V=setInterval(Se,3e4);return()=>clearInterval(V)},[]);const _e=V=>V.includes("USB")?"ğŸ’½":V.includes("Disc")?"ğŸ’¿":"ğŸ’¾",Ne=(V,me,Ae)=>{let{x:Ee,y:Ge}=V;const{width:Fe,height:We}=me,ze={width:Math.min(Fe,Ae.width),height:Math.min(We,Ae.height)};return Ee=Math.max(0,Math.min(Ee,Ae.width-ze.width)),Ge=Math.max(0,Math.min(Ge,Ae.height-ze.height)),{position:{x:Ee,y:Ge},size:ze}},Oe=(V,me={},Ae=null)=>{const Ee=Ao.getConfig(V);if(!Ee)return;if(me.windowId&&e.some(We=>We.id===me.windowId)){const We=e.find(ze=>ze.id===me.windowId);We&&We.minimized&&n(e.map(ze=>ze.id===We.id?{...ze,minimized:!1}:ze)),We&&o(We.id);return}if(!me.windowId&&e.some(We=>We.app===V&&!We.customInstance)){const We=e.find(ze=>ze.app===V&&!ze.customInstance);We&&We.minimized&&n(e.map(ze=>ze.id===We.id?{...ze,minimized:!1}:ze)),We&&o(We.id);return}const Ge=document.querySelector(".desktop-content");if(Ge==null?void 0:Ge.getBoundingClientRect()){const We=me.windowId||Date.now(),ze={id:We,app:V,title:Ae||Ee.title,icon:Ee.icon,position:{x:50+e.length*20,y:50+e.length*20},size:{width:Ee.defaultWidth,height:Ee.defaultHeight},minSize:{width:Ee.minWidth,height:Ee.minHeight},minimized:!1,props:me,customInstance:!!Ae};return n([...e,ze]),o(ze.id),We}},U=V=>{n(e.filter(me=>me.id!==V)),s===V&&o(null)},Z=()=>{f({...c,show:!1})},ie=V=>{n(e.map(me=>me.id===V?{...me,minimized:!0}:me))},be=V=>{if(V.preventDefault(),V.target.closest(".storage-panel")||V.target.closest(".window"))return;const me=V.target,Ae=me.classList.contains("desktop-icons"),Ee=me.closest(".desktop-item");if(!Ae&&!Ee)return;const Ge=Ee?i.find(Fe=>{var We;return Fe.name===((We=Ee.querySelector(".desktop-item-name"))==null?void 0:We.textContent)}):null;f({show:!0,x:V.pageX,y:V.pageY,item:Ge||null,isBackground:!Ee})};Ve(()=>()=>{Ye.current&&clearTimeout(Ye.current)},[]),Ve(()=>{const V=me=>{if(document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA")return;if(e.find(Fe=>Fe.id===s&&!Fe.minimized)){const Fe=document.querySelector(`[data-window-id="${s}"]`);if(Fe&&!Fe.contains(document.activeElement)&&me.key==="Tab"){me.preventDefault();const We=Fe.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');We.length>0&&We[0].focus()}return}if(!i.length)return;const Ee=Math.floor((window.innerHeight-60)/120),Ge=Math.floor(G/Ee);switch(me.key){case"ArrowUp":if(me.preventDefault(),G>-1){const Fe=G-1;Fe>=0&&(K(Fe),X(new Set([i[Fe].id])))}else K(0),X(new Set([i[0].id]));break;case"ArrowDown":if(me.preventDefault(),G<i.length-1){const Fe=G+1;K(Fe),X(new Set([i[Fe].id]))}break;case"ArrowLeft":if(me.preventDefault(),Ge>0){const Fe=G-Ee;Fe>=0&&(K(Fe),X(new Set([i[Fe].id])))}break;case"ArrowRight":if(me.preventDefault(),Ge<Math.ceil(i.length/Ee)-1){const Fe=G+Ee;Fe<i.length&&(K(Fe),X(new Set([i[Fe].id])))}break;case"Enter":if(me.preventDefault(),G>-1&&!e.some(Fe=>Fe.app===i[G].app)){const Fe=i[G];Fe.app==="systemInfo"?Q(!0):Oe(Fe.app)}break;case"Escape":K(-1),X(new Set);break}};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[G,i,e,s]);const Ie=(V,me)=>{const Ae=i.findIndex(Ge=>Ge.id===me.id);if(K(Ae),me.type==="link"){window.open(me.url,"_blank");return}if(me.app==="systemInfo"){Q(!0);return}const Ee=Date.now();E.id===me.id&&Ee-E.time<500&&E.clickCount===1?(Oe(me.app),I({id:null,time:0,clickCount:0})):(I({id:me.id,time:Ee,clickCount:1}),X(new Set([me.id])))},Ot=()=>{const V=new Date;V.setFullYear(V.getFullYear()+1),document.cookie=`disclaimerAccepted=true; expires=${V.toUTCString()}; path=/`,fe(!0)},He=V=>{V&&V.name.toLowerCase().endsWith(".pkg")?(oe.uploading&&(console.log("[Desktop] Stopping previous PKG upload..."),Te.stopPkgUpload()),se({uploading:!0,progress:0,error:null,success:!1}),Te.uploadPkg(V,me=>{se(Ae=>({...Ae,progress:Math.min(me,100)}))},me=>{se({uploading:!1,progress:100,error:null,success:!0}),setTimeout(()=>{se({uploading:!1,progress:0,error:null,success:!1})},3e3)}).catch(me=>{se({uploading:!1,progress:0,error:me.message||"An error occurred during upload",success:!1})})):se({uploading:!1,progress:0,error:"Please select a valid .pkg file",success:!1})},at=async()=>{try{const V=Te.getSessionKey();Te.stopPkgUpload(),V&&await Te.cancelPkgUpload(V),se({uploading:!1,progress:0,error:null,success:!1})}catch(V){console.error("[Desktop] Failed to cancel upload:",V),se({uploading:!1,progress:0,error:"Upload cancelled",success:!1})}},Ft=async()=>{if(!S.trim()){je({loading:!1,error:"Please enter a valid URL",success:!1});return}je({loading:!0,error:null,success:!1});try{await Te.installPackageFromUrl(S),je({loading:!1,error:null,success:!0}),setTimeout(()=>{F(!1),ge(""),je({loading:!1,error:null,success:!1})},2e3)}catch(V){je({loading:!1,error:V.message||"Failed to install package from URL",success:!1})}},$t=V=>{var Ee;const me=V.target,Ae=(Ee=me.files)==null?void 0:Ee[0];Ae&&He(Ae),me.value=""};return v("div",{className:`desktop ${h?"dark":""}`,onClick:V=>{(V.target.classList.contains("desktop-content")||V.target.classList.contains("desktop-icons"))&&X(new Set),f({...c,show:!1})},onContextMenu:be,children:[!he&&v(ox,{onAccept:Ot,isDarkMode:h}),v("div",{className:"desktop-content",children:[v("div",{className:"desktop-icons",children:i.map((V,me)=>v("div",{className:`desktop-item ${j.has(V.id)?"selected":""}`,onClick:Ae=>Ie(Ae,V),tabIndex:0,children:[v("div",{className:"desktop-item-icon icon",children:V.icon}),v("div",{className:"desktop-item-name",children:V.name})]},V.id))}),v("div",{className:`storage-panel ${h?"dark":""}`,children:[v("div",{className:"storage-header",children:["Storage",v("button",{className:"refresh-button icon",onClick:Se,disabled:L,children:"ğŸ”„"})]}),L?v("div",{className:"storage-loading",children:"Loading storage info..."}):_?v("div",{className:"storage-error",children:_}):g.map((V,me)=>v("div",{className:"storage-item",children:[v("div",{className:"storage-icon icon",children:_e(V.name)}),v("div",{className:"storage-info",children:[v("div",{className:"storage-name",children:V.name}),v("div",{className:"storage-usage",children:[v("div",{className:"storage-bar",children:v("div",{className:"storage-bar-fill",style:{width:`${V.used/V.total*100}%`}})}),v("div",{className:"storage-text",children:[Te.formatBytes(V.used)," /"," ",Te.formatBytes(V.total)]})]})]})]},V.path)),v("div",{className:"storage-dropzone",onClick:()=>{var V;return(V=Ke.current)==null?void 0:V.click()},onDragOver:V=>{V.preventDefault(),V.stopPropagation(),V.currentTarget.classList.add("drag-over")},onDragLeave:V=>{V.preventDefault(),V.stopPropagation(),V.currentTarget.classList.remove("drag-over")},onDrop:V=>{V.preventDefault(),V.stopPropagation(),V.currentTarget.classList.remove("drag-over");const Ae=Array.from(V.dataTransfer.files).find(Ee=>Ee.name.toLowerCase().endsWith(".pkg"));Ae?He(Ae):se({uploading:!1,progress:0,error:"Please drag a valid .pkg file",success:!1})},children:[v("input",{type:"file",ref:Ke,style:{display:"none"},accept:".pkg",onChange:$t}),v("div",{className:"dropzone-content",children:oe.uploading?v("div",{className:"pkg-upload-progress",children:[v("div",{className:"progress-bar-container",children:v("div",{className:"progress-bar-fill",style:{width:`${oe.progress}%`}})}),v("div",{className:"progress-text",children:["Uploading: %",oe.progress.toFixed(1)]}),v("button",{className:"cancel-upload-button",onClick:V=>{V.stopPropagation(),at()},children:"Cancel"})]}):oe.error?v("div",{className:"pkg-upload-error",children:[v("div",{className:"dropzone-icon icon",children:"âŒ"}),v("div",{className:"dropzone-text",children:oe.error})]}):oe.success?v("div",{className:"pkg-upload-success",children:[v("div",{className:"dropzone-icon icon",children:"âœ…"}),v("div",{className:"dropzone-text",children:"PKG file successfully uploaded!"})]}):v(Dt,{children:[v("div",{className:"dropzone-icon icon",children:"ğŸ“¦"}),v("div",{className:"dropzone-text",children:"PKG Installer - Drag PKG file here"}),v("button",{className:"url-install-button",onClick:V=>{V.stopPropagation(),F(!0)},children:"Install from URL"})]})})]})]}),v(sm,{isDarkMode:h}),v(Kh,{isDarkMode:h,showPanel:Y,onClose:()=>Q(!1)}),e.map(V=>{const me=Ao.getComponent(V.app);return v(tm,{window:V,isActive:s===V.id,isDarkMode:h,onClose:()=>U(V.id),onFocus:()=>o(V.id),onDragStart:Z,onMinimize:()=>ie(V.id),children:me&&v(me,{contextMenu:c,setContextMenu:f,isDarkMode:h,storage:g,isStorageLoading:L,storageError:_,language:P,onOpenWindow:Ae=>{Oe(Ae.app,Ae.props,Ae.title)},...V.props})},V.id)})]}),v(nm,{windows:e,activeWindow:s,isDarkMode:h,onWindowClick:(V,me)=>{var Ee;const Ae=e.find(Ge=>Ge.id===V);if(Ae&&Ae.minimized){const Ge=(Ee=document.querySelector(".desktop-content"))==null?void 0:Ee.getBoundingClientRect();if(Ge){const{position:Fe,size:We}=Ne(Ae.position,Ae.size,Ge);n(e.map(ze=>ze.id===V?{...ze,minimized:!1,position:Fe,size:We}:ze))}else n(e.map(Fe=>Fe.id===V?{...Fe,minimized:!1}:Fe))}else me&&(n(e.map(Ge=>Ge.id===V?{...Ge,minimized:!0}:Ge)),o(null));!me&&Ae&&!Ae.minimized&&o(V)},onThemeToggle:()=>p(!h)}),R&&v("div",{className:`url-modal-overlay ${h?"dark":""}`,onClick:()=>F(!1),children:v("div",{className:`url-modal ${h?"dark":""}`,onClick:V=>V.stopPropagation(),children:[v("div",{className:"url-modal-header",children:[v("h3",{children:"Install Package from URL"}),v("button",{className:"close-button",onClick:()=>F(!1),children:"Ã—"})]}),v("div",{className:"url-modal-content",children:[v("input",{type:"text",className:"url-input",placeholder:"Enter package URL (e.g., http://example.com/game.pkg)",value:S,style:{width:"94%"},onChange:V=>ge(V.target.value),disabled:Le.loading}),Le.error&&v("div",{className:"url-error-message",children:Le.error}),Le.success&&v("div",{className:"url-success-message",children:"Package installation started successfully!"})]}),v("div",{className:"url-modal-footer",children:v("button",{className:"install-url-button",onClick:Ft,disabled:Le.loading,children:Le.loading?"Installing...":"Install"})})]})})]})};function lx(){return navigator.userAgent.includes("PlayStation 4")?document.body.classList.add("ps4"):navigator.userAgent.includes("PlayStation 5")&&document.body.classList.add("ps5"),v(ax,{})}tn.init();Ls.defineMode("haxe",function(i,e){var n=i.indentUnit;function s(C){return{type:C,style:"keyword"}}var o=s("keyword a"),c=s("keyword b"),f=s("keyword c"),h=s("operator"),p={type:"atom",style:"atom"},g={type:"attribute",style:"attribute"},D=s("typedef"),b={if:o,while:o,else:c,do:c,try:c,return:f,break:f,continue:f,new:f,throw:f,var:s("var"),final:s("var"),inline:g,static:g,using:s("import"),public:g,private:g,overload:g,extern:g,cast:s("cast"),import:s("import"),macro:s("macro"),function:s("function"),catch:s("catch"),untyped:s("untyped"),callback:s("cb"),for:s("for"),switch:s("switch"),case:s("case"),default:s("default"),in:h,is:h,as:h,never:s("property_access"),trace:s("trace"),class:D,abstract:D,enum:D,interface:D,typedef:D,extends:D,implements:D,dynamic:D,true:p,false:p,null:p},_=/[+\-*&%=<>!?|]/;function T(C,z,$){return z.tokenize=$,$(C,z)}function L(C,z){for(var $=!1,te;(te=C.next())!=null;){if(te==z&&!$)return!0;$=!$&&te=="\\"}}var D,P;function N(C,z,$){return D=C,P=$,z}function E(C,z){var $=C.next();if($=='"')return T(C,z,I($));if($=="'")return j($,C,z);if($=="}")return z.interpolationStack.length>0?(z.tokenize=z.interpolationStack.pop(),N($,"string")):N($);if(/[\[\]{}\(\),;\:\.]/.test($))return N($);if($=="0"&&C.eat(/x/i))return C.eatWhile(/[\da-f]/i),N("number","number");if(/\d/.test($)||$=="-"&&C.eat(/\d/))return C.match(/^\d*(?:\.\d*(?!\.))?(?:[eE][+\-]?\d+)?/),N("number","number");if(z.reAllowed&&$=="~"&&C.eat(/\//))return L(C,"/"),C.eatWhile(/[gimsu]/),N("regexp","string-2");if($=="/")return C.eat("*")?T(C,z,K):C.eat("/")?(C.skipToEnd(),N("comment","comment")):(C.eatWhile(_),N("operator",null,C.current()));if($=="#")return C.skipToEnd(),N("conditional","meta");if($=="@")return C.eat(/:/),C.eatWhile(/[\w_]/),N("metadata","meta");if(_.test($))return C.eatWhile(_),N("operator",null,C.current());var te;if(/[A-Z]/.test($))return C.eatWhile(/[\w_<>]/),te=C.current(),N("type","variable-3",te);C.eatWhile(/[\w_]/);var te=C.current(),B=b.propertyIsEnumerable(te)&&b[te];return B&&z.kwAllowed?N(B.type,B.style,te):N("variable","variable",te)}function I(C){return function(z,$){return L(z,C)&&($.tokenize=E),N("string","string")}}function j(C,z,$){if(z.eat(C))return N("string","string");function te(B,J){for(var xe=!1;;){var ne=B.next();if(ne==null)break;if(ne=="$"&&B.peek()=="$"){B.next();continue}if(ne=="$")return J.interpolationStack.push(J.tokenize),J.tokenize=X,N("string","string");if(ne==C&&!xe){J.tokenize=E;break}xe=!xe&&ne=="\\"}return N("string","string")}return $.tokenize=te,te(z,$)}function X(C,z){return C.eat("$"),C.eat("{")?z.tokenize=E:z.tokenize=G,N("string","string")}function G(C,z){return C.eatWhile(/[\w_]/),z.tokenize=z.interpolationStack.pop(),"variable"}function K(C,z){for(var $=!1,te;te=C.next();){if(te=="/"&&$){z.tokenize=E;break}$=te=="*"}return N("comment","comment")}var Y={atom:!0,number:!0,variable:!0,string:!0,regexp:!0};function Q(C,z,$,te,B,J){this.indented=C,this.column=z,this.type=$,this.prev=B,this.info=J,te!=null&&(this.align=te)}function he(C,z){for(var $=C.localVars;$;$=$.next)if($.name==z)return!0}function fe(C,z,$,te,B){var J=C.cc;for(R.state=C,R.stream=B,R.marked=null,R.cc=J,C.lexical.hasOwnProperty("align")||(C.lexical.align=!0);;){var xe=J.length?J.pop():Oe;if(xe($,te)){for(;J.length&&J[J.length-1].lex;)J.pop()();return R.marked?R.marked:$=="variable"&&he(C,te)?"variable-2":$=="variable"&&oe(C,te)?"variable-3":z}}}function oe(C,z){if(/[a-z]/.test(z.charAt(0)))return!1;for(var $=C.importedtypes.length,te=0;te<$;te++)if(C.importedtypes[te]==z)return!0}function se(C){for(var z=R.state,$=z.importedtypes;$;$=$.next)if($.name==C)return;z.importedtypes={name:C,next:z.importedtypes}}var R={state:null,column:null,marked:null,cc:null};function F(){for(var C=arguments.length-1;C>=0;C--)R.cc.push(arguments[C])}function S(){return F.apply(null,arguments),!0}function ge(C,z){for(var $=z;$;$=$.next)if($.name==C)return!0;return!1}function Le(C){var z=R.state;if(z.context){if(R.marked="def",ge(C,z.localVars))return;z.localVars={name:C,next:z.localVars}}else if(z.globalVars){if(ge(C,z.globalVars))return;z.globalVars={name:C,next:z.globalVars}}}var je={name:"this",next:null};function Ye(){R.state.context||(R.state.localVars=je),R.state.context={prev:R.state.context,vars:R.state.localVars}}function Ke(){R.state.localVars=R.state.context.vars,R.state.context=R.state.context.prev}Ke.lex=!0;function Se(C,z){var $=function(){var te=R.state;te.lexical=new Q(te.indented,R.stream.column(),C,null,te.lexical,z)};return $.lex=!0,$}function _e(){var C=R.state;C.lexical.prev&&(C.lexical.type==")"&&(C.indented=C.lexical.indented),C.lexical=C.lexical.prev)}_e.lex=!0;function Ne(C){function z($){return $==C?S():C==";"?F():S(z)}return z}function Oe(C){return C=="@"?S(Ie):C=="var"?S(Se("vardef"),Ee,Ne(";"),_e):C=="keyword a"?S(Se("form"),U,Oe,_e):C=="keyword b"?S(Se("form"),Oe,_e):C=="{"?S(Se("}"),Ye,Ae,_e,Ke):C==";"?S():C=="attribute"?S(be):C=="function"?S(ze):C=="for"?S(Se("form"),Ne("("),Se(")"),Fe,Ne(")"),_e,Oe,_e):C=="variable"?S(Se("stat"),Ft):C=="switch"?S(Se("form"),U,Se("}","switch"),Ne("{"),Ae,_e,_e):C=="case"?S(U,Ne(":")):C=="default"?S(Ne(":")):C=="catch"?S(Se("form"),Ye,Ne("("),un,Ne(")"),Oe,_e,Ke):C=="import"?S(He,Ne(";")):C=="typedef"?S(at):F(Se("stat"),U,Ne(";"),_e)}function U(C){return Y.hasOwnProperty(C)||C=="type"?S(ie):C=="function"?S(ze):C=="keyword c"?S(Z):C=="("?S(Se(")"),Z,Ne(")"),_e,ie):C=="operator"?S(U):C=="["?S(Se("]"),me(Z,"]"),_e,ie):C=="{"?S(Se("}"),me(V,"}"),_e,ie):S()}function Z(C){return C.match(/[;\}\)\],]/)?F():F(U)}function ie(C,z){if(C=="operator"&&/\+\+|--/.test(z))return S(ie);if(C=="operator"||C==":")return S(U);if(C!=";"){if(C=="(")return S(Se(")"),me(U,")"),_e,ie);if(C==".")return S($t,ie);if(C=="[")return S(Se("]"),U,Ne("]"),_e,ie)}}function be(C){if(C=="attribute")return S(be);if(C=="function")return S(ze);if(C=="var")return S(Ee)}function Ie(C){if(C==":"||C=="variable")return S(Ie);if(C=="(")return S(Se(")"),me(Ot,")"),_e,Oe)}function Ot(C){if(C=="variable")return S()}function He(C,z){if(C=="variable"&&/[A-Z]/.test(z.charAt(0)))return se(z),S();if(C=="variable"||C=="property"||C=="."||z=="*")return S(He)}function at(C,z){if(C=="variable"&&/[A-Z]/.test(z.charAt(0)))return se(z),S();if(C=="type"&&/[A-Z]/.test(z.charAt(0)))return S()}function Ft(C){return C==":"?S(_e,Oe):F(ie,Ne(";"),_e)}function $t(C){if(C=="variable")return R.marked="property",S()}function V(C){if(C=="variable"&&(R.marked="property"),Y.hasOwnProperty(C))return S(Ne(":"),U)}function me(C,z){function $(te){return te==","?S(C,$):te==z?S():S(Ne(z))}return function(te){return te==z?S():F(C,$)}}function Ae(C){return C=="}"?S():F(Oe,Ae)}function Ee(C,z){return C=="variable"?(Le(z),S(Ht,Ge)):S()}function Ge(C,z){if(z=="=")return S(U,Ge);if(C==",")return S(Ee)}function Fe(C,z){return C=="variable"?(Le(z),S(We,U)):F()}function We(C,z){if(z=="in")return S()}function ze(C,z){if(C=="variable"||C=="type")return Le(z),S(ze);if(z=="new")return S(ze);if(C=="(")return S(Se(")"),Ye,me(un,")"),_e,Ht,Oe,Ke)}function Ht(C){if(C==":")return S(Fn)}function Fn(C){if(C=="type"||C=="variable")return S();if(C=="{")return S(Se("}"),me(vn,"}"),_e)}function vn(C){if(C=="variable")return S(Ht)}function un(C,z){if(C=="variable")return Le(z),S(Ht)}return{startState:function(C){var z=["Int","Float","String","Void","Std","Bool","Dynamic","Array"],$={tokenize:E,reAllowed:!0,kwAllowed:!0,cc:[],lexical:new Q((C||0)-n,0,"block",!1),localVars:e.localVars,importedtypes:z,context:e.localVars&&{vars:e.localVars},indented:0,interpolationStack:[]};return e.globalVars&&typeof e.globalVars=="object"&&($.globalVars=e.globalVars),$},token:function(C,z){if(C.sol()&&(z.lexical.hasOwnProperty("align")||(z.lexical.align=!1),z.indented=C.indentation()),C.eatSpace())return null;var $=z.tokenize(C,z);return D=="comment"?$:(z.reAllowed=!!(D=="operator"||D=="keyword c"||D.match(/^[\[{}\(,;:]$/)),z.kwAllowed=D!=".",fe(z,$,D,P,C))},indent:function(C,z){if(C.tokenize!=E)return 0;var $=z&&z.charAt(0),te=C.lexical;te.type=="stat"&&$=="}"&&(te=te.prev);var B=te.type,J=$==B;return B=="vardef"?te.indented+4:B=="form"&&$=="{"?te.indented:B=="stat"||B=="form"?te.indented+n:te.info=="switch"&&!J?te.indented+(/^(?:case|default)\b/.test(z)?n:2*n):te.align?te.column+(J?0:1):te.indented+(J?0:n)},electricChars:"{}",blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//"}});Ls.defineMIME("text/x-haxe","haxe");Ls.defineMode("hxml",function(){return{startState:function(){return{define:!1,inString:!1}},token:function(i,e){var o=i.peek(),n=i.sol();if(o=="#")return i.skipToEnd(),"comment";if(n&&o=="-"){var s="variable-2";return i.eat(/-/),i.peek()=="-"&&(i.eat(/-/),s="keyword a"),i.peek()=="D"&&(i.eat(/[D]/),s="keyword c",e.define=!0),i.eatWhile(/[A-Z]/i),s}var o=i.peek();return e.inString==!1&&o=="'"&&(e.inString=!0,i.next()),e.inString==!0?(i.skipTo("'")||i.skipToEnd(),i.peek()=="'"&&(i.next(),e.inString=!1),"string"):(i.next(),null)},lineComment:"#"}});Fi(v(lx,{}),document.getElementById("app"));
